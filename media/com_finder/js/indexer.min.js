var FinderIndexer=function(){var e=null,r=null,s=null,o=!1,n="index.php?option=com_finder&tmpl=component&format=json",a=function(e){jQuery.ajax({type:"GET",url:n,data:"task="+e,dataType:"json",success:t,error:d})},t=function(s,n){try{if(null===s)throw n;if(s.error)throw s;s.start&&(e=s.totalItems),r+=s.batchOffset,i(s.header,s.message),r<e?a("indexer.batch"):o||(o=!0,a("indexer.optimize"))}catch(e){jQuery("#progress").remove();try{s.error&&(jQuery("#finder-progress-header").text(s.header).addClass("finder-error"),jQuery("#finder-progress-message").html(s.message).addClass("finder-error"))}catch(r){""===e&&(e=Joomla.JText._("COM_FINDER_NO_ERROR_RETURNED")),jQuery("#finder-progress-header").text(Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED")).addClass("finder-error"),jQuery("#finder-progress-message").html(e).addClass("finder-error")}}return!0},d=function(e){json="object"==typeof e&&e.responseText?e.responseText:null,json=json?jQuery.parseJSON(json):null,jQuery("#progress").remove(),json&&(json=null!=json.responseText?Json.evaluate(json.responseText,!0):json);var r=json?json.header:Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),s=json?json.message:Joomla.JText._("COM_FINDER_MESSAGE_RETURNED")+" <br>"+json;jQuery("#finder-progress-header").text(r).addClass("finder-error"),jQuery("#finder-progress-message").html(s).addClass("finder-error")},i=function(o,n){s=r/e*100,jQuery("#finder-progress-header").text(o),jQuery("#finder-progress-message").html(n),s<100?jQuery("#progress-bar").css("width",s+"%").attr("aria-valuenow",s):(jQuery("#progress-bar").removeClass("bar-success").addClass("bar-warning").attr("aria-valuemin",100).attr("aria-valuemax",200),jQuery("#progress-bar").css("width",s+"%").attr("aria-valuenow",s)),n==msg&&(jQuery("#progress").remove(),window.parent.jQuery("#modal-archive",parent.document).modal("hide"))};!function(){r=0,s=0,n=n+"&"+jQuery("#finder-indexer-token").attr("name")+"=1",a("indexer.start")}()};jQuery(function(){Indexer=new FinderIndexer,"object"==typeof window.parent.SqueezeBox&&jQuery(window.parent.SqueezeBox).on("close",function(){window.parent.location.reload(!0)})});