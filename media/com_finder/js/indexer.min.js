var FinderIndexer=function(){var a=null,b=null,c=null,d=!1,e="index.php?option=com_finder&tmpl=component&format=json",f=function(a){jQuery.ajax({type:"GET",url:e,data:"task="+a,dataType:"json",success:g,error:h})},g=function(c,e){try{if(null===c)throw e;if(c.error)throw c;c.start&&(a=c.totalItems),b+=c.batchOffset,i(c.header,c.message),b<a?f("indexer.batch"):d||(d=!0,f("indexer.optimize"))}catch(a){jQuery("#progress").remove();try{c.error&&(jQuery("#finder-progress-header").text(c.header).addClass("finder-error"),jQuery("#finder-progress-message").html(c.message).addClass("finder-error"))}catch(b){""===a&&(a=Joomla.JText._("COM_FINDER_NO_ERROR_RETURNED")),jQuery("#finder-progress-header").text(Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED")).addClass("finder-error"),jQuery("#finder-progress-message").html(a).addClass("finder-error")}}return!0},h=function(a){json="object"==typeof a&&a.responseText?a.responseText:null,json=json?jQuery.parseJSON(json):null,jQuery("#progress").remove(),json&&(json=null!=json.responseText?Json.evaluate(json.responseText,!0):json);var b=json?json.header:Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),c=json?json.message:Joomla.JText._("COM_FINDER_MESSAGE_RETURNED")+" <br />"+json;jQuery("#finder-progress-header").text(b).addClass("finder-error"),jQuery("#finder-progress-message").html(c).addClass("finder-error")},i=function(d,e){c=b/a*100,jQuery("#finder-progress-header").text(d),jQuery("#finder-progress-message").html(e),c<100?jQuery("#progress-bar").css("width",c+"%").attr("aria-valuenow",c):(jQuery("#progress-bar").removeClass("bar-success").addClass("bar-warning").attr("aria-valuemin",100).attr("aria-valuemax",200),jQuery("#progress-bar").css("width",c+"%").attr("aria-valuenow",c)),e==msg&&(jQuery("#progress").remove(),window.parent.jQuery("#modal-archive",parent.document).modal("hide"))};!function(){b=0,c=0,e=e+"&"+jQuery("#finder-indexer-token").attr("name")+"=1",f("indexer.start")}()};jQuery(function(){Indexer=new FinderIndexer,"object"==typeof window.parent.SqueezeBox&&jQuery(window.parent.SqueezeBox).on("close",function(){window.parent.location.reload(!0)})});