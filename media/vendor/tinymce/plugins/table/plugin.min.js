!function(){"use strict";var t,n,e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(t){return function(){return t}},o={noop:function(){},noarg:function(t){return function(){return t()}},compose:function(t,n){return function(){return t(n.apply(null,arguments))}},constant:r,identity:function(t){return t},tripleEquals:function(t,n){return t===n},curry:function(t){for(var n=new Array(arguments.length-1),e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}},not:function(t){return function(){return!t.apply(null,arguments)}},die:function(t){return function(){throw new Error(t)}},apply:function(t){return t()},call:function(t){t()},never:r(!1),always:r(!0)},i=o.never,u=o.always,a=function(){return c},c=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:i,isSome:i,isNone:u,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:e,orThunk:n,map:a,ap:a,each:function(){},bind:a,flatten:a,exists:i,forall:u,filter:a,equals:t,equals_:t,toArray:function(){return[]},toString:o.constant("none()")};return Object.freeze&&Object.freeze(r),r}(),l=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:u,isNone:i,getOr:n,getOrThunk:n,getOrDie:n,or:e,orThunk:e,map:function(n){return l(n(t))},ap:function(n){return n.fold(a,function(n){return l(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:c},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(i,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},s={some:l,none:a,from:function(t){return null===t||void 0===t?c:l(t)}},f=void 0===(t=Array.prototype.indexOf)?function(t,n){return b(t,n)}:function(n,e){return t.call(n,e)},d=function(t,n){return f(t,n)>-1},m=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r},g=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},p=function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e,t)},h=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r,t)&&e.push(i)}return e},v=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e,t))return s.some(e);return s.none()},b=function(t,n){for(var e=0,r=t.length;e<r;++e)if(t[e]===n)return e;return-1},w=Array.prototype.push,y=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);w.apply(n,t[e])}return n},x=function(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e,t))return!1;return!0},S=Array.prototype.slice,C={map:m,each:g,eachr:p,partition:function(t,n){for(var e=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(n(u,o,t)?e:r).push(u)}return{pass:e,fail:r}},filter:h,groupBy:function(t,n){if(0===t.length)return[];for(var e=n(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=n(a);c!==e&&(r.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&r.push(o),r},indexOf:function(t,n){var e=f(t,n);return-1===e?s.none():s.some(e)},foldr:function(t,n,e){return p(t,function(t){e=n(e,t)}),e},foldl:function(t,n,e){return g(t,function(t){e=n(e,t)}),e},find:function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return s.some(o)}return s.none()},findIndex:v,flatten:y,bind:function(t,n){var e=m(t,n);return y(e)},forall:x,exists:function(t,n){return v(t,n).isSome()},contains:d,equal:function(t,n){return t.length===n.length&&x(t,function(t,e){return t===n[e]})},reverse:function(t){var n=S.call(t,0);return n.reverse(),n},chunk:function(t,n){for(var e=[],r=0;r<t.length;r+=n){var o=t.slice(r,r+n);e.push(o)}return e},difference:function(t,n){return h(t,function(t){return!d(n,t)})},mapToObject:function(t,n){for(var e={},r=0,o=t.length;r<o;r++){var i=t[r];e[String(i)]=n(i,r)}return e},pure:function(t){return[t]},sort:function(t,n){var e=S.call(t,0);return e.sort(n),e},range:function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e},head:function(t){return 0===t.length?s.none():s.some(t[0])},last:function(t){return 0===t.length?s.none():s.some(t[t.length-1])}},R=void 0===(n=Object.keys)?function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e);return n}:n,T=function(t,n){for(var e=R(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i,t)}},D=function(t,n){var e={};return T(t,function(r,o){var i=n(r,o,t);e[i.k]=i.v}),e},A=function(t,n){var e=[];return T(t,function(t,r){e.push(n(t,r))}),e},k=function(t){return A(t,function(t){return t})},N={bifilter:function(t,n){var e={},r={};return T(t,function(t,o){(n(t,o)?e:r)[o]=t}),{t:e,f:r}},each:T,map:function(t,n){return D(t,function(t,e,r){return{k:e,v:n(t,e,r)}})},mapToArray:A,tupleMap:D,find:function(t,n){for(var e=R(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];if(n(u,i,t))return s.some(u)}return s.none()},keys:R,values:k,size:function(t){return k(t).length}},O=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},E={isString:O("string"),isObject:O("object"),isArray:O("array"),isNull:O("null"),isBoolean:O("boolean"),isUndefined:O("undefined"),isFunction:O("function"),isNumber:O("number")},B=function(t){return t.slice(0).sort()},P={sort:B,reqMessage:function(t,n){throw new Error("All required keys ("+B(t).join(", ")+") were not specified. Specified keys were: "+B(n).join(", ")+".")},unsuppMessage:function(t){throw new Error("Unsupported keys for object: "+B(t).join(", "))},validateStrArr:function(t,n){if(!E.isArray(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");C.each(n,function(n){if(!E.isString(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})},invalidTypeMessage:function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+B(t).join(", ")+") were not.")},checkDupes:function(t){var n=B(t);C.find(n,function(t,e){return e<n.length-1&&t===n[e+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})}},I={immutable:function(){var t=arguments;return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return C.each(t,function(t,e){r[t]=o.constant(n[e])}),r}},immutableBag:function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return P.validateStrArr("required",t),P.validateStrArr("optional",n),P.checkDupes(e),function(r){var i=N.keys(r);C.forall(t,function(t){return C.contains(i,t)})||P.reqMessage(t,i);var u=C.filter(i,function(t){return!C.contains(e,t)});u.length>0&&P.unsuppMessage(u);var a={};return C.each(t,function(t){a[t]=o.constant(r[t])}),C.each(n,function(t){a[t]=o.constant(Object.prototype.hasOwnProperty.call(r,t)?s.some(r[t]):s.none())}),a}}},W=I.immutable("width","height"),M=I.immutable("rows","columns"),L=I.immutable("row","column"),q=I.immutable("x","y"),F=I.immutable("element","rowspan","colspan"),z=I.immutable("element","rowspan","colspan","isNew"),j={dimensions:W,grid:M,address:L,coords:q,extended:I.immutable("element","rowspan","colspan","row","column"),detail:F,detailnew:z,rowdata:I.immutable("element","cells","section"),elementnew:I.immutable("element","isNew"),rowdatanew:I.immutable("element","cells","section","isNew"),rowcells:I.immutable("cells","section"),rowdetails:I.immutable("details","section"),bounds:I.immutable("startRow","startCol","finishRow","finishCol")},_=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:o.constant(t)}},H={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return _(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return _(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return _(e)},fromDom:_,fromPoint:function(t,n,e){return s.from(t.dom().elementFromPoint(n,e)).map(_)}},V=8,U=9,G=1,X=3,Y=G,K=U,$=function(t){return t.nodeType!==Y&&t.nodeType!==K||0===t.childElementCount},J={all:function(t,n){var e=void 0===n?document:n.dom();return $(e)?[]:C.map(e.querySelectorAll(t),H.fromDom)},is:function(t,n){var e=t.dom();if(e.nodeType!==Y)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},one:function(t,n){var e=void 0===n?document:n.dom();return $(e)?s.none():s.from(e.querySelector(t)).map(H.fromDom)}},Q=function(t,n){var e=[],r=function(t){return e.push(t),n(t)},o=n(t);do{o=o.bind(r)}while(o.isSome());return e},Z="undefined"!=typeof window?window:Function("return this;")(),tt=function(t,n){for(var e=void 0!==n&&null!==n?n:Z,r=0;r<t.length&&void 0!==e&&null!==e;++r)e=e[t[r]];return e},nt=function(t,n){var e=t.split(".");return tt(e,n)},et=function(t,n){var e=function(t,n){return nt(t,n)}(t,n);if(void 0===e||null===e)throw t+" not available on this browser";return e},rt=function(){return et("Node")},ot=function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)},it=function(t,n){return ot(t,n,rt().DOCUMENT_POSITION_CONTAINED_BY)},ut=function(t){var n,e=!1;return function(){return e||(e=!0,n=t.apply(null,arguments)),n}},at=function(){return ct(0,0)},ct=function(t,n){return{major:t,minor:n}},lt={nu:ct,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?at():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return ct(r(1),r(2))}(t,e)},unknown:at},st=function(t,n){return function(){return n===t}},ft=function(t){var n=t.current;return{current:n,version:t.version,isEdge:st("Edge",n),isChrome:st("Chrome",n),isIE:st("IE",n),isOpera:st("Opera",n),isFirefox:st("Firefox",n),isSafari:st("Safari",n)}},dt={unknown:function(){return ft({current:void 0,version:lt.unknown()})},nu:ft,edge:o.constant("Edge"),chrome:o.constant("Chrome"),ie:o.constant("IE"),opera:o.constant("Opera"),firefox:o.constant("Firefox"),safari:o.constant("Safari")},mt=function(t,n){return function(){return n===t}},gt=function(t){var n=t.current;return{current:n,version:t.version,isWindows:mt("Windows",n),isiOS:mt("iOS",n),isAndroid:mt("Android",n),isOSX:mt("OSX",n),isLinux:mt("Linux",n),isSolaris:mt("Solaris",n),isFreeBSD:mt("FreeBSD",n)}},pt={unknown:function(){return gt({current:void 0,version:lt.unknown()})},nu:gt,windows:o.constant("Windows"),ios:o.constant("iOS"),android:o.constant("Android"),linux:o.constant("Linux"),osx:o.constant("OSX"),solaris:o.constant("Solaris"),freebsd:o.constant("FreeBSD")},ht=function(t,n){var e=String(n).toLowerCase();return C.find(t,function(t){return t.search(e)})},vt=function(t,n){return ht(t,n).map(function(t){var e=lt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},bt=function(t,n){return ht(t,n).map(function(t){var e=lt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},wt=function(t,n){return n+t},yt=function(t,n){return t+n},xt=function(t,n){return t.substring(n)},St=function(t,n){return t.substring(0,t.length-n)},Ct=function(t){return""===t?s.none():s.some(t.substr(0,1))},Rt=function(t){return""===t?s.none():s.some(t.substring(1))},Tt=function(t,n,e){return""===n||!(t.length<n.length)&&t.substr(e,e+n.length)===n},Dt=function(t,n){return Tt(t,n,0)},At=function(t,n){return Tt(t,n,t.length-n.length)},kt={supplant:function(t,n){return t.replace(/\${([^{}]*)}/g,function(t,e){var r=n[e];return function(t){var n=typeof t;return"string"===n||"number"===n}(r)?r:t})},startsWith:Dt,removeLeading:function(t,n){return Dt(t,n)?xt(t,n.length):t},removeTrailing:function(t,n){return At(t,n)?St(t,n.length):t},ensureLeading:function(t,n){return Dt(t,n)?t:wt(t,n)},ensureTrailing:function(t,n){return At(t,n)?t:yt(t,n)},endsWith:At,contains:function(t,n){return-1!==t.indexOf(n)},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},lTrim:function(t){return t.replace(/^\s+/g,"")},rTrim:function(t){return t.replace(/\s+$/g,"")},capitalize:function(t){return Ct(t).bind(function(n){return Rt(t).map(function(t){return n.toUpperCase()+t})}).getOr(t)}},Nt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ot=function(t){return function(n){return kt.contains(n,t)}},Et=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return kt.contains(t,"edge/")&&kt.contains(t,"chrome")&&kt.contains(t,"safari")&&kt.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Nt],search:function(t){return kt.contains(t,"chrome")&&!kt.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return kt.contains(t,"msie")||kt.contains(t,"trident")}},{name:"Opera",versionRegexes:[Nt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ot("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ot("firefox")},{name:"Safari",versionRegexes:[Nt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(kt.contains(t,"safari")||kt.contains(t,"mobile/"))&&kt.contains(t,"applewebkit")}}],Bt=[{name:"Windows",search:Ot("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return kt.contains(t,"iphone")||kt.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ot("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ot("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ot("linux"),versionRegexes:[]},{name:"Solaris",search:Ot("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ot("freebsd"),versionRegexes:[]}],Pt={browsers:o.constant(Et),oses:o.constant(Bt)},It=function(t){var n=Pt.browsers(),e=Pt.oses(),r=vt(n,t).fold(dt.unknown,dt.nu),i=bt(e,t).fold(pt.unknown,pt.nu);return{browser:r,os:i,deviceType:function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=r||u||a&&!0===/mobile/i.test(e),l=t.isiOS()||t.isAndroid(),s=l&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:o.constant(r),isiPhone:o.constant(i),isTablet:o.constant(c),isPhone:o.constant(s),isTouch:o.constant(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o.constant(f)}}(i,r,t)}},Wt={detect:ut(function(){var t=navigator.userAgent;return It(t)})},Mt=function(t,n){return t.dom()===n.dom()},Lt=Wt.detect().browser.isIE()?function(t,n){return it(t.dom(),n.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},qt={eq:Mt,isEqualNode:function(t,n){return t.dom().isEqualNode(n.dom())},member:function(t,n){return C.exists(n,o.curry(Mt,t))},contains:Lt,is:J.is},Ft=function(t){return H.fromDom(t.dom().ownerDocument)},zt=function(t){var n=t.dom();return s.from(n.parentNode).map(H.fromDom)},jt=function(t){var n=t.dom();return s.from(n.previousSibling).map(H.fromDom)},_t=function(t){var n=t.dom();return s.from(n.nextSibling).map(H.fromDom)},Ht=function(t){var n=t.dom();return C.map(n.childNodes,H.fromDom)},Vt=function(t,n){var e=t.dom().childNodes;return s.from(e[n]).map(H.fromDom)},Ut=I.immutable("element","offset"),Gt={owner:Ft,defaultView:function(t){var n=t.dom().ownerDocument.defaultView;return H.fromDom(n)},documentElement:function(t){var n=Ft(t);return H.fromDom(n.dom().documentElement)},parent:zt,findIndex:function(t){return zt(t).bind(function(n){var e=Ht(n);return C.findIndex(e,function(n){return qt.eq(t,n)})})},parents:function(t,n){for(var e=E.isFunction(n)?n:o.constant(!1),r=t.dom(),i=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,a=H.fromDom(u);if(i.push(a),!0===e(a))break;r=u}return i},siblings:function(t){return zt(t).map(Ht).map(function(n){return C.filter(n,function(n){return!qt.eq(t,n)})}).getOr([])},prevSibling:jt,offsetParent:function(t){var n=t.dom();return s.from(n.offsetParent).map(H.fromDom)},prevSiblings:function(t){return C.reverse(Q(t,jt))},nextSibling:_t,nextSiblings:function(t){return Q(t,_t)},children:Ht,child:Vt,firstChild:function(t){return Vt(t,0)},lastChild:function(t){return Vt(t,t.dom().childNodes.length-1)},childNodesCount:function(t){return t.dom().childNodes.length},hasChildNodes:function(t){return t.dom().hasChildNodes()},leaf:function(t,n){var e=Ht(t);return e.length>0&&n<e.length?Ut(e[n],0):Ut(t,n)}},Xt=function(t,n,e){return C.bind(Gt.children(t),function(t){return J.is(t,n)?e(t)?[t]:[]:Xt(t,n,e)})},Yt={firstLayer:function(t,n){return Xt(t,n,o.constant(!0))},filterFirstLayer:Xt},Kt=function(t){return t.dom().nodeName.toLowerCase()},$t=function(t){return t.dom().nodeType},Jt=function(t){return function(n){return $t(n)===t}},Qt=Jt(G),Zt=Jt(X),tn=Jt(U),nn={name:Kt,type:$t,value:function(t){return t.dom().nodeValue},isElement:Qt,isText:Zt,isDocument:tn,isComment:function(t){return $t(t)===V||"#comment"===Kt(t)}},en=function(t,n,e){if(!(E.isString(e)||E.isBoolean(e)||E.isNumber(e)))throw console.error("Invalid call to Attr.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},rn=function(t,n,e){en(t.dom(),n,e)},on=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},un=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},an={clone:function(t){return C.foldl(t.dom().attributes,function(t,n){return t[n.name]=n.value,t},{})},set:rn,setAll:function(t,n){var e=t.dom();N.each(n,function(t,n){en(e,n,t)})},get:on,has:un,remove:function(t,n){t.dom().removeAttribute(n)},hasNone:function(t){var n=t.dom().attributes;return void 0===n||null===n||0===n.length},transfer:function(t,n,e){nn.isElement(t)&&nn.isElement(n)&&C.each(e,function(e){!function(t,n,e){un(t,e)&&!un(n,e)&&rn(n,e,on(t,e))}(t,n,e)})}},cn=ut(function(){return ln(H.fromDom(document))}),ln=function(t){var n=t.dom().body;if(null===n||void 0===n)throw"Body is not available yet";return H.fromDom(n)},sn={body:cn,getBody:ln,inBody:function(t){var n=nn.isText(t)?t.dom().parentNode:t.dom();return void 0!==n&&null!==n&&n.ownerDocument.body.contains(n)}},fn=function(t,n){var e=[];return C.each(Gt.children(t),function(t){n(t)&&(e=e.concat([t])),e=e.concat(fn(t,n))}),e},dn={all:function(t){return fn(sn.body(),t)},ancestors:function(t,n,e){return C.filter(Gt.parents(t,e),n)},siblings:function(t,n){return C.filter(Gt.siblings(t),n)},children:function(t,n){return C.filter(Gt.children(t),n)},descendants:fn},mn={all:function(t){return J.all(t)},ancestors:function(t,n,e){return dn.ancestors(t,function(t){return J.is(t,n)},e)},siblings:function(t,n){return dn.siblings(t,function(t){return J.is(t,n)})},children:function(t,n){return dn.children(t,function(t){return J.is(t,n)})},descendants:function(t,n){return J.all(n,t)}};function gn(t,n,e,r,o){return t(e,r)?s.some(e):E.isFunction(o)&&o(e)?s.none():n(e,r,o)}var pn=function(t,n,e){for(var r=t.dom(),i=E.isFunction(e)?e:o.constant(!1);r.parentNode;){r=r.parentNode;var u=H.fromDom(r);if(n(u))return s.some(u);if(i(u))break}return s.none()},hn=function(t,n){return C.find(t.dom().childNodes,o.compose(n,H.fromDom)).map(H.fromDom)},vn=function(t,n){var e=function(t){for(var r=0;r<t.childNodes.length;r++){if(n(H.fromDom(t.childNodes[r])))return s.some(H.fromDom(t.childNodes[r]));var o=e(t.childNodes[r]);if(o.isSome())return o}return s.none()};return e(t.dom())},bn={first:function(t){return vn(sn.body(),t)},ancestor:pn,closest:function(t,n,e){return gn(function(t){return n(t)},pn,t,n,e)},sibling:function(t,n){var e=t.dom();return e.parentNode?hn(H.fromDom(e.parentNode),function(e){return!qt.eq(t,e)&&n(e)}):s.none()},child:hn,descendant:vn},wn=function(t,n,e){return bn.ancestor(t,function(t){return J.is(t,n)},e)},yn={first:function(t){return J.one(t)},ancestor:wn,sibling:function(t,n){return bn.sibling(t,function(t){return J.is(t,n)})},child:function(t,n){return bn.child(t,function(t){return J.is(t,n)})},descendant:function(t,n){return J.one(n,t)},closest:function(t,n,e){return gn(J.is,wn,t,n,e)}},xn=function(t,n,e){var r=void 0!==e?e:o.constant(!1);return r(n)?s.none():C.contains(t,nn.name(n))?s.some(n):yn.ancestor(n,t.join(","),function(t){return J.is(t,"table")||r(t)})},Sn=function(t,n){return Gt.parent(n).map(function(n){return mn.children(n,t)})},Cn=function(t,n){return parseInt(an.get(t,n),10)},Rn={cell:function(t,n){return xn(["td","th"],t,n)},firstCell:function(t){return yn.descendant(t,"th,td")},cells:function(t){return Yt.firstLayer(t,"th,td")},neighbourCells:o.curry(Sn,"th,td"),table:function(t,n){return yn.closest(t,"table",n)},row:function(t,n){return xn(["tr"],t,n)},rows:function(t){return Yt.firstLayer(t,"tr")},notCell:function(t,n){return xn(["caption","tr","tbody","tfoot","thead"],t,n)},neighbourRows:o.curry(Sn,"tr"),attr:Cn,grid:function(t,n,e){var r=Cn(t,n),o=Cn(t,e);return j.grid(r,o)}},Tn=function(t){var n=Rn.rows(t);return C.map(n,function(t){var n=t,e=Gt.parent(n).bind(function(t){var n=nn.name(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"}),r=C.map(Rn.cells(t),function(t){var n=an.has(t,"rowspan")?parseInt(an.get(t,"rowspan"),10):1,e=an.has(t,"colspan")?parseInt(an.get(t,"colspan"),10):1;return j.detail(t,n,e)});return j.rowdata(n,r,e)})},Dn=function(t,n){return C.map(t,function(t){var e=C.map(Rn.cells(t),function(t){var n=an.has(t,"rowspan")?parseInt(an.get(t,"rowspan"),10):1,e=an.has(t,"colspan")?parseInt(an.get(t,"colspan"),10):1;return j.detail(t,n,e)});return j.rowdata(t,e,n.section())})},An=function(t,n){return t+","+n},kn=function(t,n){var e=C.bind(t.all(),function(t){return t.cells()});return C.filter(e,n)},Nn={generate:function(t){var n={},e=[],r=t.length,i=0;C.each(t,function(t,r){var o=[];C.each(t.cells(),function(t,e){for(var u=0;void 0!==n[An(r,u)];)u++;for(var a=j.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var s=u+c,f=An(r+l,s);n[f]=a,i=Math.max(i,s+1)}o.push(a)}),e.push(j.rowdata(t.element(),o,t.section()))});var u=j.grid(r,i);return{grid:o.constant(u),access:o.constant(n),all:o.constant(e)}},getAt:function(t,n,e){var r=t.access()[An(n,e)];return void 0!==r?s.some(r):s.none()},findItem:function(t,n,e){var r=kn(t,function(t){return e(n,t.element())});return r.length>0?s.some(r[0]):s.none()},filterItems:kn,justCells:function(t){var n=C.map(t.all(),function(t){return t.cells()});return C.flatten(n)}},On={isSupported:function(t){return void 0!==t.style}},En=function(t,n,e){if(!E.isString(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);On.isSupported(t)&&t.style.setProperty(n,e)},Bn=function(t,n){On.isSupported(t)&&t.style.removeProperty(n)},Pn=function(t,n,e){var r=t.dom();En(r,n,e)},In=function(t,n){return On.isSupported(t)?t.style.getPropertyValue(n):""},Wn=function(t,n){var e=t.dom(),r=In(e,n);return s.from(r).filter(function(t){return t.length>0})},Mn={copy:function(t,n){var e=t.dom(),r=n.dom();On.isSupported(e)&&On.isSupported(r)&&(r.style.cssText=e.style.cssText)},set:Pn,preserve:function(t,n){var e=an.get(t,"style"),r=n(t);return(void 0===e?an.remove:an.set)(t,"style",e),r},setAll:function(t,n){var e=t.dom();N.each(n,function(t,n){En(e,n,t)})},setOptions:function(t,n){var e=t.dom();N.each(n,function(t,n){t.fold(function(){Bn(e,n)},function(t){En(e,n,t)})})},remove:function(t,n){var e=t.dom();Bn(e,n),an.has(t,"style")&&""===kt.trim(an.get(t,"style"))&&an.remove(t,"style")},get:function(t,n){var e=t.dom(),r=window.getComputedStyle(e).getPropertyValue(n),o=""!==r||sn.inBody(t)?r:In(e,n);return null===o?void 0:o},getRaw:Wn,getAllRaw:function(t){var n={},e=t.dom();if(On.isSupported(e))for(var r=0;r<e.style.length;r++){var o=e.style.item(r);n[o]=e.style[o]}return n},isValidValue:function(t,n,e){var r=H.fromTag(t);return Pn(r,n,e),Wn(r,n).isSome()},reflow:function(t){return t.dom().offsetWidth},transfer:function(t,n,e){nn.isElement(t)&&nn.isElement(n)&&C.each(e,function(e){!function(t,n,e){Wn(t,e).each(function(t){Wn(n,e).isNone()&&Pn(n,e,t)})}(t,n,e)})}},Ln=function(t,n){Gt.parent(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})},qn=function(t,n){t.dom().appendChild(n.dom())},Fn={before:Ln,after:function(t,n){Gt.nextSibling(t).fold(function(){Gt.parent(t).each(function(t){qn(t,n)})},function(t){Ln(t,n)})},prepend:function(t,n){Gt.firstChild(t).fold(function(){qn(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},append:qn,appendAt:function(t,n,e){Gt.child(t,e).fold(function(){qn(t,n)},function(t){Ln(t,n)})},wrap:function(t,n){Ln(t,n),qn(n,t)}},zn={before:function(t,n){C.each(n,function(n){Fn.before(t,n)})},after:function(t,n){C.each(n,function(e,r){var o=0===r?t:n[r-1];Fn.after(o,e)})},prepend:function(t,n){C.each(n.slice().reverse(),function(n){Fn.prepend(t,n)})},append:function(t,n){C.each(n,function(n){Fn.append(t,n)})}},jn=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},_n={empty:function(t){t.dom().textContent="",C.each(Gt.children(t),function(t){jn(t)})},remove:jn,unwrap:function(t){var n=Gt.children(t);n.length>0&&zn.before(t,n),jn(t)}},Hn=I.immutable("minRow","minCol","maxRow","maxCol"),Vn=function(t,n){var e=t.grid().columns(),r=t.grid().rows(),o=e,i=0,u=0;return N.each(t.access(),function(t){if(n(t)){var e=t.row(),a=e+t.rowspan()-1,c=t.column(),l=c+t.colspan()-1;e<r?r=e:a>i&&(i=a),c<o?o=c:l>u&&(u=l)}}),Hn(r,o,i,u)},Un=function(t,n,e){var r=t[e].element(),o=H.fromTag("td");Fn.append(o,H.fromTag("br")),(n?Fn.append:Fn.prepend)(r,o)},Gn=function(t,n){var e=function(t){return J.is(t.element(),n)},r=Tn(t),o=Nn.generate(r),i=Vn(o,e),u="th:not("+n+"),td:not("+n+")",a=Yt.filterFirstLayer(t,"th,td",function(t){return J.is(t,u)});return C.each(a,_n.remove),function(t,n,e,r){for(var o=n.grid().columns(),i=n.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)u<e.minRow()||u>e.maxRow()||c<e.minCol()||c>e.maxCol()||(Nn.getAt(n,u,c).filter(r).isNone()?Un(t,a,u):a=!0)}(r,o,i,e),function(t,n){var e=C.filter(Yt.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});C.each(e,_n.remove),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||C.each(Yt.firstLayer(t,"th,td"),function(t){an.remove(t,"rowspan"),an.remove(t,"colspan")}),an.remove(t,"width"),an.remove(t,"height"),Mn.remove(t,"width"),Mn.remove(t,"height")}(t,i),t},Xn=function(t,n){return H.fromDom(t.dom().cloneNode(n))},Yn=function(t){return Xn(t,!0)},Kn=function(t,n){var e=H.fromTag(n),r=an.clone(t);return an.setAll(e,r),e},$n=function(t){return Xn(t,!1)},Jn=Yn,Qn=function(t,n){var e=Kn(t,n),r=Gt.children(Yn(t));return zn.append(e,r),e},Zn=function(t,n){var e=function(n){return t(n)?s.from(n.dom().nodeValue):s.none()},r=Wt.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return e(t)}catch(t){return s.none()}}:e;return{get:function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return o(e).getOr("")},getOption:o,set:function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r}}}(nn.isText,"text"),te={get:function(t){return Zn.get(t)},getOption:function(t){return Zn.getOption(t)},set:function(t,n){Zn.set(t,n)}},ne=function(t){return"img"===nn.name(t)?1:te.getOption(t).fold(function(){return Gt.children(t).length},function(t){return t.length})},ee=["img","br"],re=ne,oe=function(t){var n;return n=t,te.getOption(n).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()||C.contains(ee,nn.name(t))},ie=function(t,n){var e=function(t){for(var r=Gt.children(t),o=r.length-1;o>=0;o--){var i=r[o];if(n(i))return s.some(i);var u=e(i);if(u.isSome())return u}return s.none()};return e(t)},ue={first:function(t){return bn.descendant(t,oe)},last:function(t){return ie(t,oe)}},ae=function(){var t=H.fromTag("td");return Fn.append(t,H.fromTag("br")),t},ce=function(t,n,e){var r=Qn(t,n);return N.each(e,function(t,n){null===t?an.remove(r,n):an.set(r,n,t)}),r},le=function(t){return t},se=function(t){return function(){return H.fromTag("tr",t.dom())}},fe={cellOperations:function(t,n,e){return{row:se(n),cell:function(n){var r=Gt.owner(n.element()),o=H.fromTag(nn.name(n.element()),r.dom()),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?function(t,n,e){return ue.first(t).map(function(r){var o=e.join(","),i=mn.ancestors(r,o,function(n){return qt.eq(n,t)});return C.foldr(i,function(t,n){var e=$n(n);return Fn.append(t,e),e},n)}).getOr(n)}(n.element(),o,i):o;return Fn.append(u,H.fromTag("br")),Mn.copy(n.element(),o),Mn.remove(o,"height"),1!==n.colspan()&&Mn.remove(n.element(),"width"),t(n.element(),o),o},replace:ce,gap:ae}},paste:function(t){return{row:se(t),cell:ae,replace:le,gap:ae}}},de=function(t,n){var e=(n||document).createElement("div");return e.innerHTML=t,Gt.children(H.fromDom(e))},me=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function ge(){return{up:o.constant({selector:yn.ancestor,closest:yn.closest,predicate:bn.ancestor,all:Gt.parents}),down:o.constant({selector:mn.descendants,predicate:dn.descendants}),styles:o.constant({get:Mn.get,getRaw:Mn.getRaw,set:Mn.set,remove:Mn.remove}),attrs:o.constant({get:an.get,set:an.set,remove:an.remove,copyTo:function(t,n){var e=an.clone(t);an.setAll(n,e)}}),insert:o.constant({before:Fn.before,after:Fn.after,afterAll:zn.after,append:Fn.append,appendAll:zn.append,prepend:Fn.prepend,wrap:Fn.wrap}),remove:o.constant({unwrap:_n.unwrap,remove:_n.remove}),create:o.constant({nu:H.fromTag,clone:function(t){return H.fromDom(t.dom().cloneNode(!1))},text:H.fromText}),query:o.constant({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:Gt.prevSibling,nextSibling:Gt.nextSibling}),property:o.constant({children:Gt.children,name:nn.name,parent:Gt.parent,isText:nn.isText,isComment:nn.isComment,isElement:nn.isElement,getText:te.get,setText:te.set,isBoundary:function(t){return!!nn.isElement(t)&&("body"===nn.name(t)||C.contains(me,nn.name(t)))},isEmptyTag:function(t){return!!nn.isElement(t)&&C.contains(["br","img","hr","input"],nn.name(t))}}),eq:qt.eq,is:qt.is}}I.immutable("left","right");var pe=function(t,n,e,r){var o=n(t,e);return C.foldr(r,function(e,r){var o=n(t,r);return he(t,e,o)},o)},he=function(t,n,e){return n.bind(function(n){return e.filter(o.curry(t.eq,n))})},ve=function(t,n,e){return e.length>0?function(t,n,e,r){return r(t,n,e[0],e.slice(1))}(t,n,e,pe):s.none()},be=function(t,n){return o.curry(t.eq,n)},we=function(t,n,e,r){var i=void 0!==r?r:o.constant(!1),u=[n].concat(t.up().all(n)),a=[e].concat(t.up().all(e)),c=function(t){return C.findIndex(t,i).fold(function(){return t},function(n){return t.slice(0,n+1)})},l=c(u),s=c(a),f=C.find(l,function(n){return C.exists(s,be(t,n))});return{firstpath:o.constant(l),secondpath:o.constant(s),shared:o.constant(f)}},ye=we,xe=function(t,n,e){return ve(t,n,e)},Se=function(t,n,e,r){return ye(t,n,e,r)},Ce=ge(),Re=function(t,n){return xe(Ce,function(n,e){return t(e)},n)},Te=function(t,n,e){return Se(Ce,t,n,e)},De=function(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()},Ae=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},ke=function(t,n){for(var e=!0,r=o.curry(De,n),i=n.startRow();i<=n.finishRow();i++)for(var u=n.startCol();u<=n.finishCol();u++)e=e&&Nn.getAt(t,i,u).exists(r);return e?s.some(n):s.none()},Ne=function(t,n,e){var r=Nn.findItem(t,n,qt.eq),o=Nn.findItem(t,e,qt.eq);return r.bind(function(t){return o.map(function(n){return e=t,r=n,j.bounds(Math.min(e.row(),r.row()),Math.min(e.column(),r.column()),Math.max(e.row()+e.rowspan()-1,r.row()+r.rowspan()-1),Math.max(e.column()+e.colspan()-1,r.column()+r.colspan()-1));var e,r})})},Oe=Ne,Ee=function(t,n,e){return Ne(t,n,e).bind(function(n){return ke(t,n)})},Be=function(t,n,e,r){return Nn.findItem(t,n,qt.eq).bind(function(n){var o=e>0?n.row()+n.rowspan()-1:n.row(),i=r>0?n.column()+n.colspan()-1:n.column();return Nn.getAt(t,o+e,i+r).map(function(t){return t.element()})})},Pe=function(t,n,e){return Oe(t,n,e).map(function(n){var e=Nn.filterItems(t,o.curry(Ae,n));return C.map(e,function(t){return t.element()})})},Ie=function(t,n){return Nn.findItem(t,n,function(t,n){return qt.contains(n,t)}).bind(function(t){return t.element()})},We=function(t){var n=Tn(t);return Nn.generate(n)},Me=function(t,n,e){return Rn.table(t).bind(function(r){var o=We(r);return Be(o,t,n,e)})},Le=function(t,n,e){var r=We(t);return Pe(r,n,e)},qe=function(t,n,e,r,o){var i=We(t),u=qt.eq(t,e)?n:Ie(i,n),a=qt.eq(t,o)?r:Ie(i,r);return Pe(i,u,a)},Fe=function(t,n,e){var r=We(t);return Ee(r,n,e)},ze=function(t,n){return yn.ancestor(t,"table")},je=I.immutableBag(["boxes","start","finish"],[]),_e=function(t,n,e){var r=function(t){return function(n){return e(n)||qt.eq(n,t)}};return qt.eq(t,n)?s.some(je({boxes:s.some([t]),start:t,finish:n})):ze(t).bind(function(o){return ze(n).bind(function(i){if(qt.eq(o,i))return s.some(je({boxes:Le(o,t,n),start:t,finish:n}));if(qt.contains(o,i)){var u=(a=mn.ancestors(n,"td,th",r(o))).length>0?a[a.length-1]:n;return s.some(je({boxes:qe(o,t,o,n,i),start:t,finish:u}))}if(qt.contains(i,o)){var a,c=(a=mn.ancestors(t,"td,th",r(i))).length>0?a[a.length-1]:t;return s.some(je({boxes:qe(i,t,o,n,i),start:t,finish:c}))}return Te(t,n).shared().bind(function(u){return yn.closest(u,"table",e).bind(function(e){var u=mn.ancestors(n,"td,th",r(e)),a=u.length>0?u[u.length-1]:n,c=mn.ancestors(t,"td,th",r(e)),l=c.length>0?c[c.length-1]:t;return s.some(je({boxes:qe(e,t,o,n,i),start:l,finish:a}))})})})})},He={identify:_e,retrieve:function(t,n){var e=mn.descendants(t,n);return e.length>0?s.some(e):s.none()},shiftSelection:function(t,n,e,r,i){return function(t,n){return C.find(t,function(t){return J.is(t,n)})}(t,i).bind(function(t){return Me(t,n,e).bind(function(t){return function(t,n){return yn.ancestor(t,"table").bind(function(e){return yn.descendant(e,n).bind(function(n){return _e(n,t).bind(function(t){return t.boxes().map(function(n){return{boxes:o.constant(n),start:o.constant(t.start()),finish:o.constant(t.finish())}})})})})}(t,r)})})},getEdges:function(t,n,e){return yn.descendant(t,n).bind(function(n){return yn.descendant(t,e).bind(function(t){return Re(ze,[n,t]).map(function(e){return{first:o.constant(n),last:o.constant(t),table:o.constant(e)}})})})}},Ve={retrieve:function(t,n){return He.retrieve(t,n)},retrieveBox:function(t,n,e){return He.getEdges(t,n,e).bind(function(n){var e=function(n){return qt.eq(t,n)},r=yn.ancestor(n.first(),"thead,tfoot,tbody,table",e),o=yn.ancestor(n.last(),"thead,tfoot,tbody,table",e);return r.bind(function(t){return o.bind(function(e){return qt.eq(t,e)?Fe(n.table(),n.first(),n.last()):s.none()})})})}},Ue="data-mce-selected",Ge={selected:o.constant(Ue),selectedSelector:o.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:o.constant("[data-mce-selected]"),firstSelected:o.constant("data-mce-first-selected"),firstSelectedSelector:o.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:o.constant("data-mce-last-selected"),lastSelectedSelector:o.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},Xe=function(t){if(!E.isArray(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return C.each(t,function(r,o){var i=N.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!E.isArray(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){var e=arguments.length;if(e!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+e);for(var r=new Array(e),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(t){var e=N.keys(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!C.forall(n,function(t){return C.contains(e,t)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,r)},log:function(t){console.log(t,{constructors:n,constructor:u,params:r})}}}}),e},Ye=Xe([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Ke={cata:function(t,n,e,r){return t.fold(n,e,r)},none:Ye.none,multiple:Ye.multiple,single:Ye.single},$e=function(t,n){return Ke.cata(n.get(),o.constant([]),o.identity,o.constant([t]))},Je=function(t,n){return Ke.cata(n.get(),s.none,function(n,e){return 0===n.length?s.none():Ve.retrieveBox(t,Ge.firstSelectedSelector(),Ge.lastSelectedSelector()).bind(function(t){return n.length>1?s.some({bounds:o.constant(t),cells:o.constant(n)}):s.none()})},s.none)},Qe=function(t,n){var e=$e(t,n);return e.length>0&&C.forall(e,function(t){return an.has(t,"rowspan")&&parseInt(an.get(t,"rowspan"),10)>1||an.has(t,"colspan")&&parseInt(an.get(t,"colspan"),10)>1})?s.some(e):s.none()},Ze=$e,tr=function(t){return{element:o.constant(t),mergable:s.none,unmergable:s.none,selection:o.constant([t])}},nr=I.immutable("element","clipboard","generators"),er={noMenu:tr,forMenu:function(t,n,e){return{element:o.constant(e),mergable:o.constant(Je(n,t)),unmergable:o.constant(Qe(e,t)),selection:o.constant(Ze(e,t))}},notCell:function(t){return tr(t)},paste:nr,pasteRows:function(t,n,e,r,i){return{element:o.constant(e),mergable:s.none,unmergable:s.none,selection:o.constant(Ze(e,t)),clipboard:o.constant(r),generators:o.constant(i)}}},rr={registerEvents:function(t,n,e,r){t.on("BeforeGetContent",function(e){!0===e.selection&&Ke.cata(n.get(),o.noop,function(n){e.preventDefault(),function(t){return Rn.table(t[0]).map(Jn).map(function(t){return[Gn(t,Ge.attributeSelector())]})}(n).each(function(n){e.content=C.map(n,function(n){return function(t,n){return t.selection.serializer.serialize(n.dom(),{})}(t,n)}).join("")})},o.noop)}),t.on("BeforeSetContent",function(n){!0===n.selection&&!0===n.paste&&s.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(o){var i=H.fromDom(o);Rn.table(i).bind(function(o){var u=C.filter(de(n.content),function(t){return"meta"!==nn.name(t)});if(1===u.length&&"table"===nn.name(u[0])){n.preventDefault();var a=H.fromDom(t.getDoc()),c=fe.paste(a),l=er.paste(i,u[0],c);e.pasteCells(o,l).each(function(n){t.selection.setRng(n),t.focus(),r.clear(o)})}})})})}};function or(t,n){var e=function(e){var r=n(e);if(r<=0||null===r){var o=Mn.get(e,t);return parseFloat(o)||0}return r},r=function(t,n){return C.foldl(n,function(n,e){var r=Mn.get(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o},0)};return{set:function(n,e){if(!E.isNumber(e)&&!e.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+e;var r=n.dom();On.isSupported(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return n>o?n-o:0}}}var ir=or("height",function(t){return sn.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight}),ur=function(t){return ir.get(t)},ar=function(t){return ir.getOuter(t)},cr=or("width",function(t){return t.dom().offsetWidth}),lr=function(t){return cr.get(t)},sr=function(t){return cr.getOuter(t)},fr=Wt.detect(),dr=function(t,n,e){return function(t,n){var e=parseFloat(t);return isNaN(e)?n:e}(Mn.get(t,n),e)},mr=function(t){return fr.browser.isIE()||fr.browser.isEdge()?function(t){var n=dr(t,"padding-top",0),e=dr(t,"padding-bottom",0),r=dr(t,"border-top-width",0),o=dr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===Mn.get(t,"box-sizing")?i:i-n-e-(r+o)}(t):dr(t,"height",ur(t))},gr=/(\d+(\.\d+)?)(\w|%)*/,pr=/(\d+(\.\d+)?)%/,hr=/(\d+(\.\d+)?)px|em/,vr=function(t,n){Mn.set(t,"height",n+"px")},br=function(t,n,e,r){var o=parseInt(t,10);return kt.endsWith(t,"%")&&"table"!==nn.name(n)?function(t,n,e,r){var o=Rn.table(t).map(function(t){var r=e(t);return Math.floor(n/100*r)}).getOr(n);return r(t,o),o}(n,o,e,r):o},wr=function(t){var n=function(t){return Mn.getRaw(t,"height").getOrThunk(function(){return mr(t)+"px"})}(t);return n?br(n,t,ur,vr):ur(t)},yr=function(t,n){return an.has(t,n)?parseInt(an.get(t,n),10):1},xr=function(t){return Mn.getRaw(t,"width").fold(function(){return s.from(an.get(t,"width"))},function(t){return s.some(t)})},Sr=function(t,n){return t/n.pixelWidth()*100},Cr={percentageBasedSizeRegex:o.constant(pr),pixelBasedSizeRegex:o.constant(hr),setPixelWidth:function(t,n){Mn.set(t,"width",n+"px")},setPercentageWidth:function(t,n){Mn.set(t,"width",n+"%")},setHeight:vr,getPixelWidth:function(t,n){return xr(t).fold(function(){var n=lr(t);return parseInt(n,10)},function(e){return function(t,n,e){if(hr.test(n)){var r=hr.exec(n);return parseInt(r[1],10)}if(pr.test(n)){var o=pr.exec(n);return function(t,n){return t/100*n.pixelWidth()}(parseFloat(o[1]),e)}var i=lr(t);return parseInt(i,10)}(t,e,n)})},getPercentageWidth:function(t,n){return xr(t).fold(function(){var e=lr(t),r=parseInt(e,10);return Sr(r,n)},function(e){return function(t,n,e){if(pr.test(n)){var r=pr.exec(n);return parseFloat(r[1])}var o=lr(t),i=parseInt(o,10);return Sr(i,e)}(t,e,n)})},getGenericWidth:function(t){return xr(t).bind(function(t){if(gr.test(t)){var n=gr.exec(t);return s.some({width:o.constant(n[1]),unit:o.constant(n[3])})}return s.none()})},setGenericWidth:function(t,n,e){Mn.set(t,"width",n+e)},getHeight:function(t){return function(t,n,e){return e(t)/yr(t,n)}(t,"rowspan",wr)},getRawWidth:xr},Rr={halve:function(t,n){Cr.getGenericWidth(t).each(function(e){var r=e.width()/2;Cr.setGenericWidth(t,r,e.unit()),Cr.setGenericWidth(n,r,e.unit())})}},Tr=function(t,n){var e=n||H.fromDom(document.documentElement);return bn.ancestor(t,o.curry(qt.eq,e)).isSome()},Dr=function(t){var n=t.dom();return n===n.window?t:nn.isDocument(t)?n.defaultView||n.parentWindow:null},Ar=function(t,n){return{left:o.constant(t),top:o.constant(n),translate:function(e,r){return Ar(t+e,n+r)}}},kr=function(t,n){return void 0!==t?t:void 0!==n?n:0},Nr=function(t){var n=t.dom(),e=n.ownerDocument,r=e.body,o=H.fromDom(e.documentElement);return r===n?Ar(r.offsetLeft,r.offsetTop):Tr(t,o)?function(t){var n=t.getBoundingClientRect();return Ar(n.left,n.top)}(n):Ar(0,0)},Or=function(t){var n=t.dom().ownerDocument,e=n.body,r=Dr(H.fromDom(n)),o=n.documentElement,i=kr(r.pageYOffset,o.scrollTop),u=kr(r.pageXOffset,o.scrollLeft),a=kr(o.clientTop,e.clientTop),c=kr(o.clientLeft,e.clientLeft);return Nr(t).translate(u-c,i-a)},Er=I.immutable("row","y"),Br=I.immutable("col","x"),Pr=function(t){return Or(t).left()+sr(t)},Ir=function(t){return Or(t).left()},Wr=function(t,n){return Br(t,Ir(n))},Mr=function(t,n){return Br(t,Pr(n))},Lr=function(t){return Or(t).top()},qr=function(t,n,e){if(0===e.length)return[];var r=C.map(e.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=e[e.length-1].map(function(t){return n(e.length-1,t)});return r.concat([o])},Fr={delta:o.identity,positions:o.curry(qr,function(t,n){return Er(t,Lr(n))},function(t,n){return Er(t,Lr(n)+ar(n))}),edge:Lr},zr={delta:o.identity,edge:Ir,positions:o.curry(qr,Wr,Mr)},jr={height:Fr,rtl:{delta:function(t,n){return-t},edge:Pr,positions:o.curry(qr,Mr,Wr)},ltr:zr},_r={ltr:jr.ltr,rtl:jr.rtl};function Hr(t){var n=function(n){return t(n).isRtl()?_r.rtl:_r.ltr};return{delta:function(t,e){return n(e).delta(t,e)},edge:function(t){return n(t).edge(t)},positions:function(t,e){return n(e).positions(t,e)}}}var Vr={getGridSize:function(t){var n=Tn(t);return Nn.generate(n).grid()}},Ur=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return Ur(e())}}},Gr=function(t,n){return Xr(t,n,{validate:E.isFunction,label:"function"})},Xr=function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");return P.validateStrArr("required",n),P.checkDupes(n),function(r){var o=N.keys(r);C.forall(n,function(t){return C.contains(o,t)})||P.reqMessage(n,o),t(n,o);var i=C.filter(n,function(t){return!e.validate(r[t],t)});return i.length>0&&P.invalidTypeMessage(i,e.label),r}},Yr=o.noop,Kr={exactly:o.curry(Gr,function(t,n){var e=C.filter(n,function(n){return!C.contains(t,n)});e.length>0&&P.unsuppMessage(e)}),ensure:o.curry(Gr,Yr),ensureWith:o.curry(Xr,Yr)},$r=function(t){var n=an.has(t,"colspan")?parseInt(an.get(t,"colspan"),10):1,e=an.has(t,"rowspan")?parseInt(an.get(t,"rowspan"),10):1;return{element:o.constant(t),colspan:o.constant(n),rowspan:o.constant(e)}},Jr=Kr.exactly(["cell","row","replace","gap"]),Qr=function(t,n){Jr(t);var e=Ur(s.none()),r=void 0!==n?n:$r,o=function(n){return function(n){return t.cell(n)}(r(n))},i=function(t){var n=o(t);return e.get().isNone()&&e.set(s.some(n)),u=s.some({item:t,replacement:n}),n},u=s.none();return{getOrInit:function(t,n){return u.fold(function(){return i(t)},function(e){return n(t,e.item)?e.replacement:i(t)})},cursor:e.get}},Zr=function(t,n){return function(e){var r=Ur(s.none());Jr(e);var o=[],i=function(i){var u=e.replace(i,n,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(s.some(u)),u};return{replaceOrInit:function(t,n){return function(t,n){return C.find(o,function(e){return n(e.item,t)})}(t,n).fold(function(){return i(t)},function(e){return n(t,e.item)?e.sub:i(t)})},cursor:r.get}}},to=function(t){Jr(t);var n=Ur(s.none());return{combine:function(e){return n.get().isNone()&&n.set(s.some(e)),function(){var n=t.cell({element:o.constant(e),colspan:o.constant(1),rowspan:o.constant(1)});return Mn.remove(n,"width"),Mn.remove(e,"width"),n}},cursor:n.get}},no=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],eo=function(t,n){var e=t.property().name(n);return C.contains(no,e)},ro=function(t,n){return C.contains(["br","img","hr","input"],t.property().name(n))},oo=eo,io=function(t,n){var e=t.property().name(n);return C.contains(["ol","ul"],e)},uo=ro,ao=ge(),co=function(t){return oo(ao,t)},lo=function(t){return io(ao,t)},so=function(t){return uo(ao,t)},fo=function(t){var n,e=function(t){return"br"===nn.name(t)},r=function(t){return ue.last(t).bind(function(n){var r,o=(r=n,Gt.nextSibling(r).map(function(t){return!!co(t)||(so(t)?"img"!==nn.name(t):void 0)}).getOr(!1));return Gt.parent(n).map(function(r){return!0===o||(i=r,"li"===nn.name(i)||bn.ancestor(i,lo).isSome())||e(n)||co(r)&&!qt.eq(t,r)?[]:[H.fromTag("br")];var i})}).getOr([])},o=0===(n=C.bind(t,function(t){var n=Gt.children(t);return function(t){return C.forall(t,function(t){return e(t)||nn.isText(t)&&0===te.get(t).trim().length})}(n)?[]:n.concat(r(t))})).length?[H.fromTag("br")]:n;_n.empty(t[0]),zn.append(t[0],o)},mo=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=t(r[u],i[u]))}return r}},go=mo(function(t,n){return E.isObject(t)&&E.isObject(n)?go(t,n):n}),po=mo(function(t,n){return n}),ho={deepMerge:go,merge:po},vo=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},bo=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return s.none()},wo=function(t,n){return j.rowcells(n,t.section())},yo=function(t,n){return t.cells()[n]},xo={addCell:function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return wo(t,u)},setCells:wo,mutateCell:function(t,n,e){t.cells()[n]=e},getCell:yo,getCellElement:function(t,n){return yo(t,n).element()},mapCells:function(t,n){var e=t.cells(),r=C.map(e,n);return j.rowcells(r,t.section())},cellLength:function(t){return t.cells().length}},So=function(t,n){if(0===t.length)return 0;var e=t[0];return C.findIndex(t,function(t){return!n(e.element(),t.element())}).fold(function(){return t.length},function(t){return t})},Co=function(t,n,e,r){var i=function(t,n){return t[n]}(t,n).cells().slice(e),u=So(i,r),a=function(t,n){return C.map(t,function(t){return xo.getCell(t,n)})}(t,e).slice(n),c=So(a,r);return{colspan:o.constant(u),rowspan:o.constant(c)}},Ro=function(t,n){var e=C.map(t,function(t,n){return C.map(t.cells(),function(t,n){return!1})});return C.map(t,function(r,o){var i=C.bind(r.cells(),function(r,i){if(!1===e[o][i]){var u=Co(t,o,i,n);return function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[j.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return j.rowdetails(i,r.section())})},To=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=Nn.getAt(t,o,u).map(function(t){return j.elementnew(t.element(),e)}).getOrThunk(function(){return j.elementnew(n.gap(),!0)});i.push(a)}var c=j.rowcells(i,t.all()[o].section());r.push(c)}return r},Do=function(t,n,e,r){e===r?an.remove(t,n):an.set(t,n,e)},Ao=function(t,n){var e=[],r=[],i=function(n,o){n.length>0?function(n,o){var i=yn.child(t,o).getOrThunk(function(){var n=H.fromTag(o,Gt.owner(t).dom());return Fn.append(t,n),n});_n.empty(i);var u=C.map(n,function(t){t.isNew()&&e.push(t.element());var n=t.element();return _n.empty(n),C.each(t.cells(),function(t){t.isNew()&&r.push(t.element()),Do(t.element(),"colspan",t.colspan(),1),Do(t.element(),"rowspan",t.rowspan(),1),Fn.append(n,t.element())}),n});zn.append(i,u)}(n,o):function(n){yn.child(t,n).bind(_n.remove)}(o)},u=[],a=[],c=[];return C.each(n,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":a.push(t);break;case"tfoot":c.push(t)}}),i(u,"thead"),i(a,"tbody"),i(c,"tfoot"),{newRows:o.constant(e),newCells:o.constant(r)}},ko=function(t){return C.map(t,function(t){var n=$n(t.element());return C.each(t.cells(),function(t){var e=Jn(t.element());Do(e,"colspan",t.colspan(),1),Do(e,"rowspan",t.rowspan(),1),Fn.append(n,e)}),n})},No=function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e},Oo=function(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e},Eo=function(t,n){if(n<0||n>=t.length-1)return s.none();var e=t[n].fold(function(){var e=C.reverse(t.slice(0,n));return bo(e,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return s.some({value:t,delta:0})}),r=t[n+1].fold(function(){var e=t.slice(n+1);return bo(e,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return s.some({value:t,delta:1})});return e.bind(function(t){return r.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},Bo=function(t,n,e){var r=t();return C.find(r,n).orThunk(function(){return s.from(r[0]).orThunk(e)}).map(function(t){return t.element()})},Po=function(t){var n=t.grid(),e=Oo(0,n.columns()),r=Oo(0,n.rows());return C.map(e,function(n){return Bo(function(){return C.bind(r,function(e){return Nn.getAt(t,e,n).filter(function(t){return t.column()===n}).fold(o.constant([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return Nn.getAt(t,0,n)})})},Io=function(t){var n=t.grid(),e=Oo(0,n.rows()),r=Oo(0,n.columns());return C.map(e,function(n){return Bo(function(){return C.bind(r,function(e){return Nn.getAt(t,n,e).filter(function(t){return t.row()===n}).fold(o.constant([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return Nn.getAt(t,n,0)})})},Wo=function(t,n,e,r,o){var i=H.fromTag("div");return Mn.setAll(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),an.setAll(i,{"data-column":t,role:"presentation"}),i},Mo=function(t,n,e,r,o){var i=H.fromTag("div");return Mn.setAll(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),an.setAll(i,{"data-row":t,role:"presentation"}),i},Lo=function(t){var n=t.replace(/\./g,"-");return{resolve:function(t){return n+"-"+t}}},qo={resolve:Lo("ephox-snooker").resolve},Fo=function(t,n){var e=an.get(t,n);return void 0===e||""===e?[]:e.split(" ")},zo=Fo,jo=function(t,n,e){var r=Fo(t,n).concat([e]);an.set(t,n,r.join(" "))},_o=function(t,n,e){var r=C.filter(Fo(t,n),function(t){return t!==e});r.length>0?an.set(t,n,r.join(" ")):an.remove(t,n)},Ho=function(t){return zo(t,"class")},Vo=function(t,n){return jo(t,"class",n)},Uo=function(t,n){return _o(t,"class",n)},Go=Ho,Xo=Vo,Yo=Uo,Ko=function(t,n){C.contains(Ho(t),n)?Uo(t,n):Vo(t,n)},$o=function(t){return void 0!==t.dom().classList},Jo=function(t,n){return $o(t)&&t.dom().classList.contains(n)},Qo={add:function(t,n){$o(t)?t.dom().classList.add(n):Xo(t,n)},remove:function(t,n){$o(t)?t.dom().classList.remove(n):Yo(t,n),function(t){0===($o(t)?t.dom().classList:Go(t)).length&&an.remove(t,"class")}(t)},toggle:function(t,n){return $o(t)?t.dom().classList.toggle(n):Ko(t,n)},toggler:function(t,n){var e=$o(t),r=t.dom().classList;return function(t,n,e){var r=e||!1,o=function(){n(),r=!0},i=function(){t(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}(function(){e?r.remove(n):Yo(t,n)},function(){e?r.add(n):Xo(t,n)},Jo(t,n))},has:Jo},Zo=qo.resolve("resizer-bar"),ti=qo.resolve("resizer-rows"),ni=qo.resolve("resizer-cols"),ei=function(t){var n=mn.descendants(t.parent(),"."+Zo);C.each(n,_n.remove)},ri=function(t,n,e){var r=t.origin();C.each(n,function(n,o){n.each(function(n){var o=e(r,n);Qo.add(o,Zo),Fn.append(t.parent(),o)})})},oi=function(t,n,e,r,o,i){var u=Or(n);!function(t,n,e,r){ri(t,n,function(t,n){var o=Mo(n.row(),e.left()-t.left(),n.y()-t.top(),r,7);return Qo.add(o,ti),o})}(t,e.length>0?o.positions(e,n):[],u,sr(n)),function(t,n,e,r){ri(t,n,function(t,n){var o=Wo(n.col(),n.x()-t.left(),e.top()-t.top(),7,r);return Qo.add(o,ni),o})}(t,r.length>0?i.positions(r,n):[],u,ar(n))},ii=function(t,n){var e=mn.descendants(t.parent(),"."+Zo);C.each(e,n)},ui={refresh:function(t,n,e,r){ei(t);var o=Tn(n),i=Nn.generate(o),u=Io(i),a=Po(i);oi(t,n,u,a,e,r)},hide:function(t){ii(t,function(t){Mn.set(t,"display","none")})},show:function(t){ii(t,function(t){Mn.set(t,"display","block")})},destroy:ei,isRowBar:function(t){return Qo.has(t,ti)},isColBar:function(t){return Qo.has(t,ni)}},ai=function(t,n){return C.map(t,function(t){var e=function(t){return bo(t,function(t){return Gt.parent(t.element()).map(function(t){var n=Gt.parent(t).isNone();return j.elementnew(t,n)})}).getOrThunk(function(){return j.elementnew(n.row(),!0)})}(t.details());return j.rowdatanew(e.element(),t.details(),t.section(),e.isNew())})},ci=function(t,n){var e=Ro(t,qt.eq);return ai(e,n)},li=function(t,n){var e=C.flatten(C.map(t.all(),function(t){return t.cells()}));return C.find(e,function(t){return qt.eq(n,t.element())})},si=function(t,n,e,r,i){return function(u,a,c,l,f){var d=Tn(a),m=Nn.generate(d);return n(m,c).map(function(n){var e=function(t,n){return To(t,n,!1)}(m,l),r=t(e,n,qt.eq,i(l)),u=ci(r.grid(),l);return{grid:o.constant(u),cursor:r.cursor}}).fold(function(){return s.none()},function(t){var n=Ao(a,t.grid());return e(a,t.grid(),f),r(a),ui.refresh(u,a,jr.height,f),s.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})})}},fi=ci,di=function(t,n){return Rn.cell(n.element()).bind(function(n){return li(t,n)})},mi=function(t,n){var e=C.map(n.selection(),function(n){return Rn.cell(n).bind(function(n){return li(t,n)})}),r=vo(e);return r.length>0?s.some(r):s.none()},gi=function(t,n){return Rn.cell(n.element()).bind(function(e){return li(t,e).map(function(t){return ho.merge(t,{generators:n.generators,clipboard:n.clipboard})})})},pi=function(t,n){var e=C.map(n.selection(),function(n){return Rn.cell(n).bind(function(n){return li(t,n)})}),r=vo(e);return r.length>0?s.some(ho.merge({cells:r},{generators:n.generators,clipboard:n.clipboard})):s.none()},hi=function(t,n){return n.mergable()},vi=function(t,n){return n.unmergable()},bi=function(t){return{is:function(n){return t===n},isValue:o.always,isError:o.never,getOr:o.constant(t),getOrThunk:o.constant(t),getOrDie:o.constant(t),or:function(n){return bi(t)},orThunk:function(n){return bi(t)},fold:function(n,e){return e(t)},map:function(n){return bi(n(t))},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return s.some(t)}}},wi=function(t){return{is:o.never,isValue:o.never,isError:o.always,getOr:o.identity,getOrThunk:function(t){return t()},getOrDie:function(){return o.die(t)()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return wi(t)},each:o.noop,bind:function(n){return wi(t)},exists:o.never,forall:o.always,toOption:s.none}},yi={value:bi,error:wi},xi=function(t,n){return C.map(t,function(){return j.elementnew(n.cell(),!0)})},Si=function(t,n,e){return t.concat(No(n,function(n){return xo.setCells(t[t.length-1],xi(t[t.length-1].cells(),e))}))},Ci=function(t,n,e){return C.map(t,function(t){return xo.setCells(t,t.cells().concat(xi(Oo(0,n),e)))})},Ri=function(t,n,e){if(t.row()>=n.length||t.column()>xo.cellLength(n[0]))return yi.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),i=r[0].cells().slice(t.column()),u=xo.cellLength(e[0]),a=e.length;return yi.value({rowDelta:o.constant(r.length-a),colDelta:o.constant(i.length-u)})},Ti=function(t,n){var e=xo.cellLength(t[0]),r=xo.cellLength(n[0]);return{rowDelta:o.constant(0),colDelta:o.constant(e-r)}},Di=function(t,n,e){var r=n.colDelta()<0?Ci:o.identity;return(n.rowDelta()<0?Si:o.identity)(r(t,Math.abs(n.colDelta()),e),Math.abs(n.rowDelta()),e)},Ai=function(t,n,e,r){if(0===t.length)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)xo.mutateCell(t[o],i,j.elementnew(r(),!1));return t},ki=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<xo.cellLength(t[0]);u++){var a=e(xo.getCellElement(t[i],u),n);!0===a&&!1===o?xo.mutateCell(t[i],u,j.elementnew(r(),!0)):!0===a&&(o=!1)}return t},Ni=function(t,n,e,r){if(n>0&&n<t.length){var o=function(t,n){return C.foldl(t,function(t,e){return C.exists(t,function(t){return n(t.element(),e.element())})?t:t.concat([e])},[])}(t[n-1].cells(),e);C.each(o,function(o){for(var i=s.none(),u=n;u<t.length;u++)for(var a=0;a<xo.cellLength(t[0]);a++){var c=t[u].cells()[a];e(c.element(),o.element())&&(i.isNone()&&(i=s.some(r())),i.each(function(n){xo.mutateCell(t[u],a,j.elementnew(n,!0))}))}})}return t},Oi=function(t,n,e,r){var i=xo.getCell(t[n],e),u=o.curry(r,i.element()),a=t[n];return t.length>1&&xo.cellLength(a)>1&&(e>0&&u(xo.getCellElement(a,e-1))||e<a.length-1&&u(xo.getCellElement(a,e+1))||n>0&&u(xo.getCellElement(t[n-1],e))||n<t.length-1&&u(xo.getCellElement(t[n+1],e)))},Ei=function(t,n,e,r,o){return Ri(t,n,e).map(function(i){var u=Di(n,i,r);return function(t,n,e,r,o){for(var i=t.row(),u=t.column(),a=i+e.length,c=u+xo.cellLength(e[0]),l=i;l<a;l++)for(var s=u;s<c;s++){Oi(n,l,s,o)&&ki(n,xo.getCellElement(n[l],s),o,r.cell);var f=xo.getCellElement(e[l-i],s-u),d=r.replace(f);xo.mutateCell(n[l],s,j.elementnew(d,!0))}return n}(t,u,e,r,o)})},Bi=function(t,n,e,r,o){Ni(n,t,o,r.cell);var i=Ti(e,n),u=Di(e,i,r),a=Ti(n,u),c=Di(n,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Pi=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),a=xo.mapCells(t[e],function(e,i){return n>0&&n<t.length&&r(xo.getCellElement(t[n-1],i),xo.getCellElement(t[n],i))?xo.getCell(t[n],i):j.elementnew(o(e.element(),r),!0)});return i.concat([a]).concat(u)},Ii=function(t,n,e,r,o){return C.map(t,function(t){var i=n>0&&n<xo.cellLength(t)&&r(xo.getCellElement(t,n-1),xo.getCellElement(t,n))?xo.getCell(t,n):j.elementnew(o(xo.getCellElement(t,e),r),!0);return xo.addCell(t,n,i)})},Wi=function(t,n,e,r,o){var i=e+1;return C.map(t,function(t,u){var a=u===n?j.elementnew(o(xo.getCellElement(t,e),r),!0):xo.getCell(t,e);return xo.addCell(t,i,a)})},Mi=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),a=t.slice(i),c=xo.mapCells(t[n],function(t,n){return n===e?j.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},Li=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))},qi=function(t,n,e){var r=C.map(t,function(t){var r=t.cells().slice(0,n).concat(t.cells().slice(e+1));return j.rowcells(r,t.section())});return C.filter(r,function(t){return t.cells().length>0})},Fi=function(t,n,e,r){return C.map(t,function(t){return xo.mapCells(t,function(t){return function(t){return C.exists(n,function(n){return e(t.element(),n.element())})}(t)?j.elementnew(r(t.element(),e),!0):t})})},zi=function(t,n,e,r){return void 0!==xo.getCellElement(t[n],e)&&n>0&&r(xo.getCellElement(t[n-1],e),xo.getCellElement(t[n],e))},ji=function(t,n,e){return n>0&&e(xo.getCellElement(t,n-1),xo.getCellElement(t,n))},_i=function(t,n,e,r){var o=C.bind(t,function(r,o){return zi(t,o,n,e)||ji(r,n,e)?[]:[xo.getCell(r,n)]});return Fi(t,o,e,r)},Hi=function(t,n,e,r){var o=t[n],i=C.bind(o.cells(),function(r,i){return zi(t,n,i,e)||ji(o,i,e)?[]:[r]});return Fi(t,i,e,r)},Vi=function(t){return{fold:t}},Ui=function(){return Vi(function(t,n,e,r,o){return t()})},Gi=function(t){return Vi(function(n,e,r,o,i){return e(t)})},Xi=function(t,n){return Vi(function(e,r,o,i,u){return o(t,n)})},Yi=function(t,n,e){return Vi(function(r,o,i,u,a){return u(t,n,e)})},Ki=function(t,n){return Vi(function(e,r,o,i,u){return u(t,n)})},$i=function(t,n,e,r){var i=t.slice(0),u=function(t,n){return 0===t.length?Ui():1===t.length?Gi(0):0===n?Xi(0,1):n===t.length-1?Ki(n-1,n):n>0&&n<t.length-1?Yi(n-1,n,n+1):Ui()}(t,n),a=function(t){return C.map(t,o.constant(0))},c=o.constant(a(i)),l=function(t,n){if(e>=0){var o=Math.max(r.minCellWidth(),i[n]-e);return a(i.slice(0,t)).concat([e,o-i[n]]).concat(a(i.slice(n+1)))}var u=Math.max(r.minCellWidth(),i[t]+e),c=i[t]-u;return a(i.slice(0,t)).concat([u-i[t],c]).concat(a(i.slice(n+1)))},s=l;return u.fold(c,function(t){return r.singleColumnWidth(i[t],e)},s,function(t,n,e){return l(n,e)},function(t,n){if(e>=0)return a(i.slice(0,n)).concat([e]);var o=Math.max(r.minCellWidth(),i[n]+e);return a(i.slice(0,n)).concat([o-i[n]])})},Ji=function(t,n){return an.has(t,n)&&parseInt(an.get(t,n),10)>1},Qi={hasColspan:function(t){return Ji(t,"colspan")},hasRowspan:function(t){return Ji(t,"rowspan")},minWidth:o.constant(10),minHeight:o.constant(10),getInt:function(t,n){return parseInt(Mn.get(t,n),10)}},Zi=function(t,n,e){return Mn.getRaw(t,n).fold(function(){return e(t)+"px"},function(t){return t})},tu=function(t){return Zi(t,"width",Cr.getPixelWidth)},nu=function(t){return Zi(t,"height",Cr.getHeight)},eu=function(t,n,e,r,i){var u=Po(t),a=C.map(u,function(t){return t.map(n.edge)});return C.map(u,function(t,n){return t.filter(o.not(Qi.hasColspan)).fold(function(){var t=Eo(a,n);return r(t)},function(t){return e(t,i)})})},ru=function(t){return t.map(function(t){return t+"px"}).getOr("")},ou=function(t,n,e,r){var i=Io(t),u=C.map(i,function(t){return t.map(n.edge)});return C.map(i,function(t,n){return t.filter(o.not(Qi.hasRowspan)).fold(function(){var t=Eo(u,n);return r(t)},function(t){return e(t)})})},iu={getRawWidths:function(t,n){return eu(t,n,tu,ru)},getPixelWidths:function(t,n,e){return eu(t,n,Cr.getPixelWidth,function(t){return t.getOrThunk(e.minCellWidth)},e)},getPercentageWidths:function(t,n,e){return eu(t,n,Cr.getPercentageWidth,function(t){return t.fold(function(){return e.minCellWidth()},function(t){return t/e.pixelWidth()*100})},e)},getPixelHeights:function(t,n){return ou(t,n,Cr.getHeight,function(t){return t.getOrThunk(Qi.minHeight)})},getRawHeights:function(t,n){return ou(t,n,nu,ru)}},uu=function(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r},au=function(t,n){var e=Nn.justCells(t);return C.map(e,function(t){var e=uu(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:o.constant(e),colspan:t.colspan}})},cu=function(t,n){var e=Nn.justCells(t);return C.map(e,function(t){var e=uu(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:o.constant(e),rowspan:t.rowspan}})},lu=function(t,n){return C.map(t.all(),function(t,e){return{element:t.element,height:o.constant(n[e])}})},su=function(t){var n=parseInt(t,10),e=o.identity;return{width:o.constant(n),pixelWidth:o.constant(n),getWidths:iu.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,n){return[Math.max(Qi.minWidth(),t+n)-t]},minCellWidth:Qi.minWidth,setElementWidth:Cr.setPixelWidth,setTableWidth:function(t,n,e){var r=C.foldr(n,function(t,n){return t+n},0);Cr.setPixelWidth(t,r)}}},fu=function(t,n){if(Cr.percentageBasedSizeRegex().test(n))return function(t,n){var e=parseFloat(t),r=lr(n);return{width:o.constant(e),pixelWidth:o.constant(r),getWidths:iu.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,n){return[100-t]},minCellWidth:function(){return Qi.minWidth()/r*100},setElementWidth:Cr.setPercentageWidth,setTableWidth:function(t,n,r){var o=e+r;Cr.setPercentageWidth(t,o)}}}(Cr.percentageBasedSizeRegex().exec(n)[1],t);if(Cr.pixelBasedSizeRegex().test(n)){var e=Cr.pixelBasedSizeRegex().exec(n);return su(e[1])}var r=lr(t);return su(r)},du=function(t){return Cr.getRawWidth(t).fold(function(){var n=lr(t);return su(n)},function(n){return fu(t,n)})},mu=function(t){return Nn.generate(t)},gu=function(t){var n=Tn(t);return mu(n)},pu={adjustWidth:function(t,n,e,r){var o=du(t),i=o.getCellDelta(n),u=gu(t),a=o.getWidths(u,r,o),c=$i(a,e,i,o),l=C.map(c,function(t,n){return t+a[n]}),s=au(u,l);C.each(s,function(t){o.setElementWidth(t.element(),t.width())}),e===u.grid().columns()-1&&o.setTableWidth(t,l,i)},adjustHeight:function(t,n,e,r){var o=gu(t),i=iu.getPixelHeights(o,r),u=C.map(i,function(t,r){return e===r?Math.max(n+t,Qi.minHeight()):t}),a=cu(o,u),c=lu(o,u);C.each(c,function(t){Cr.setHeight(t.element(),t.height())}),C.each(a,function(t){Cr.setHeight(t.element(),t.height())});var l,s=(l=u,C.foldr(l,function(t,n){return t+n},0));Cr.setHeight(t,s)},adjustWidthTo:function(t,n,e){var r=du(t),o=mu(n),i=r.getWidths(o,e,r),u=au(o,i);C.each(u,function(t){r.setElementWidth(t.element(),t.width())});var a=C.foldr(i,function(t,n){return n+t},0);u.length>0&&r.setElementWidth(t,a)}},hu=function(t){0===Rn.cells(t).length&&_n.remove(t)},vu=I.immutable("grid","cursor"),bu=function(t,n,e){return wu(t,n,e).orThunk(function(){return wu(t,0,0)})},wu=function(t,n,e){return s.from(t[n]).bind(function(t){return s.from(t.cells()[e]).bind(function(t){return s.from(t.element())})})},yu=function(t,n,e){return vu(t,wu(t,n,e))},xu=function(t){return C.foldl(t,function(t,n){return C.exists(t,function(t){return t.row()===n.row()})?t:t.concat([n])},[]).sort(function(t,n){return t.row()-n.row()})},Su=function(t){return C.foldl(t,function(t,n){return C.exists(t,function(t){return t.column()===n.column()})?t:t.concat([n])},[]).sort(function(t,n){return t.column()-n.column()})},Cu=function(t,n,e){var r=Dn(t,e),o=Nn.generate(r);return To(o,n,!0)},Ru=pu.adjustWidthTo,Tu={insertRowBefore:si(function(t,n,e,r){var o=n.row(),i=n.row(),u=Pi(t,i,o,e,r.getOrInit);return yu(u,i,n.column())},di,o.noop,o.noop,Qr),insertRowsBefore:si(function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=xu(n),a=C.foldl(u,function(t,n){return Pi(t,i,o,e,r.getOrInit)},t);return yu(a,i,n[0].column())},mi,o.noop,o.noop,Qr),insertRowAfter:si(function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan(),u=Pi(t,i,o,e,r.getOrInit);return yu(u,i,n.column())},di,o.noop,o.noop,Qr),insertRowsAfter:si(function(t,n,e,r){var o=xu(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=C.foldl(o,function(t,n){return Pi(t,u,i,e,r.getOrInit)},t);return yu(a,u,n[0].column())},mi,o.noop,o.noop,Qr),insertColumnBefore:si(function(t,n,e,r){var o=n.column(),i=n.column(),u=Ii(t,i,o,e,r.getOrInit);return yu(u,n.row(),i)},di,Ru,o.noop,Qr),insertColumnsBefore:si(function(t,n,e,r){var o=Su(n),i=o[0].column(),u=o[0].column(),a=C.foldl(o,function(t,n){return Ii(t,u,i,e,r.getOrInit)},t);return yu(a,n[0].row(),u)},mi,Ru,o.noop,Qr),insertColumnAfter:si(function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan(),u=Ii(t,i,o,e,r.getOrInit);return yu(u,n.row(),i)},di,Ru,o.noop,Qr),insertColumnsAfter:si(function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=Su(n),a=C.foldl(u,function(t,n){return Ii(t,i,o,e,r.getOrInit)},t);return yu(a,n[0].row(),i)},mi,Ru,o.noop,Qr),splitCellIntoColumns:si(function(t,n,e,r){var o=Wi(t,n.row(),n.column(),e,r.getOrInit);return yu(o,n.row(),n.column())},di,Ru,o.noop,Qr),splitCellIntoRows:si(function(t,n,e,r){var o=Mi(t,n.row(),n.column(),e,r.getOrInit);return yu(o,n.row(),n.column())},di,o.noop,o.noop,Qr),eraseColumns:si(function(t,n,e,r){var o=Su(n),i=qi(t,o[0].column(),o[o.length-1].column()),u=bu(i,n[0].row(),n[0].column());return vu(i,u)},mi,Ru,hu,Qr),eraseRows:si(function(t,n,e,r){var o=xu(n),i=Li(t,o[0].row(),o[o.length-1].row()),u=bu(i,n[0].row(),n[0].column());return vu(i,u)},mi,o.noop,hu,Qr),makeColumnHeader:si(function(t,n,e,r){var o=_i(t,n.column(),e,r.replaceOrInit);return yu(o,n.row(),n.column())},di,o.noop,o.noop,Zr("row","th")),unmakeColumnHeader:si(function(t,n,e,r){var o=_i(t,n.column(),e,r.replaceOrInit);return yu(o,n.row(),n.column())},di,o.noop,o.noop,Zr(null,"td")),makeRowHeader:si(function(t,n,e,r){var o=Hi(t,n.row(),e,r.replaceOrInit);return yu(o,n.row(),n.column())},di,o.noop,o.noop,Zr("col","th")),unmakeRowHeader:si(function(t,n,e,r){var o=Hi(t,n.row(),e,r.replaceOrInit);return yu(o,n.row(),n.column())},di,o.noop,o.noop,Zr(null,"td")),mergeCells:si(function(t,n,e,r){var i=n.cells();fo(i);var u=Ai(t,n.bounds(),e,o.constant(i[0]));return vu(u,s.from(i[0]))},hi,o.noop,o.noop,to),unmergeCells:si(function(t,n,e,r){var o=C.foldr(n,function(t,n){return ki(t,n,e,r.combine(n))},t);return vu(o,s.from(n[0]))},vi,Ru,o.noop,to),pasteCells:si(function(t,n,e,r){var o,i,u,a,c=(o=n.clipboard(),i=n.generators(),u=Tn(o),a=Nn.generate(u),To(a,i,!0)),l=j.address(n.row(),n.column());return Ei(l,t,c,n.generators(),e).fold(function(){return vu(t,s.some(n.element()))},function(t){var e=bu(t,n.row(),n.column());return vu(t,e)})},gi,Ru,o.noop,Qr),pasteRowsBefore:si(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Cu(n.clipboard(),n.generators(),o),a=Bi(i,t,u,n.generators(),e),c=bu(a,n.cells[0].row(),n.cells[0].column());return vu(a,c)},pi,o.noop,o.noop,Qr),pasteRowsAfter:si(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Cu(n.clipboard(),n.generators(),o),a=Bi(i,t,u,n.generators(),e),c=bu(a,n.cells[0].row(),n.cells[0].column());return vu(a,c)},pi,o.noop,o.noop,Qr)},Du=function(t){return H.fromDom(t.getBody())},Au={getBody:Du,getIsRoot:function(t){return function(n){return qt.eq(n,Du(t))}},addSizeSuffix:function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},removePxSuffix:function(t){return t?t.replace(/px$/,""):""}},ku=function(t){return"rtl"===Mn.get(t,"direction")?"rtl":"ltr"},Nu={onDirection:function(t,n){return function(e){return"rtl"===ku(e)?n:t}},getDirection:ku},Ou={isRtl:o.constant(!1)},Eu={isRtl:o.constant(!0)},Bu={directionAt:function(t){return"rtl"===Nu.getDirection(t)?Eu:Ou}},Pu=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],Iu={"border-collapse":"collapse",width:"100%"},Wu={border:"1"},Mu=function(t){return t.getParam("table_default_styles",Iu,"object")},Lu=function(t){return t.getParam("table_resize_bars",!0,"boolean")},qu=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Fu=function(t){return t.getParam("forced_root_block","p","string")},zu=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},ju=function(t){return t.getParam("table_row_advtab",!0,"boolean")},_u=function(t){return t.getParam("table_advtab",!0,"boolean")},Hu=function(t){return t.getParam("table_style_by_css",!1,"boolean")},Vu=function(t){return t.getParam("forced_block_attrs",{},"object")},Uu=function(t){return t.getParam("table_cell_class_list",[],"array")},Gu=function(t){return t.getParam("table_row_class_list",[],"array")},Xu=function(t){return t.getParam("table_class_list",[],"array")},Yu=function(t){return!1===t.getParam("table_responsive_width")},Ku=function(t){var n=t.getParam("table_clone_elements");return E.isString(n)?s.some(n.split(/[ ,]/)):Array.isArray(n)?s.some(n):s.none()},$u=function(t){var n=t.getParam("object_resizing",!0);return"table"===n||n},Ju=function(t,n){return t.fire("newrow",{node:n})},Qu=function(t,n){return t.fire("newcell",{node:n})},Zu=function(t,n,e){var r=Tn(t),o=Nn.generate(r);return mi(o,n).map(function(t){var n=To(o,e,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=fi(n,e);return ko(r)})},ta=tinymce.util.Tools.resolve("tinymce.util.Tools"),na={applyAlign:function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},applyVAlign:function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},unApplyAlign:function(t,n){ta.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},unApplyVAlign:function(t,n){ta.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},n)})},getTDTHOverallStyle:function(t,n,e){var r;return r=function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if(void 0===n&&(n=i),n!==i)return""}return n}(r,t.select("td,th",n))}},ea=function(t,n){var e=t.dom,r=n.control.rootControl,o=r.toJSON(),i=e.parseStyle(o.style);"style"===n.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Au.addSizeSuffix(o.width):"",i.height=o.height?Au.addSizeSuffix(o.height):""),r.find("#style").value(e.serializeStyle(e.parseStyle(e.serializeStyle(i))))},ra={createStyleForm:function(t){var n=function(){var n=function(t){return t.getParam("color_picker_callback")}(t);if(n)return function(e){return n.call(t,function(t){e.control.value(t).fire("change")},e.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:o.curry(ea,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:o.curry(ea,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:n()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:n()}]}]}},buildListItems:function(t,n,e){var r=function(t,e){return e=e||[],ta.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)}),e};return r(t,e||[])},updateStyleField:ea,extractAdvancedStyles:function(t,n){var e=t.parseStyle(t.getAttrib(n,"style")),r={};return e["border-style"]&&(r.borderStyle=e["border-style"]),e["border-color"]&&(r.borderColor=e["border-color"]),e["background-color"]&&(r.backgroundColor=e["background-color"]),r.style=t.serializeStyle(e),r}},oa=function(t,n,e){var r,o=t.dom;function i(t,n,e){e&&o.setAttrib(t,n,e)}function u(t,n,e){e&&o.setStyle(t,n,e)}ra.updateStyleField(t,e),r=e.control.rootControl.toJSON(),t.undoManager.transact(function(){ta.each(n,function(e){var a,c;i(e,"scope",r.scope),1===n.length?i(e,"style",r.style):(a=e,c=r.style,a.style.cssText+=";"+c),i(e,"class",r.class),u(e,"width",Au.addSizeSuffix(r.width)),u(e,"height",Au.addSizeSuffix(r.height)),r.type&&e.nodeName.toLowerCase()!==r.type&&(e=o.rename(e,r.type)),1===n.length&&(na.unApplyAlign(t,e),na.unApplyVAlign(t,e)),r.align&&na.applyAlign(t,e,r.align),r.valign&&na.applyVAlign(t,e,r.valign)}),t.focus()})},ia=function(t){var n,e,r,i=[];if(i=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!i.length&&n&&i.push(n),n=n||i[0]){e=i.length>1?{width:"",height:"",scope:"",class:"",align:"",style:"",type:n.nodeName.toLowerCase()}:function(t,n){var e=t.dom,r={width:e.getStyle(n,"width")||e.getAttrib(n,"width"),height:e.getStyle(n,"height")||e.getAttrib(n,"height"),scope:e.getAttrib(n,"scope"),class:e.getAttrib(n,"class")};return r.type=n.nodeName.toLowerCase(),ta.each("left center right".split(" "),function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)}),ta.each("top middle bottom".split(" "),function(e){t.formatter.matchNode(n,"valign"+e)&&(r.valign=e)}),zu(t)&&ta.extend(r,ra.extractAdvancedStyles(e,n)),r}(t,n),Uu(t).length>0&&(r={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(Uu(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[n.value]})})})});var u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:o.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:o.curry(ra.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};zu(t)?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:e,body:[{title:"General",type:"form",items:u},ra.createStyleForm(t)],onsubmit:o.curry(oa,t,i)}):t.windowManager.open({title:"Cell properties",data:e,body:u,onsubmit:o.curry(oa,t,i)})}},ua=function(t,n,e){var r=t.getParent(n,"table"),o=n.parentNode,i=t.select(e,r)[0];i||(i=t.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(n),o.hasChildNodes()||t.remove(o)};function aa(t,n,e){var r,o=t.dom;function i(t,n,e){e&&o.setAttrib(t,n,e)}ra.updateStyleField(t,e),r=e.control.rootControl.toJSON(),t.undoManager.transact(function(){ta.each(n,function(e){var u,a,c;i(e,"scope",r.scope),i(e,"style",r.style),i(e,"class",r.class),u=e,a="height",(c=Au.addSizeSuffix(r.height))&&o.setStyle(u,a,c),r.type!==e.parentNode.nodeName.toLowerCase()&&ua(t.dom,e,r.type),1===n.length&&na.unApplyAlign(t,e),r.align&&na.applyAlign(t,e,r.align)}),t.focus()})}var ca=function(t){var n,e,r,i,u,a,c=t.dom,l=[];n=c.getParent(t.selection.getStart(),"table"),e=c.getParent(t.selection.getStart(),"td,th"),ta.each(n.rows,function(t){ta.each(t.cells,function(n){if(c.getAttrib(n,"data-mce-selected")||n===e)return l.push(t),!1})}),(r=l[0])&&(u=l.length>1?{height:"",scope:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(t,n){var e=t.dom,r={height:e.getStyle(n,"height")||e.getAttrib(n,"height"),scope:e.getAttrib(n,"scope"),class:e.getAttrib(n,"class")};return r.type=n.parentNode.nodeName.toLowerCase(),ta.each("left center right".split(" "),function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)}),ju(t)&&ta.extend(r,ra.extractAdvancedStyles(e,n)),r}(t,r),Gu(t).length>0&&(i={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(Gu(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})})}),a={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},i]},ju(t)?t.windowManager.open({title:"Row properties",data:u,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},ra.createStyleForm(t)],onsubmit:o.curry(aa,t,l)}):t.windowManager.open({title:"Row properties",data:u,body:a,onsubmit:o.curry(aa,t,l)}))},la=tinymce.util.Tools.resolve("tinymce.Env"),sa={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},fa=function(t,n,e,r,o){void 0===o&&(o=sa);var i=H.fromTag("table");Mn.setAll(i,o.styles),an.setAll(i,o.attributes);var u=H.fromTag("tbody");Fn.append(i,u);for(var a=[],c=0;c<t;c++){for(var l=H.fromTag("tr"),s=0;s<n;s++){var f=c<e||s<r?H.fromTag("th"):H.fromTag("td");s<r&&an.set(f,"scope","row"),c<e&&an.set(f,"scope","col"),Fn.append(f,H.fromTag("br")),o.percentages&&Mn.set(f,"width",100/n+"%"),Fn.append(l,f)}a.push(l)}return zn.append(u,a),i},da=function(t){return t.dom().innerHTML},ma=function(t){var n=H.fromTag("div"),e=H.fromDom(t.dom().cloneNode(!0));return Fn.append(n,e),da(n)},ga=function(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)},pa=function(t,n,e){var r,i=Mu(t),u={styles:i,attributes:function(t){return t.getParam("table_default_attributes",Wu,"object")}(t),percentages:(r=i.width,E.isString(r)&&-1!==r.indexOf("%")&&!Yu(t))},a=fa(e,n,0,0,u);an.set(a,"data-mce-id","__mce");var c=ma(a);return t.insertContent(c),yn.descendant(Au.getBody(t),'table[data-mce-id="__mce"]').map(function(n){return Yu(t)&&Mn.set(n,"width",Mn.get(n,"width")),an.remove(n,"data-mce-id"),function(t,n){C.each(mn.descendants(n,"tr"),function(n){Ju(t,n.dom()),C.each(mn.descendants(n,"th,td"),function(n){Qu(t,n.dom())})})}(t,n),function(t,n){yn.descendant(n,"td,th").each(o.curry(ga,t))}(t,n),n.dom()}).getOr(null)};function ha(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)t.setStyle(n,e,r);else if(n.children)for(var o=0;o<n.children.length;o++)ha(t,n.children[o],e,r)}var va=function(t,n,e){var r,o,i=t.dom;ra.updateStyleField(t,e),!1===(o=e.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact(function(){n||(n=pa(t,o.cols||1,o.rows||1)),function(t,n,e){var r=t.dom,o={},i={};if(o.class=e.class,i.height=Au.addSizeSuffix(e.height),r.getAttrib(n,"width")&&!Hu(t)?o.width=Au.removePxSuffix(e.width):i.width=Au.addSizeSuffix(e.width),Hu(t)?(i["border-width"]=Au.addSizeSuffix(e.border),i["border-spacing"]=Au.addSizeSuffix(e.cellspacing),ta.extend(o,{"data-mce-border-color":e.borderColor,"data-mce-cell-padding":e.cellpadding,"data-mce-border":e.border})):ta.extend(o,{border:e.border,cellpadding:e.cellpadding,cellspacing:e.cellspacing}),Hu(t)&&n.children)for(var u=0;u<n.children.length;u++)ha(r,n.children[u],{"border-width":Au.addSizeSuffix(e.border),"border-color":e.borderColor,padding:Au.addSizeSuffix(e.cellpadding)});e.style?ta.extend(i,r.parseStyle(e.style)):i=ta.extend({},r.parseStyle(r.getAttrib(n,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(n,o)}(t,n,o),(r=i.select("caption",n)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=la.ie?" ":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),na.unApplyAlign(t,n),o.align&&na.applyAlign(t,n,o.align),t.focus(),t.addVisual()})},ba=function(t,n){var e,r,i,u,a,c=t.dom,l={};!0===n?(e=c.getParent(t.selection.getStart(),"table"))&&(l=function(t,n){var e=t.dom,r={width:e.getStyle(n,"width")||e.getAttrib(n,"width"),height:e.getStyle(n,"height")||e.getAttrib(n,"height"),cellspacing:e.getStyle(n,"border-spacing")||e.getAttrib(n,"cellspacing"),cellpadding:e.getAttrib(n,"data-mce-cell-padding")||e.getAttrib(n,"cellpadding")||na.getTDTHOverallStyle(t.dom,n,"padding"),border:e.getAttrib(n,"data-mce-border")||e.getAttrib(n,"border")||na.getTDTHOverallStyle(t.dom,n,"border"),borderColor:e.getAttrib(n,"data-mce-border-color"),caption:!!e.select("caption",n)[0],class:e.getAttrib(n,"class")};return ta.each("left center right".split(" "),function(e){t.formatter.matchNode(n,"align"+e)&&(r.align=e)}),_u(t)&&ta.extend(r,ra.extractAdvancedStyles(e,n)),r}(t,e)):(r={label:"Cols",name:"cols"},i={label:"Rows",name:"rows"}),Xu(t).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),u={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(Xu(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})})}),a={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:function(t){return t.getParam("table_appearance_options",!0,"boolean")}(t)?[r,i,{label:"Width",name:"width",onchange:o.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:o.curry(ra.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,i,{label:"Width",name:"width",onchange:o.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:o.curry(ra.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},u]},_u(t)?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},ra.createStyleForm(t)],onsubmit:o.curry(va,t,e)}):t.windowManager.open({title:"Table properties",data:l,body:a,onsubmit:o.curry(va,t,e)})},wa=ta.each,ya={registerCommands:function(t,n,e,r,i){var u=Au.getIsRoot(t),a=function(){return H.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},c=function(t){return Rn.table(t,u)},l=function(n){var o=a();c(o).each(function(i){var u=er.forMenu(r,i,o);n(i,u).each(function(n){t.selection.setRng(n),t.focus(),e.clear(i)})})},f=function(n){var e=a();return c(e).bind(function(n){var i=H.fromDom(t.getDoc()),u=er.forMenu(r,n,e),a=fe.cellOperations(o.noop,i,s.none());return Zu(n,u,a)})},d=function(n){i.get().each(function(o){var i=C.map(o,function(t){return Jn(t)}),u=a();c(u).bind(function(o){var a=H.fromDom(t.getDoc()),c=fe.paste(a),l=er.pasteRows(r,o,u,i,c);n(o,l).each(function(n){t.selection.setRng(n),t.focus(),e.clear(o)})})})};wa({mceTableSplitCells:function(){l(n.unmergeCells)},mceTableMergeCells:function(){l(n.mergeCells)},mceTableInsertRowBefore:function(){l(n.insertRowsBefore)},mceTableInsertRowAfter:function(){l(n.insertRowsAfter)},mceTableInsertColBefore:function(){l(n.insertColumnsBefore)},mceTableInsertColAfter:function(){l(n.insertColumnsAfter)},mceTableDeleteCol:function(){l(n.deleteColumn)},mceTableDeleteRow:function(){l(n.deleteRow)},mceTableCutRow:function(t){i.set(f()),l(n.deleteRow)},mceTableCopyRow:function(t){i.set(f())},mceTablePasteRowBefore:function(t){d(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){d(n.pasteRowsAfter)},mceTableDelete:function(){var n=H.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));Rn.table(n,u).filter(o.not(u)).each(function(n){var e=H.fromText("");Fn.after(n,e),_n.remove(n);var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r)})}},function(n,e){t.addCommand(e,n)}),wa({mceInsertTable:o.curry(ba,t),mceTableProps:o.curry(ba,t,!0),mceTableRowProps:o.curry(ca,t),mceTableCellProps:o.curry(ia,t)},function(n,e){t.addCommand(e,function(t,e){n(e)})})}},xa={only:function(t){var n=s.from(t.dom().documentElement).map(H.fromDom).getOr(t);return{parent:o.constant(n),view:o.constant(t),origin:o.constant(Ar(0,0))}},detached:function(t,n){var e=o.curry(Or,n);return{parent:o.constant(n),view:o.constant(t),origin:e}},body:function(t,n){return{parent:o.constant(n),view:o.constant(t),origin:o.constant(Ar(0,0))}}};function Sa(t){var n=I.immutable.apply(null,t),e=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";e.push(t)},unbind:function(t){e=C.filter(e,function(n){return n!==t})},trigger:function(){var t=n.apply(null,arguments);C.each(e,function(n){n(t)})}}}var Ca={create:function(t){return{registry:N.map(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:N.map(t,function(t){return t.trigger})}}},Ra={mode:Kr.exactly(["compare","extract","mutate","sink"]),sink:Kr.exactly(["element","start","stop","destroy"]),api:Kr.exactly(["forceDrop","drop","move","delayDrop"])},Ta={resolve:Lo("ephox-dragster").resolve},Da=function(t,n){return function(e){if(t(e)){var r=H.fromDom(e.target),i=function(){e.stopPropagation()},u=function(){e.preventDefault()},a=o.compose(u,i),c=function(t,n,e,r,i,u,a){return{target:o.constant(t),x:o.constant(n),y:o.constant(e),stop:r,prevent:i,kill:u,raw:o.constant(a)}}(r,e.clientX,e.clientY,i,u,a,e);n(c)}}},Aa=function(t,n,e,r,i){var u=Da(e,r);return t.dom().addEventListener(n,u,i),{unbind:o.curry(ka,t,n,u,i)}},ka=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},Na=function(t,n,e,r){return Aa(t,n,e,r,!1)},Oa=function(t,n,e,r){return Aa(t,n,e,r,!0)},Ea=o.constant(!0),Ba={bind:function(t,n,e){return Na(t,n,Ea,e)},capture:function(t,n,e){return Oa(t,n,Ea,e)}},Pa=Ra.mode({compare:function(t,n){return Ar(n.left()-t.left(),n.top()-t.top())},extract:function(t){return s.some(Ar(t.x(),t.y()))},sink:function(t,n){var e=function(t){var n=ho.merge({layerClass:Ta.resolve("blocker")},t),e=H.fromTag("div");return an.set(e,"role","presentation"),Mn.setAll(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Qo.add(e,Ta.resolve("blocker")),Qo.add(e,n.layerClass),{element:function(){return e},destroy:function(){_n.remove(e)}}}(n),r=Ba.bind(e.element(),"mousedown",t.forceDrop),o=Ba.bind(e.element(),"mouseup",t.drop),i=Ba.bind(e.element(),"mousemove",t.move),u=Ba.bind(e.element(),"mouseout",t.delayDrop);return Ra.sink({element:e.element,start:function(t){Fn.append(t,e.element())},stop:function(){_n.remove(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function Ia(){var t=s.none(),n=Ca.create({move:Sa(["info"])});return{onEvent:function(e,r){r.extract(e).each(function(e){(function(n,e){var r=t.map(function(t){return n.compare(t,e)});return t=s.some(e),r})(r,e).each(function(t){n.trigger.move(t)})})},reset:function(){t=s.none()},events:n.registry}}function Wa(){var t={onEvent:function(t,n){},reset:o.noop},n=Ia(),e=t;return{on:function(){e.reset(),e=n},off:function(){e.reset(),e=t},isOn:function(){return e===n},onEvent:function(t,n){e.onEvent(t,n)},events:n.events}}var Ma=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){var r=arguments;null!==e&&clearTimeout(e),e=setTimeout(function(){t.apply(null,r),e=null,r=null},n)}}},La=function(t,n,e){var r=!1,o=Ca.create({start:Sa([]),stop:Sa([])}),i=Wa(),u=function(){l.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=Ma(u,200);i.events.move.bind(function(e){n.mutate(t,e.info())});var c=function(t){return function(){var n=Array.prototype.slice.call(arguments,0);if(r)return t.apply(null,n)}},l=n.sink(Ra.api({forceDrop:u,drop:c(u),move:c(function(t,e){a.cancel(),i.onEvent(t,n)}),delayDrop:c(a.throttle)}),e);return{element:l.element,go:function(t){l.start(t),i.on(),o.trigger.start()},on:function(){r=!0},off:function(){r=!1},destroy:function(){l.destroy()},events:o.registry}},qa={transform:function(t,n){var e=void 0!==n?n:{},r=void 0!==e.mode?e.mode:Pa;return La(t,r,n)}};function Fa(){var t=Ca.create({drag:Sa(["xDelta","yDelta","target"])}),n=s.none(),e=function(){var t=Ca.create({drag:Sa(["xDelta","yDelta"])});return{mutate:function(n,e){t.trigger.drag(n,e)},events:t.registry}}();return e.events.drag.bind(function(e){n.each(function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)})}),{assign:function(t){n=s.some(t)},get:function(){return n},mutate:e.mutate,events:t.registry}}var za={any:function(t){return yn.first(t).isSome()},ancestor:function(t,n,e){return yn.ancestor(t,n,e).isSome()},sibling:function(t,n){return yn.sibling(t,n).isSome()},child:function(t,n){return yn.child(t,n).isSome()},descendant:function(t,n){return yn.descendant(t,n).isSome()},closest:function(t,n,e){return yn.closest(t,n,e).isSome()}},ja=qo.resolve("resizer-bar-dragging");function _a(t,n){var e=jr.height,r=function(t,n,e){var r=Fa(),i=qa.transform(r,{}),u=s.none(),a=function(t,n){return s.from(an.get(t,n))};r.events.drag.bind(function(t){a(t.target(),"data-row").each(function(n){var e=Qi.getInt(t.target(),"top");Mn.set(t.target(),"top",e+t.yDelta()+"px")}),a(t.target(),"data-column").each(function(n){var e=Qi.getInt(t.target(),"left");Mn.set(t.target(),"left",e+t.xDelta()+"px")})});var c=function(t,n){return Qi.getInt(t,n)-parseInt(an.get(t,"data-initial-"+n),10)};i.events.stop.bind(function(){r.get().each(function(r){u.each(function(o){a(r,"data-row").each(function(t){var n=c(r,"top");an.remove(r,"data-initial-top"),g.trigger.adjustHeight(o,n,parseInt(t,10))}),a(r,"data-column").each(function(t){var n=c(r,"left");an.remove(r,"data-initial-left"),g.trigger.adjustWidth(o,n,parseInt(t,10))}),ui.refresh(t,o,e,n)})})});var l=function(n,e){g.trigger.startAdjust(),r.assign(n),an.set(n,"data-initial-"+e,parseInt(Mn.get(n,e),10)),Qo.add(n,ja),Mn.set(n,"opacity","0.2"),i.go(t.parent())},f=Ba.bind(t.parent(),"mousedown",function(t){ui.isRowBar(t.target())&&l(t.target(),"top"),ui.isColBar(t.target())&&l(t.target(),"left")}),d=function(n){return qt.eq(n,t.view())},m=Ba.bind(t.view(),"mouseover",function(r){"table"===nn.name(r.target())||za.ancestor(r.target(),"table",d)?(u="table"===nn.name(r.target())?s.some(r.target()):yn.ancestor(r.target(),"table",d)).each(function(r){ui.refresh(t,r,e,n)}):sn.inBody(r.target())&&ui.destroy(t)}),g=Ca.create({adjustHeight:Sa(["table","delta","row"]),adjustWidth:Sa(["table","delta","column"]),startAdjust:Sa([])});return{destroy:function(){f.unbind(),m.unbind(),i.destroy(),ui.destroy(t)},refresh:function(r){ui.refresh(t,r,e,n)},on:i.on,off:i.off,hideBars:o.curry(ui.hide,t),showBars:o.curry(ui.show,t),events:g.registry}}(t,n,e),i=Ca.create({beforeResize:Sa(["table"]),afterResize:Sa(["table"]),startDrag:Sa([])});return r.events.adjustHeight.bind(function(t){i.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());pu.adjustHeight(t.table(),n,t.row(),e),i.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){i.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){i.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());pu.adjustWidth(t.table(),e,t.column(),n),i.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:i.registry}}var Ha={get:function(t,n){return t.inline?xa.body(Au.getBody(t),function(){var t=H.fromTag("div");return Mn.setAll(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Fn.append(sn.body(),t),t}()):xa.only(H.fromDom(t.getDoc()))},remove:function(t,n){t.inline&&_n.remove(n.parent())}};function Va(t){var n,e,r=s.none(),o=s.none(),i=s.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var n=Hr(Bu.directionAt),e=Ha.get(t);if(i=s.some(e),$u(t)&&Lu(t)){var u=_a(e,n);u.on(),u.events.startDrag.bind(function(n){r=s.some(t.selection.getRng())}),u.events.afterResize.bind(function(n){var e=n.table(),o=mn.descendants(e,"td[data-mce-style],th[data-mce-style]");C.each(o,function(t){an.remove(t,"data-mce-style")}),r.each(function(n){t.selection.setRng(n),t.focus()}),t.undoManager.add()}),o=s.some(u)}}),t.on("ObjectResizeStart",function(r){var o;a(r.target)&&(n=r.width,o=r.target,e=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))}),t.on("ObjectResized",function(r){if(a(r.target)){var o=r.target;if(u.test(e)){var i=parseFloat(u.exec(e)[1]),c=r.width*i/n;t.dom.setStyle(o,"width",c+"%")}else{var l=[];ta.each(o.rows,function(n){ta.each(n.cells,function(n){var e=t.dom.getStyle(n,"width",!0);l.push({cell:n,width:e})})}),ta.each(l,function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(xa.only(H.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(n){Ha.remove(t,n)})}}}var Ua=function(t){return{fold:t}},Ga=function(t){return Ua(function(n,e,r,o){return n(t)})},Xa=function(t){return Ua(function(n,e,r,o){return e(t)})},Ya=function(t,n){return Ua(function(e,r,o,i){return o(t,n)})},Ka=function(t){return Ua(function(n,e,r,o){return o(t)})},$a=function(t,n){return Rn.table(t,n).bind(function(n){var e=Rn.cells(n);return C.findIndex(e,function(n){return qt.eq(t,n)}).map(function(t){return{index:o.constant(t),all:o.constant(e)}})})},Ja=function(t,n){return $a(t,n).fold(function(){return Ga(t)},function(n){return n.index()+1<n.all().length?Ya(t,n.all()[n.index()+1]):Ka(t)})},Qa=function(t,n){return $a(t,n).fold(function(){return Ga()},function(n){return n.index()-1>=0?Ya(t,n.all()[n.index()-1]):Xa(t)})},Za=Xe([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),tc={before:Za.before,on:Za.on,after:Za.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(o.identity,o.identity,o.identity)}},nc=Xe([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ec=I.immutable("start","soffset","finish","foffset"),rc={domRange:nc.domRange,relative:nc.relative,exact:nc.exact,exactFromRange:function(t){return nc.exact(t.start(),t.soffset(),t.finish(),t.foffset())},range:ec,getWin:function(t){var n=function(t){return t.match({domRange:function(t){return H.fromDom(t.startContainer)},relative:function(t,n){return tc.getStart(t)},exact:function(t,n,e,r){return t}})}(t);return Gt.defaultView(n)}},oc=function(t,n,e,r){var o=Gt.owner(t).dom().createRange();return o.setStart(t.dom(),n),o.setEnd(e.dom(),r),o},ic=function(t,n,e,r){var o=oc(t,n,e,r),i=qt.eq(t,e)&&n===r;return o.collapsed&&!i},uc=function(t,n){var e=(n||document).createDocumentFragment();return C.each(t,function(t){e.appendChild(t.dom())}),H.fromDom(e)},ac=function(t,n){t.selectNodeContents(n.dom())},cc=function(t){t.deleteContents()},lc=function(t){return{left:o.constant(t.left),top:o.constant(t.top),right:o.constant(t.right),bottom:o.constant(t.bottom),width:o.constant(t.width),height:o.constant(t.height)}},sc={create:function(t){return t.document.createRange()},replaceWith:function(t,n){cc(t),t.insertNode(n.dom())},selectNodeContents:function(t,n){var e=t.document.createRange();return ac(e,n),e},selectNodeContentsUsing:ac,relativeToNative:function(t,n,e){var r,o=t.document.createRange();return r=o,n.fold(function(t){r.setStartBefore(t.dom())},function(t,n){r.setStart(t.dom(),n)},function(t){r.setStartAfter(t.dom())}),function(t,n){n.fold(function(n){t.setEndBefore(n.dom())},function(n,e){t.setEnd(n.dom(),e)},function(n){t.setEndAfter(n.dom())})}(o,e),o},exactToNative:function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},deleteContents:cc,cloneFragment:function(t){var n=t.cloneContents();return H.fromDom(n)},getFirstRect:function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?s.some(e).map(lc):s.none()},getBounds:function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?s.some(n).map(lc):s.none()},isWithin:function(t,n){return n.compareBoundaryPoints(t.END_TO_START,t)<1&&n.compareBoundaryPoints(t.START_TO_END,t)>-1},toString:function(t){return t.toString()}},fc=Xe([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),dc=function(t,n,e){return n(H.fromDom(e.startContainer),e.startOffset,H.fromDom(e.endContainer),e.endOffset)},mc=function(t,n){return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return fc.rtl(H.fromDom(t.endContainer),t.endOffset,H.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return dc(0,fc.ltr,e)}):dc(0,fc.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:o.constant(t),rtl:s.none}},relative:function(n,e){return{ltr:ut(function(){return sc.relativeToNative(t,n,e)}),rtl:ut(function(){return s.some(sc.relativeToNative(t,e,n))})}},exact:function(n,e,r,o){return{ltr:ut(function(){return sc.exactToNative(t,n,e,r,o)}),rtl:ut(function(){return s.some(sc.exactToNative(t,r,o,n,e))})}}})}(t,n))},gc={ltr:fc.ltr,rtl:fc.rtl,diagnose:mc,asLtrRange:function(t,n){return mc(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})}},pc=function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom},hc=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(n-a.left);if(e>a.bottom);else{if(e<a.top||c>i)return u-1;i=c}}return 0},vc={locate:function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects();return bo(i,function(t){return pc(t,e,r)?s.some(t):s.none()}).map(function(o){return function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=te.get(n).length,a=hc(function(t){return i(t).getBoundingClientRect()},e,r,o.right,u);return i(a)}(t,n,e,r,o)})}},bc=function(t,n,e,r){var o=t.dom().createRange(),i=Gt.children(n);return bo(i,function(n){return o.selectNode(n.dom()),pc(o.getBoundingClientRect(),e,r)?wc(t,n,e,r):s.none()})},wc=function(t,n,e,r){return(nn.isText(n)?vc.locate:bc)(t,n,e,r)},yc=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return wc(t,n,u,a)},xc=function(t,n){return n-t.left<t.right-n},Sc=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},Cc=function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=xc(o,e);return(!0===i?ue.first:ue.last)(n).map(function(n){return Sc(t,n,i)})},Rc=function(t,n,e){var r=n.dom().getBoundingClientRect(),o=xc(r,e);return s.some(Sc(t,n,o))},Tc=function(t,n,e){return(0===Gt.children(n).length?Rc:Cc)(t,n,e)},Dc=document.caretPositionFromPoint?function(t,n,e){return s.from(t.dom().caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return s.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),s.some(e)})}:document.caretRangeFromPoint?function(t,n,e){return s.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return H.fromPoint(t,n,e).bind(function(r){var o=function(){return Tc(t,r,n)};return 0===Gt.children(r).length?o():function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return yc(t,n,u,a)}(t,r,n,e).orThunk(o)})},Ac=function(t,n,e){var r=H.fromDom(t.document);return Dc(r,n,e).map(function(t){return rc.range(H.fromDom(t.startContainer),t.startOffset,H.fromDom(t.endContainer),t.endOffset)})},kc=function(t,n,e){var r=gc.asLtrRange(t,n),o=H.fromDom(r.commonAncestorContainer);return nn.isElement(o)?function(t,n,e,r){var o=sc.create(t),i=(J.is(n,r)?[n]:[]).concat(mn.descendants(n,r));return C.filter(i,function(t){return sc.selectNodeContentsUsing(o,t),sc.isWithin(e,o)})}(t,o,r,e):[]},Nc=function(t,n){var e=nn.name(t);return"input"===e?tc.after(t):C.contains(["br","img"],e)?0===n?tc.before(t):tc.after(t):tc.on(t,n)},Oc=function(t,n){var e=t.fold(tc.before,Nc,tc.after),r=n.fold(tc.before,Nc,tc.after);return rc.relative(e,r)},Ec=function(t,n,e,r){var o=Nc(t,n),i=Nc(e,r);return rc.relative(o,i)},Bc=function(t){return t.match({domRange:function(t){var n=H.fromDom(t.startContainer),e=H.fromDom(t.endContainer);return Ec(n,t.startOffset,e,t.endOffset)},relative:Oc,exact:Ec})},Pc=Oc,Ic=Ec,Wc=function(t,n){s.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(n)})},Mc=function(t,n,e,r,o){var i=sc.exactToNative(t,n,e,r,o);Wc(t,i)},Lc=function(t,n){return gc.diagnose(t,n).match({ltr:function(n,e,r,o){Mc(t,n,e,r,o)},rtl:function(n,e,r,o){var i=t.getSelection();i.extend?(i.collapse(n.dom(),e),i.extend(r.dom(),o)):Mc(t,r,o,n,e)}})},qc=function(t){var n=H.fromDom(t.anchorNode),e=H.fromDom(t.focusNode);return ic(n,t.anchorOffset,e,t.focusOffset)?s.some(rc.range(H.fromDom(t.anchorNode),t.anchorOffset,H.fromDom(t.focusNode),t.focusOffset)):function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return s.some(rc.range(H.fromDom(n.startContainer),n.startOffset,H.fromDom(e.endContainer),e.endOffset))}return s.none()}(t)},Fc=function(t){var n=t.getSelection();return n.rangeCount>0?qc(n):s.none()},zc={setExact:function(t,n,e,r,o){var i=Ic(n,e,r,o);Lc(t,i)},getExact:Fc,get:function(t){return Fc(t).map(function(t){return rc.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},setRelative:function(t,n,e){var r=Pc(n,e);Lc(t,r)},toNative:function(t){var n=rc.getWin(t).dom(),e=function(t,e,r,o){return sc.exactToNative(n,t,e,r,o)},r=Bc(t);return gc.diagnose(n,r).match({ltr:e,rtl:e})},setToElement:function(t,n){var e=sc.selectNodeContents(t,n);Wc(t,e)},clear:function(t){t.getSelection().removeAllRanges()},clone:function(t,n){var e=gc.asLtrRange(t,n);return sc.cloneFragment(e)},replace:function(t,n,e){var r=gc.asLtrRange(t,n),o=uc(e,t.document);sc.replaceWith(r,o)},deleteAt:function(t,n){var e=gc.asLtrRange(t,n);sc.deleteContents(e)},forElement:function(t,n){var e=sc.selectNodeContents(t,n);return rc.range(H.fromDom(e.startContainer),e.startOffset,H.fromDom(e.endContainer),e.endOffset)},getFirstRect:function(t,n){var e=gc.asLtrRange(t,n);return sc.getFirstRect(e)},getBounds:function(t,n){var e=gc.asLtrRange(t,n);return sc.getBounds(e)},getAtPoint:function(t,n,e){return Ac(t,n,e)},findWithin:function(t,n,e){return kc(t,n,e)},getAsString:function(t,n){var e=gc.asLtrRange(t,n);return sc.toString(e)},isCollapsed:function(t,n,e,r){return qt.eq(t,e)&&n===r}},jc=tinymce.util.Tools.resolve("tinymce.util.VK"),_c=function(t,n,e,r){return Uc(t,n,Ja(e),r)},Hc=function(t,n,e,r){return Uc(t,n,Qa(e),r)},Vc=function(t,n){var e=rc.exact(n,0,n,0);return zc.toNative(e)},Uc=function(t,n,e,r,o){return e.fold(s.none,s.none,function(t,n){return ue.first(n).map(function(t){return Vc(0,t)})},function(e){return Rn.table(e,n).bind(function(n){var o=er.noMenu(e);return t.undoManager.transact(function(){r.insertRowsAfter(n,o)}),function(t,n){var e=mn.descendants(n,"tr");return C.last(e).bind(function(t){return yn.descendant(t,"td,th").map(function(t){return Vc(0,t)})})}(0,n)})})},Gc=["table","li","dl"],Xc={handle:function(t,n,e,r){if(t.keyCode===jc.TAB){var o=Au.getBody(n),i=function(t){var n=nn.name(t);return qt.eq(t,o)||C.contains(Gc,n)},u=n.selection.getRng();if(u.collapsed){var a=H.fromDom(u.startContainer);Rn.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?Hc:_c)(n,i,o,e,r).each(function(t){n.selection.setRng(t)})})}}}},Yc={response:I.immutable("selection","kill")},Kc=function(t){return function(n){return n===t}},$c=Kc(38),Jc=Kc(40),Qc={ltr:{isBackward:Kc(37),isForward:Kc(39)},rtl:{isBackward:Kc(39),isForward:Kc(37)},isUp:$c,isDown:Jc,isNavigation:function(t){return t>=37&&t<=40}},Zc={convertToRange:function(t,n){var e=gc.asLtrRange(t,n);return{start:o.constant(H.fromDom(e.startContainer)),soffset:o.constant(e.startOffset),finish:o.constant(H.fromDom(e.endContainer)),foffset:o.constant(e.endOffset)}},makeSitus:function(t,n,e,r){return{start:o.constant(tc.on(t,n)),finish:o.constant(tc.on(e,r))}}},tl=Wt.detect().browser.isSafari(),nl=function(t){var n=void 0!==t?t.dom():document,e=n.body.scrollLeft||n.documentElement.scrollLeft,r=n.body.scrollTop||n.documentElement.scrollTop;return Ar(e,r)},el=function(t,n,e){(void 0!==e?e.dom():document).defaultView.scrollTo(t,n)},rl=function(t,n){tl&&E.isFunction(t.dom().scrollIntoViewIfNeeded)?t.dom().scrollIntoViewIfNeeded(!1):t.dom().scrollIntoView(n)},ol={get:nl,to:el,by:function(t,n,e){(void 0!==e?e.dom():document).defaultView.scrollBy(t,n)},preserve:function(t,n){var e=nl(t);n();var r=nl(t);e.top()===r.top()&&e.left()===r.left()||el(e.left(),e.top(),t)},capture:function(t){var n=s.none(),e=function(){n=s.some(nl(t))};return e(),{save:e,restore:function(){n.each(function(n){el(n.left(),n.top(),t)})}}},intoView:rl,intoViewIfNeeded:function(t,n){var e=n.dom().getBoundingClientRect(),r=t.dom().getBoundingClientRect();r.top<e.top?rl(t,!0):r.bottom>e.bottom&&rl(t,!1)},setToElement:function(t,n){var e=Or(n),r=H.fromDom(t.document);el(e.left(),e.top(),r)},scrollBarWidth:function(){var t=H.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');Fn.after(sn.body(),t);var n=t.dom().offsetWidth-t.dom().clientWidth;return _n.remove(t),n}};function il(t){return{elementFromPoint:function(n,e){return s.from(t.document.elementFromPoint(n,e)).map(H.fromDom)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(n,e,r,i){var u=rc.exact(n,e,r,i);return zc.getFirstRect(t,u).map(function(t){return N.map(t,o.apply)})},getSelection:function(){return zc.get(t).map(function(n){return Zc.convertToRange(t,n)})},fromSitus:function(n){var e=rc.relative(n.start(),n.finish());return Zc.convertToRange(t,e)},situsFromPoint:function(n,e){return zc.getAtPoint(t,n,e).map(function(t){return{start:o.constant(tc.on(t.start(),t.soffset())),finish:o.constant(tc.on(t.finish(),t.foffset()))}})},clearSelection:function(){zc.clear(t)},setSelection:function(n){zc.setExact(t,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,e){zc.setRelative(t,n,e)},selectContents:function(n){zc.setToElement(t,n)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return ol.get(H.fromDom(t.document)).top()},scrollBy:function(n,e){ol.by(n,e,H.fromDom(t.document))}}}var ul=function(t,n,e,r,o){if(!qt.eq(e,r))return He.identify(e,r,n).bind(function(n){var r=n.boxes().getOr([]);return r.length>0?(o(t,r,n.start(),n.finish()),s.some(Yc.response(s.some(Zc.makeSitus(e,0,e,re(e))),!0))):s.none()})},al={sync:function(t,n,e,r,o,i,u){return qt.eq(e,o)&&r===i?s.none():yn.closest(e,"td,th",n).bind(function(e){return yn.closest(o,"td,th",n).bind(function(r){return ul(t,n,e,r,u)})})},detect:ul,update:function(t,n,e,r,o){return He.shiftSelection(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(e),o.selectRange(e,t.boxes(),t.start(),t.finish()),t.boxes()})}},cl=I.immutableBag(["left","top","right","bottom"],[]),ll={nu:cl,moveUp:function(t,n){return cl({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},moveDown:function(t,n){return cl({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},moveBottomTo:function(t,n){var e=t.bottom()-t.top();return cl({left:t.left(),top:n-e,right:t.right(),bottom:n})},moveTopTo:function(t,n){var e=t.bottom()-t.top();return cl({left:t.left(),top:n,right:t.right(),bottom:n+e})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,n,e){return cl({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},sl=function(t){return ll.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},fl=function(t,n){return s.some(t.getRect(n))},dl=function(t,n,e){return nn.isElement(n)?fl(t,n).map(sl):nn.isText(n)?function(t,n,e){return e>=0&&e<re(n)?t.getRangedRect(n,e,n,e+1):e>0?t.getRangedRect(n,e-1,n,e):s.none()}(t,n,e).map(sl):s.none()},ml=function(t,n){return nn.isElement(n)?fl(t,n).map(sl):nn.isText(n)?t.getRangedRect(n,0,n,re(n)).map(sl):s.none()},gl=I.immutable("item","mode"),pl=function(t,n,e,r){var o=void 0!==r?r:hl;return t.property().parent(n).map(function(t){return gl(t,o)})},hl=function(t,n,e,r){var o=void 0!==r?r:vl;return e.sibling(t,n).map(function(t){return gl(t,o)})},vl=function(t,n,e,r){var o=void 0!==r?r:vl,i=t.property().children(n);return e.first(i).map(function(t){return gl(t,o)})},bl=[{current:pl,next:hl,fallback:s.none()},{current:hl,next:vl,fallback:s.some(pl)},{current:vl,next:vl,fallback:s.some(hl)}],wl=function(t,n,e,r,o){return o=void 0!==o?o:bl,C.find(o,function(t){return t.current===e}).bind(function(e){return e.current(t,n,r,e.next).orThunk(function(){return e.fallback.bind(function(e){return wl(t,n,e,r)})})})},yl={backtrack:pl,sidestep:hl,advance:vl,go:wl},xl={left:function(){return{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return t.length>0?s.some(t[t.length-1]):s.none()}}},right:function(){return{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return t.length>0?s.some(t[0]):s.none()}}}},Sl=function(t,n,e,r,o,i){return yl.go(t,n,r,o).bind(function(n){return i(n.item())?s.none():e(n.item())?s.some(n.item()):Sl(t,n.item(),e,n.mode(),o,i)})},Cl=function(t,n,e,r){return Sl(t,n,e,yl.sidestep,xl.left(),r)},Rl=function(t,n,e,r){return Sl(t,n,e,yl.sidestep,xl.right(),r)},Tl=function(t,n){return 0===t.property().children(n).length},Dl=function(t,n,e,r){return Cl(t,n,e,r)},Al=function(t,n,e,r){return Rl(t,n,e,r)},kl={before:function(t,n,e){return Dl(t,n,o.curry(Tl,t),e)},after:function(t,n,e){return Al(t,n,o.curry(Tl,t),e)},seekLeft:Dl,seekRight:Al,walkers:function(){return{left:xl.left,right:xl.right}},walk:function(t,n,e,r,o){return yl.go(t,n,e,r,o)},backtrack:yl.backtrack,sidestep:yl.sidestep,advance:yl.advance},Nl=ge(),Ol={gather:function(t,n,e){return kl.gather(Nl,t,n,e)},before:function(t,n){return kl.before(Nl,t,n)},after:function(t,n){return kl.after(Nl,t,n)},seekLeft:function(t,n,e){return kl.seekLeft(Nl,t,n,e)},seekRight:function(t,n,e){return kl.seekRight(Nl,t,n,e)},walkers:function(){return kl.walkers()},walk:function(t,n,e,r){return kl.walk(Nl,t,n,e,r)}},El=Xe([{none:[]},{retry:["caret"]}]),Bl=function(t,n,e){return bn.closest(n,co).fold(o.constant(!1),function(n){return ml(t,n).exists(function(t){return function(t,n){return t.left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right()}(e,t)})})},Pl={point:ll.getTop,adjuster:function(t,n,e,r,o){var i=ll.moveUp(o,5);return Math.abs(e.top()-r.top())<1?El.retry(i):e.bottom()<o.top()?El.retry(i):e.bottom()===o.top()?El.retry(ll.moveUp(o,1)):Bl(t,n,o)?El.retry(ll.translate(i,5,0)):El.none()},move:ll.moveUp,gather:Ol.before},Il={point:ll.getBottom,adjuster:function(t,n,e,r,o){var i=ll.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1?El.retry(i):e.top()>o.bottom()?El.retry(i):e.top()===o.bottom()?El.retry(ll.moveDown(o,1)):Bl(t,n,o)?El.retry(ll.translate(i,5,0)):El.none()},move:ll.moveDown,gather:Ol.after},Wl=function(t,n,e,r,o){return 0===o?s.some(r):function(t,n,e){return t.elementFromPoint(n,e).filter(function(t){return"table"===nn.name(t)}).isSome()}(t,r.left(),n.point(r))?function(t,n,e,r,o){return Wl(t,n,e,n.move(r,5),o)}(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind(function(i){return i.start().fold(s.none,function(i,u){return ml(t,i,u).bind(function(u){return n.adjuster(t,i,u,e,r).fold(s.none,function(r){return Wl(t,n,e,r,o-1)})}).orThunk(function(){return s.some(r)})},s.none)})},Ml=function(t,n,e){var r=t.move(e,5),o=Wl(n,t,e,r,100).getOr(r);return function(t,n,e){return t.point(n)>e.getInnerHeight()?s.some(t.point(n)-e.getInnerHeight()):t.point(n)<0?s.some(-t.point(n)):s.none()}(t,o,n).fold(function(){return n.situsFromPoint(o.left(),t.point(o))},function(e){return n.scrollBy(0,e),n.situsFromPoint(o.left(),t.point(o)-e)})},Ll={tryUp:o.curry(Ml,Pl),tryDown:o.curry(Ml,Il),ieTryUp:function(t,n){return t.situsFromPoint(n.left(),n.top()-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left(),n.bottom()+5)},getJumpSize:o.constant(5)},ql=Xe([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Fl=function(t){return yn.closest(t,"tr")},zl={verify:function(t,n,e,r,o,i,u){return yn.closest(r,"td,th",u).bind(function(e){return yn.closest(n,"td,th",u).map(function(n){return qt.eq(e,n)?qt.eq(r,e)&&re(e)===o?i(n):ql.none("in same cell"):Re(Fl,[e,n]).fold(function(){return function(t,n,e){var r=t.getRect(n),o=t.getRect(e);return o.right>r.left&&o.left<r.right}(t,n,e)?ql.success():i(n)},function(t){return i(n)})})}).getOr(ql.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)},adt:ql},jl={point:I.immutable("element","offset"),delta:I.immutable("element","deltaOffset"),range:I.immutable("element","start","finish"),points:I.immutable("begin","end"),text:I.immutable("element","text")},_l=(I.immutable("ancestor","descendants","element","index"),I.immutable("parent","children","element","index")),Hl=function(t,n){return C.findIndex(t,o.curry(qt.eq,n))},Vl=function(t){return Gt.parent(t).bind(function(n){var e=Gt.children(n);return Hl(e,t).map(function(r){return _l(n,e,t,r)})})},Ul=function(t){return"br"===nn.name(t)},Gl=function(t,n,e){return n(t,e).bind(function(t){return nn.isText(t)&&0===te.get(t).trim().length?Gl(t,n,e):s.some(t)})},Xl=function(t,n,e,r){return function(t,n){return Gt.child(t,n).filter(Ul).orThunk(function(){return Gt.child(t,n-1).filter(Ul)})}(n,e).bind(function(n){return r.traverse(n).fold(function(){return Gl(n,r.gather,t).map(r.relative)},function(t){return Vl(t).map(function(t){return tc.on(t.parent(),t.index())})})})},Yl=function(t,n,e,r){return(Ul(n)?function(t,n,e){return e.traverse(n).orThunk(function(){return Gl(n,e.gather,t)}).map(e.relative)}(t,n,r):Xl(t,n,e,r)).map(function(t){return{start:o.constant(t),finish:o.constant(t)}})},Kl=function(t){return zl.cata(t,function(t){return s.none()},function(){return s.none()},function(t){return s.some(jl.point(t,0))},function(t){return s.some(jl.point(t,re(t)))})},$l=Wt.detect(),Jl=function(t,n,e,r,o,i){return 0===i?s.none():ts(t,n,e,r,o).bind(function(u){var a=t.fromSitus(u),c=zl.verify(t,e,r,a.finish(),a.foffset(),o.failure,n);return zl.cata(c,function(){return s.none()},function(){return s.some(u)},function(u){return qt.eq(e,u)&&0===r?Ql(t,e,r,ll.moveUp,o):Jl(t,n,u,0,o,i-1)},function(u){return qt.eq(e,u)&&r===re(u)?Ql(t,e,r,ll.moveDown,o):Jl(t,n,u,re(u),o,i-1)})})},Ql=function(t,n,e,r,o){return dl(t,n,e).bind(function(n){return Zl(t,o,r(n,Ll.getJumpSize()))})},Zl=function(t,n,e){return $l.browser.isChrome()||$l.browser.isSafari()||$l.browser.isFirefox()||$l.browser.isEdge()?n.otherRetry(t,e):$l.browser.isIE()?n.ieRetry(t,e):s.none()},ts=function(t,n,e,r,o){return dl(t,e,r).bind(function(n){return Zl(t,o,n)})},ns=function(t,n,e){return function(t,n,e){return t.getSelection().bind(function(r){return Yl(n,r.finish(),r.foffset(),e).fold(function(){return s.some(jl.point(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=zl.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),e.failure,n);return Kl(u)})})}(t,n,e).bind(function(r){return Jl(t,n,r.element(),r.offset(),e,20).map(t.fromSitus)})},es=function(t,n,e){return bn.ancestor(t,n,e).isSome()},rs=Wt.detect(),os=function(t,n,e,r,i){return yn.closest(r,"td,th",n).bind(function(r){return yn.closest(r,"table",n).bind(function(u){return function(t,n){return es(t,function(t){return Gt.parent(t).exists(function(t){return qt.eq(t,n)})})}(i,u)?ns(t,n,e).bind(function(t){return yn.closest(t.finish(),"td,th",n).map(function(n){return{start:o.constant(r),finish:o.constant(n),range:o.constant(t)}})}):s.none()})})},is=function(t,n,e,r,o,i){return rs.browser.isIE()?s.none():i(r,n).orThunk(function(){return os(t,n,e,r,o).map(function(t){var n=t.range();return Yc.response(s.some(Zc.makeSitus(n.start(),n.soffset(),n.finish(),n.foffset())),!0)})})},us=function(t,n,e,r,o,i,u){return os(t,e,r,o,i).bind(function(t){return al.detect(n,e,t.start(),t.finish(),u)})},as=function(t,n){return yn.closest(t,"tr",n).bind(function(t){return yn.closest(t,"table",n).bind(function(e){var r=mn.descendants(e,"tr");return qt.eq(t,r[0])?Ol.seekLeft(e,function(t){return ue.last(t).isSome()},n).map(function(t){var n=re(t);return Yc.response(s.some(Zc.makeSitus(t,n,t,n)),!0)}):s.none()})})},cs=function(t,n){return yn.closest(t,"tr",n).bind(function(t){return yn.closest(t,"table",n).bind(function(e){var r=mn.descendants(e,"tr");return qt.eq(t,r[r.length-1])?Ol.seekRight(e,function(t){return ue.first(t).isSome()},n).map(function(t){return Yc.response(s.some(Zc.makeSitus(t,0,t,0)),!0)}):s.none()})})},ls=function(t,n){return yn.closest(t,"td,th",n)},ss={down:{traverse:Gt.nextSibling,gather:Ol.after,relative:tc.before,otherRetry:Ll.tryDown,ieRetry:Ll.ieTryDown,failure:zl.adt.failedDown},up:{traverse:Gt.prevSibling,gather:Ol.before,relative:tc.before,otherRetry:Ll.tryUp,ieRetry:Ll.ieTryUp,failure:zl.adt.failedUp}},fs=I.immutable("rows","cols"),ds={mouse:function(t,n,e,r){var o=function(t,n,e,r){var o=s.none(),i=function(){o=s.none()};return{mousedown:function(t){r.clear(n),o=ls(t.target(),e)},mouseover:function(i){o.each(function(o){r.clear(n),ls(i.target(),e).each(function(i){He.identify(o,i,e).each(function(e){var u=e.boxes().getOr([]);(u.length>1||1===u.length&&!qt.eq(o,i))&&(r.selectRange(n,u,e.start(),e.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}}(il(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,n,e,r){var i=il(t),u=function(){return r.clear(n),s.none()};return{keydown:function(t,a,c,l,f,d){var m=t.raw().which,g=!0===t.raw().shiftKey;return He.retrieve(n,r.selectedSelector()).fold(function(){return Qc.isDown(m)&&g?o.curry(us,i,n,e,ss.down,l,a,r.selectRange):Qc.isUp(m)&&g?o.curry(us,i,n,e,ss.up,l,a,r.selectRange):Qc.isDown(m)?o.curry(is,i,e,ss.down,l,a,cs):Qc.isUp(m)?o.curry(is,i,e,ss.up,l,a,as):s.none},function(t){var e=function(e){return function(){return bo(e,function(e){return al.update(e.rows(),e.cols(),n,t,r)}).fold(function(){return He.getEdges(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var e=Qc.isDown(m)||d.isForward(m)?tc.after:tc.before;return i.setRelativeSelection(tc.on(t.first(),0),e(t.table())),r.clear(n),Yc.response(s.none(),!0)})},function(t){return s.some(Yc.response(s.none(),!0))})}};return Qc.isDown(m)&&g?e([fs(1,0)]):Qc.isUp(m)&&g?e([fs(-1,0)]):d.isBackward(m)&&g?e([fs(0,-1),fs(-1,0)]):d.isForward(m)&&g?e([fs(0,1),fs(1,0)]):Qc.isNavigation(m)&&!1===g?u:s.none})()},keyup:function(t,o,i,u,a){return He.retrieve(n,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?s.none():Qc.isNavigation(c)?al.sync(n,e,o,i,u,a,r.selectRange):s.none()},s.none)}}}},ms=function(t,n){C.each(n,function(n){Qo.remove(t,n)})},gs=function(t){return function(n){Qo.add(n,t)}},ps=function(t){return function(n){ms(n,t)}},hs={byClass:function(t){var n=gs(t.selected()),e=ps([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(n){var r=mn.descendants(n,t.selectedSelector());C.each(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),C.each(o,n),Qo.add(i,t.firstSelected()),Qo.add(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var n=function(n){an.remove(n,t.selected()),an.remove(n,t.firstSelected()),an.remove(n,t.lastSelected())},e=function(n){an.set(n,t.selected(),"1")},r=function(e){var r=mn.descendants(e,t.selectedSelector());C.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),C.each(o,e),an.set(i,t.firstSelected(),"1"),an.set(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}};function vs(t,n){var e=I.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=s.none(),i=hs.byAttr(Ge);return t.on("init",function(u){var a=t.getWin(),c=Au.getBody(t),l=Au.getIsRoot(t),f=ds.mouse(a,c,l,i),d=ds.keyboard(a,c,l,i),m=function(n,e){(function(t){return!0===t.raw().shiftKey})(n)&&(e.kill()&&n.kill(),e.selection().each(function(n){var e=rc.relative(n.start(),n.finish()),r=gc.asLtrRange(a,e);t.selection.setRng(r)}))},g=function(n){var e=v(n);if(e.raw().shiftKey&&Qc.isNavigation(e.raw().which)){var r=t.selection.getRng(),o=H.fromDom(r.startContainer),i=H.fromDom(r.endContainer);d.keyup(e,o,r.startOffset,i,r.endOffset).each(function(t){m(e,t)})}},p=function(t){return!(an.has(t,"data-mce-bogus")||"br"===nn.name(t)||nn.isText(t)&&0===te.get(t).length)},h=function(e){var r,o,i=v(e);n().each(function(t){t.hideBars()}),40===e.which&&(r=H.fromDom(t.getBody()),o=function(t){return Gt.prevSibling(t).bind(function(t){return p(t)?s.some(t):o(t)})},Gt.lastChild(r).bind(function(t){return p(t)?s.some(t):o(t)})).each(function(n){"table"===nn.name(n)&&(Fu(t)?t.dom.add(t.getBody(),Fu(t),Vu(t),"<br/>"):t.dom.add(t.getBody(),"br"))});var u=t.selection.getRng(),a=H.fromDom(t.selection.getStart()),c=H.fromDom(u.startContainer),l=H.fromDom(u.endContainer),f=Bu.directionAt(a).isRtl()?Qc.rtl:Qc.ltr;d.keydown(i,c,u.startOffset,l,u.endOffset,f).each(function(t){m(i,t)}),n().each(function(t){t.showBars()})},v=function(t){var n=H.fromDom(t.target),e=function(){t.stopPropagation()},r=function(){t.preventDefault()},i=o.compose(r,e);return{target:o.constant(n),x:o.constant(t.x),y:o.constant(t.y),stop:e,prevent:r,kill:i,raw:o.constant(t)}},b=function(t){return 0===t.button},w=function(t){b(t)&&f.mousedown(v(t))},y=function(t){var n;(void 0===(n=t).buttons||0!=(1&n.buttons))&&f.mouseover(v(t))},x=function(t){b&&f.mouseup(v(t))};t.on("mousedown",w),t.on("mouseover",y),t.on("mouseup",x),t.on("keyup",g),t.on("keydown",h),t.on("nodechange",function(){var n=t.selection,e=H.fromDom(n.getStart()),r=H.fromDom(n.getEnd()),u=Rn.table(e),a=Rn.table(r);u.bind(function(t){return a.bind(function(n){return qt.eq(t,n)?s.some(!0):s.none()})}).fold(function(){i.clear(c)},o.noop)}),r=s.some(e({mousedown:w,mouseover:y,mouseup:x,keyup:g,keydown:h}))}),{clear:i.clear,destroy:function(){r.each(function(t){})}}}var bs=ta.each,ws={addButtons:function(t){var n=[];function e(n){return function(){t.execCommand(n)}}bs("inserttable tableprops deletetable | cell row column".split(" "),function(e){"|"===e?n.push({text:"-"}):n.push(t.menuItems[e])}),t.addButton("table",{type:"menubutton",title:"Table",menu:n}),t.addButton("tableprops",{title:"Table properties",onclick:o.curry(ba,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:e("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:e("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:e("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:e("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:e("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:e("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:e("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:e("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:e("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:e("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:e("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:e("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:e("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:e("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:e("mceTableDeleteCol")})},addToolbars:function(t){var n=function(t){var n=t.getParam("table_toolbar",Pu);return""===n||!1===n?[]:E.isString(n)?n.split(/[ ,]/):E.isArray(n)?n:[]}(t);n.length>0&&t.addContextToolbar(function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},n.join(" "))}},ys={addMenuItems:function(t,n){var e=s.none(),r=[],i=[],u=[],a=[],c=function(t){t.disabled(!0)},l=function(t){t.disabled(!1)},f=function(){var t=this;r.push(t),e.fold(function(){c(t)},function(n){l(t)})},d=function(){var t=this;i.push(t),e.fold(function(){c(t)},function(n){l(t)})};t.on("init",function(){t.on("nodechange",function(o){var f=s.from(t.dom.getParent(t.selection.getStart(),"th,td"));(e=f.bind(function(t){var e=H.fromDom(t);return Rn.table(e).map(function(t){return er.forMenu(n,t,e)})})).fold(function(){C.each(r,c),C.each(i,c),C.each(u,c),C.each(a,c)},function(t){C.each(r,l),C.each(i,l),C.each(u,function(n){n.disabled(t.mergable().isNone())}),C.each(a,function(n){n.disabled(t.unmergable().isNone())})})})});var m=function(t,n,e,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=n+1+" x "+(e+1),s&&(n=9-n),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=n:o<=n)&&i<=e,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},g=!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?{text:"Table",icon:"table",context:"table",onclick:o.curry(ba,t)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(n){n.aria&&(this.parent().hideAll(),n.stopImmediatePropagation(),ba(t))},onshow:function(){m(t,0,0,this.menu.items()[0])},onhide:function(){var n=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(n,"mce-active"),t.dom.addClass(n[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var n=0;n<10;n++){t+="<tr>";for(var e=0;e<10;e++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*n+e)+'" href="#" data-mce-x="'+e+'" data-mce-y="'+n+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(n){var e,r,o=n.target;"A"===o.tagName.toUpperCase()&&(e=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(e=9-e),e===this.lastX&&r===this.lastY||(m(t,e,r,n.control),this.lastX=e,this.lastY=r))},onclick:function(n){var e=this;"A"===n.target.tagName.toUpperCase()&&(n.preventDefault(),n.stopPropagation(),e.parent().cancel(),t.undoManager.transact(function(){pa(t,e.lastX+1,e.lastY+1)}),t.addVisual())}}]};function p(n){return function(){t.execCommand(n)}}var h={text:"Table properties",context:"table",onPostRender:f,onclick:o.curry(ba,t,!0)},v={text:"Delete table",context:"table",onPostRender:f,cmd:"mceTableDelete"},b={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:p("mceTableInsertRowBefore"),onPostRender:d},{text:"Insert row after",onclick:p("mceTableInsertRowAfter"),onPostRender:d},{text:"Delete row",onclick:p("mceTableDeleteRow"),onPostRender:d},{text:"Row properties",onclick:p("mceTableRowProps"),onPostRender:d},{text:"-"},{text:"Cut row",onclick:p("mceTableCutRow"),onPostRender:d},{text:"Copy row",onclick:p("mceTableCopyRow"),onPostRender:d},{text:"Paste row before",onclick:p("mceTablePasteRowBefore"),onPostRender:d},{text:"Paste row after",onclick:p("mceTablePasteRowAfter"),onPostRender:d}]},w={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:p("mceTableInsertColBefore"),onPostRender:d},{text:"Insert column after",onclick:p("mceTableInsertColAfter"),onPostRender:d},{text:"Delete column",onclick:p("mceTableDeleteCol"),onPostRender:d}]},y={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:p("mceTableCellProps"),onPostRender:d},{text:"Merge cells",onclick:p("mceTableMergeCells"),onPostRender:function(){var t=this;u.push(t),e.fold(function(){c(t)},function(n){t.disabled(n.mergable().isNone())})}},{text:"Split cell",onclick:p("mceTableSplitCells"),onPostRender:function(){var t=this;a.push(t),e.fold(function(){c(t)},function(n){t.disabled(n.unmergable().isNone())})}}]};t.addMenuItem("inserttable",g),t.addMenuItem("tableprops",h),t.addMenuItem("deletetable",v),t.addMenuItem("row",b),t.addMenuItem("column",w),t.addMenuItem("cell",y)}},xs=function(t,n){return{insertTable:function(n,e){return pa(t,n,e)},setClipboardRows:function(t){return function(t,n){var e=C.map(t,H.fromDom);n.set(s.from(e))}(t,n)},getClipboardRows:function(){return function(t){return t.get().fold(function(){},function(t){return C.map(t,function(t){return t.dom()})})}(n)}}};e.add("table",function(t){var n=Va(t),e=vs(t,n.lazyResize),r=function(t,n){var e=function(t){return"table"===nn.name(Au.getBody(t))},r=Ku(t),i=function(n,e,o,i){return function(u,a){var c=mn.descendants(u,"td[data-mce-style],th[data-mce-style]");C.each(c,function(t){an.remove(t,"data-mce-style")});var l=i(),f=H.fromDom(t.getDoc()),d=Hr(Bu.directionAt),m=fe.cellOperations(o,f,r);return e(u)?n(l,u,a,m,d).bind(function(n){return C.each(n.newRows(),function(n){Ju(t,n.dom())}),C.each(n.newCells(),function(n){Qu(t,n.dom())}),n.cursor().map(function(n){var e=t.dom.createRng();return e.setStart(n.dom(),0),e.setEnd(n.dom(),0),e})}):s.none()}};return{deleteRow:i(Tu.eraseRows,function(n){var r=Vr.getGridSize(n);return!1===e(t)||r.rows()>1},o.noop,n),deleteColumn:i(Tu.eraseColumns,function(n){var r=Vr.getGridSize(n);return!1===e(t)||r.columns()>1},o.noop,n),insertRowsBefore:i(Tu.insertRowsBefore,o.always,o.noop,n),insertRowsAfter:i(Tu.insertRowsAfter,o.always,o.noop,n),insertColumnsBefore:i(Tu.insertColumnsBefore,o.always,Rr.halve,n),insertColumnsAfter:i(Tu.insertColumnsAfter,o.always,Rr.halve,n),mergeCells:i(Tu.mergeCells,o.always,o.noop,n),unmergeCells:i(Tu.unmergeCells,o.always,o.noop,n),pasteRowsBefore:i(Tu.pasteRowsBefore,o.always,o.noop,n),pasteRowsAfter:i(Tu.pasteRowsAfter,o.always,o.noop,n),pasteCells:i(Tu.pasteCells,o.always,o.noop,n)}}(t,n.lazyWire),i=function(t){return{get:function(){var n=Au.getBody(t);return Ve.retrieve(n,Ge.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?Ke.none():Ke.single(t.selection)},function(t){return Ke.multiple(t)})}}}(t),u=Ur(s.none());return ya.registerCommands(t,r,e,i,u),rr.registerEvents(t,i,r,e),ys.addMenuItems(t,i),ws.addButtons(t),ws.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(Ge.firstSelected()),t.serializer.addTempAttr(Ge.lastSelected())}),qu(t)&&t.on("keydown",function(e){Xc.handle(e,t,r,n.lazyWire)}),t.on("remove",function(){n.destroy(),e.destroy()}),xs(t,u)})}();