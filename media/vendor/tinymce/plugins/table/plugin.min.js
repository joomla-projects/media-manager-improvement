!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(t){return function(){return t}},n={noop:function(){},noarg:function(t){return function(){return t()}},compose:function(t,e){return function(){return t(e.apply(null,arguments))}},constant:e,identity:function(t){return t},tripleEquals:function(t,e){return t===e},curry:function(t){for(var e=new Array(arguments.length-1),n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}},not:function(t){return function(){return!t.apply(null,arguments)}},die:function(t){return function(){throw new Error(t)}},apply:function(t){return t()},call:function(t){t()},never:e(!1),always:e(!0)},r=n.never,o=n.always,i=function(){return u},u=function(){var t=function(t){return t.isNone()},e=function(t){return t()},u=function(t){return t},a={fold:function(t,e){return t()},is:r,isSome:r,isNone:o,getOr:u,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:u,orThunk:e,map:i,ap:i,each:function(){},bind:i,flatten:i,exists:r,forall:o,filter:i,equals:t,equals_:t,toArray:function(){return[]},toString:n.constant("none()")};return Object.freeze&&Object.freeze(a),a}(),a=function(t){var e=function(){return t},n=function(){return l},c=function(e){return e(t)},l={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:o,isNone:r,getOr:e,getOrThunk:e,getOrDie:e,or:n,orThunk:n,map:function(e){return a(e(t))},ap:function(e){return e.fold(i,function(e){return a(e(t))})},each:function(e){e(t)},bind:c,flatten:e,exists:c,forall:c,filter:function(e){return e(t)?l:u},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(r,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return l},c={some:a,none:i,from:function(t){return null===t||void 0===t?u:a(t)}},l=function(){var t=Array.prototype.indexOf;return void 0===t?function(t,e){return h(t,e)}:function(e,n){return t.call(e,n)}}(),s=function(t,e){return l(t,e)>-1},f=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},d=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},m=function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n,t)},g=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},p=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return c.some(n);return c.none()},h=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},v=Array.prototype.push,b=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);v.apply(e,t[n])}return e},w=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n,t))return!1;return!0},y=Array.prototype.slice,x={map:f,each:d,eachr:m,partition:function(t,e){for(var n=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(e(u,o,t)?n:r).push(u)}return{pass:n,fail:r}},filter:g,groupBy:function(t,e){if(0===t.length)return[];for(var n=e(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=e(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},indexOf:function(t,e){var n=l(t,e);return-1===n?c.none():c.some(n)},foldr:function(t,e,n){return m(t,function(t){n=e(n,t)}),n},foldl:function(t,e,n){return d(t,function(t){n=e(n,t)}),n},find:function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return c.some(o)}return c.none()},findIndex:p,flatten:b,bind:function(t,e){var n=f(t,e);return b(n)},forall:w,exists:function(t,e){return p(t,e).isSome()},contains:s,equal:function(t,e){return t.length===e.length&&w(t,function(t,n){return t===e[n]})},reverse:function(t){var e=y.call(t,0);return e.reverse(),e},chunk:function(t,e){for(var n=[],r=0;r<t.length;r+=e){var o=t.slice(r,r+e);n.push(o)}return n},difference:function(t,e){return g(t,function(t){return!s(e,t)})},mapToObject:function(t,e){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];n[String(i)]=e(i,r)}return n},pure:function(t){return[t]},sort:function(t,e){var n=y.call(t,0);return n.sort(e),n},range:function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},head:function(t){return 0===t.length?c.none():c.some(t[0])},last:function(t){return 0===t.length?c.none():c.some(t[t.length-1])}},S=function(){var t=Object.keys;return void 0===t?function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}:t}(),C=function(t,e){for(var n=S(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},R=function(t,e){var n={};return C(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},T=function(t,e){var n=[];return C(t,function(t,r){n.push(e(t,r))}),n},D=function(t){return T(t,function(t){return t})},A={bifilter:function(t,e){var n={},r={};return C(t,function(t,o){(e(t,o)?n:r)[o]=t}),{t:n,f:r}},each:C,map:function(t,e){return R(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},mapToArray:T,tupleMap:R,find:function(t,e){for(var n=S(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];if(e(u,i,t))return c.some(u)}return c.none()},keys:S,values:D,size:function(t){return D(t).length}},k=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e}(e)===t}},N={isString:k("string"),isObject:k("object"),isArray:k("array"),isNull:k("null"),isBoolean:k("boolean"),isUndefined:k("undefined"),isFunction:k("function"),isNumber:k("number")},O=function(t){return t.slice(0).sort()},E={sort:O,reqMessage:function(t,e){throw new Error("All required keys ("+O(t).join(", ")+") were not specified. Specified keys were: "+O(e).join(", ")+".")},unsuppMessage:function(t){throw new Error("Unsupported keys for object: "+O(t).join(", "))},validateStrArr:function(t,e){if(!N.isArray(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");x.each(e,function(e){if(!N.isString(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},invalidTypeMessage:function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+O(t).join(", ")+") were not.")},checkDupes:function(t){var e=O(t);x.find(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}},B={immutable:function(){var t=arguments;return function(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var o={};return x.each(t,function(t,r){o[t]=n.constant(e[r])}),o}},immutableBag:function(t,e){var r=t.concat(e);if(0===r.length)throw new Error("You must specify at least one required or optional field.");return E.validateStrArr("required",t),E.validateStrArr("optional",e),E.checkDupes(r),function(o){var i=A.keys(o);x.forall(t,function(t){return x.contains(i,t)})||E.reqMessage(t,i);var u=x.filter(i,function(t){return!x.contains(r,t)});u.length>0&&E.unsuppMessage(u);var a={};return x.each(t,function(t){a[t]=n.constant(o[t])}),x.each(e,function(t){a[t]=n.constant(Object.prototype.hasOwnProperty.call(o,t)?c.some(o[t]):c.none())}),a}}},I=B.immutable("width","height"),P=B.immutable("rows","columns"),W=B.immutable("row","column"),_=B.immutable("x","y"),M=B.immutable("element","rowspan","colspan"),L=B.immutable("element","rowspan","colspan","isNew"),q={dimensions:I,grid:P,address:W,coords:_,extended:B.immutable("element","rowspan","colspan","row","column"),detail:M,detailnew:L,rowdata:B.immutable("element","cells","section"),elementnew:B.immutable("element","isNew"),rowdatanew:B.immutable("element","cells","section","isNew"),rowcells:B.immutable("cells","section"),rowdetails:B.immutable("details","section"),bounds:B.immutable("startRow","startCol","finishRow","finishCol")},F=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:n.constant(t)}},z={fromHtml:function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return F(n.childNodes[0])},fromTag:function(t,e){var n=(e||document).createElement(t);return F(n)},fromText:function(t,e){var n=(e||document).createTextNode(t);return F(n)},fromDom:F,fromPoint:function(t,e,n){return c.from(t.dom().elementFromPoint(e,n)).map(F)}},j=8,H=9,V=1,U=3,G=V,X=H,Y=function(t){return t.nodeType!==G&&t.nodeType!==X||0===t.childElementCount},$={all:function(t,e){var n=void 0===e?document:e.dom();return Y(n)?[]:x.map(n.querySelectorAll(t),z.fromDom)},is:function(t,e){var n=t.dom();if(n.nodeType!==G)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},one:function(t,e){var n=void 0===e?document:e.dom();return Y(n)?c.none():c.from(n.querySelector(t)).map(z.fromDom)}},K=function(t,e){var n=[],r=function(t){return n.push(t),e(t)},o=e(t);do{o=o.bind(r)}while(o.isSome());return n},J="undefined"!=typeof window?window:Function("return this;")(),Q=function(t,e){for(var n=void 0!==e&&null!==e?e:J,r=0;r<t.length&&void 0!==n&&null!==n;++r)n=n[t[r]];return n},Z=function(t,e){var n=t.split(".");return Q(n,e)},tt=function(t,e){var n,r,o=(n=t,r=e,Z(n,r));if(void 0===o||null===o)throw t+" not available on this browser";return o},et=function(){return tt("Node")},nt=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},rt=function(t,e){return nt(t,e,et().DOCUMENT_POSITION_CONTAINED_BY)},ot=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}},it=function(){return ut(0,0)},ut=function(t,e){return{major:t,minor:e}},at={nu:ut,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?it():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return ut(r(1),r(2))}(t,n)},unknown:it},ct=function(t,e){return function(){return e===t}},lt=function(t){var e=t.current;return{current:e,version:t.version,isEdge:ct("Edge",e),isChrome:ct("Chrome",e),isIE:ct("IE",e),isOpera:ct("Opera",e),isFirefox:ct("Firefox",e),isSafari:ct("Safari",e)}},st={unknown:function(){return lt({current:void 0,version:at.unknown()})},nu:lt,edge:n.constant("Edge"),chrome:n.constant("Chrome"),ie:n.constant("IE"),opera:n.constant("Opera"),firefox:n.constant("Firefox"),safari:n.constant("Safari")},ft=function(t,e){return function(){return e===t}},dt=function(t){var e=t.current;return{current:e,version:t.version,isWindows:ft("Windows",e),isiOS:ft("iOS",e),isAndroid:ft("Android",e),isOSX:ft("OSX",e),isLinux:ft("Linux",e),isSolaris:ft("Solaris",e),isFreeBSD:ft("FreeBSD",e)}},mt={unknown:function(){return dt({current:void 0,version:at.unknown()})},nu:dt,windows:n.constant("Windows"),ios:n.constant("iOS"),android:n.constant("Android"),linux:n.constant("Linux"),osx:n.constant("OSX"),solaris:n.constant("Solaris"),freebsd:n.constant("FreeBSD")},gt=function(t,e){var n=String(e).toLowerCase();return x.find(t,function(t){return t.search(n)})},pt=function(t,e){return gt(t,e).map(function(t){var n=at.detect(t.versionRegexes,e);return{current:t.name,version:n}})},ht=function(t,e){return gt(t,e).map(function(t){var n=at.detect(t.versionRegexes,e);return{current:t.name,version:n}})},vt=function(t,e){return e+t},bt=function(t,e){return t+e},wt=function(t,e){return t.substring(e)},yt=function(t,e){return t.substring(0,t.length-e)},xt=function(t){return""===t?c.none():c.some(t.substr(0,1))},St=function(t){return""===t?c.none():c.some(t.substring(1))},Ct=function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e},Rt=function(t,e){return Ct(t,e,0)},Tt=function(t,e){return Ct(t,e,t.length-e.length)},Dt={supplant:function(t,e){return t.replace(/\${([^{}]*)}/g,function(t,n){var r=e[n];return function(t){var e=typeof t;return"string"===e||"number"===e}(r)?r:t})},startsWith:Rt,removeLeading:function(t,e){return Rt(t,e)?wt(t,e.length):t},removeTrailing:function(t,e){return Tt(t,e)?yt(t,e.length):t},ensureLeading:function(t,e){return Rt(t,e)?t:vt(t,e)},ensureTrailing:function(t,e){return Tt(t,e)?t:bt(t,e)},endsWith:Tt,contains:function(t,e){return-1!==t.indexOf(e)},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},lTrim:function(t){return t.replace(/^\s+/g,"")},rTrim:function(t){return t.replace(/\s+$/g,"")},capitalize:function(t){return xt(t).bind(function(e){return St(t).map(function(t){return e.toUpperCase()+t})}).getOr(t)}},At=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,kt=function(t){return function(e){return Dt.contains(e,t)}},Nt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Dt.contains(t,"edge/")&&Dt.contains(t,"chrome")&&Dt.contains(t,"safari")&&Dt.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,At],search:function(t){return Dt.contains(t,"chrome")&&!Dt.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Dt.contains(t,"msie")||Dt.contains(t,"trident")}},{name:"Opera",versionRegexes:[At,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:kt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:kt("firefox")},{name:"Safari",versionRegexes:[At,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Dt.contains(t,"safari")||Dt.contains(t,"mobile/"))&&Dt.contains(t,"applewebkit")}}],Ot=[{name:"Windows",search:kt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Dt.contains(t,"iphone")||Dt.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:kt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:kt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:kt("linux"),versionRegexes:[]},{name:"Solaris",search:kt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:kt("freebsd"),versionRegexes:[]}],Et={browsers:n.constant(Nt),oses:n.constant(Ot)},Bt=function(t){var e=Et.browsers(),r=Et.oses(),o=pt(e,t).fold(st.unknown,st.nu),i=ht(r,t).fold(mt.unknown,mt.nu);return{browser:o,os:i,deviceType:function(t,e,r){var o=t.isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=o||u||a&&!0===/mobile/i.test(r),l=t.isiOS()||t.isAndroid(),s=l&&!c,f=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(r);return{isiPad:n.constant(o),isiPhone:n.constant(i),isTablet:n.constant(c),isPhone:n.constant(s),isTouch:n.constant(l),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:n.constant(f)}}(i,o,t)}},It={detect:ot(function(){var t=navigator.userAgent;return Bt(t)})},Pt=function(t,e){return t.dom()===e.dom()},Wt=It.detect().browser.isIE()?function(t,e){return rt(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},_t={eq:Pt,isEqualNode:function(t,e){return t.dom().isEqualNode(e.dom())},member:function(t,e){return x.exists(e,n.curry(Pt,t))},contains:Wt,is:$.is},Mt=function(t){return z.fromDom(t.dom().ownerDocument)},Lt=function(t){var e=t.dom();return c.from(e.parentNode).map(z.fromDom)},qt=function(t){var e=t.dom();return c.from(e.previousSibling).map(z.fromDom)},Ft=function(t){var e=t.dom();return c.from(e.nextSibling).map(z.fromDom)},zt=function(t){var e=t.dom();return x.map(e.childNodes,z.fromDom)},jt=function(t,e){var n=t.dom().childNodes;return c.from(n[e]).map(z.fromDom)},Ht=B.immutable("element","offset"),Vt={owner:Mt,defaultView:function(t){var e=t.dom().ownerDocument.defaultView;return z.fromDom(e)},documentElement:function(t){var e=Mt(t);return z.fromDom(e.dom().documentElement)},parent:Lt,findIndex:function(t){return Lt(t).bind(function(e){var n=zt(e);return x.findIndex(n,function(e){return _t.eq(t,e)})})},parents:function(t,e){for(var r=N.isFunction(e)?e:n.constant(!1),o=t.dom(),i=[];null!==o.parentNode&&void 0!==o.parentNode;){var u=o.parentNode,a=z.fromDom(u);if(i.push(a),!0===r(a))break;o=u}return i},siblings:function(t){return Lt(t).map(zt).map(function(e){return x.filter(e,function(e){return!_t.eq(t,e)})}).getOr([])},prevSibling:qt,offsetParent:function(t){var e=t.dom();return c.from(e.offsetParent).map(z.fromDom)},prevSiblings:function(t){return x.reverse(K(t,qt))},nextSibling:Ft,nextSiblings:function(t){return K(t,Ft)},children:zt,child:jt,firstChild:function(t){return jt(t,0)},lastChild:function(t){return jt(t,t.dom().childNodes.length-1)},childNodesCount:function(t){return t.dom().childNodes.length},hasChildNodes:function(t){return t.dom().hasChildNodes()},leaf:function(t,e){var n=zt(t);return n.length>0&&e<n.length?Ht(n[e],0):Ht(t,e)}},Ut=function(t,e,n){return x.bind(Vt.children(t),function(t){return $.is(t,e)?n(t)?[t]:[]:Ut(t,e,n)})},Gt={firstLayer:function(t,e){return Ut(t,e,n.constant(!0))},filterFirstLayer:Ut},Xt=function(t){return t.dom().nodeName.toLowerCase()},Yt=function(t){return t.dom().nodeType},$t=function(t){return function(e){return Yt(e)===t}},Kt=$t(V),Jt=$t(U),Qt=$t(H),Zt={name:Xt,type:Yt,value:function(t){return t.dom().nodeValue},isElement:Kt,isText:Jt,isDocument:Qt,isComment:function(t){return Yt(t)===j||"#comment"===Xt(t)}},te=function(t,e,n){if(!(N.isString(n)||N.isBoolean(n)||N.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},ee=function(t,e,n){te(t.dom(),e,n)},ne=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},re=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},oe={clone:function(t){return x.foldl(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},set:ee,setAll:function(t,e){var n=t.dom();A.each(e,function(t,e){te(n,e,t)})},get:ne,has:re,remove:function(t,e){t.dom().removeAttribute(e)},hasNone:function(t){var e=t.dom().attributes;return void 0===e||null===e||0===e.length},transfer:function(t,e,n){Zt.isElement(t)&&Zt.isElement(e)&&x.each(n,function(n){o=e,re(r=t,i=n)&&!re(o,i)&&ee(o,i,ne(r,i));var r,o,i})}},ie=ot(function(){return ue(z.fromDom(document))}),ue=function(t){var e=t.dom().body;if(null===e||void 0===e)throw"Body is not available yet";return z.fromDom(e)},ae={body:ie,getBody:ue,inBody:function(t){var e=Zt.isText(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)}},ce=function(t,e){var n=[];return x.each(Vt.children(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(ce(t,e))}),n},le={all:function(t){return ce(ae.body(),t)},ancestors:function(t,e,n){return x.filter(Vt.parents(t,n),e)},siblings:function(t,e){return x.filter(Vt.siblings(t),e)},children:function(t,e){return x.filter(Vt.children(t),e)},descendants:ce},se={all:function(t){return $.all(t)},ancestors:function(t,e,n){return le.ancestors(t,function(t){return $.is(t,e)},n)},siblings:function(t,e){return le.siblings(t,function(t){return $.is(t,e)})},children:function(t,e){return le.children(t,function(t){return $.is(t,e)})},descendants:function(t,e){return $.all(e,t)}};function fe(t,e,n,r,o){return t(n,r)?c.some(n):N.isFunction(o)&&o(n)?c.none():e(n,r,o)}var de=function(t,e,r){for(var o=t.dom(),i=N.isFunction(r)?r:n.constant(!1);o.parentNode;){o=o.parentNode;var u=z.fromDom(o);if(e(u))return c.some(u);if(i(u))break}return c.none()},me=function(t,e){return x.find(t.dom().childNodes,n.compose(e,z.fromDom)).map(z.fromDom)},ge=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(z.fromDom(t.childNodes[r])))return c.some(z.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return c.none()};return n(t.dom())},pe={first:function(t){return ge(ae.body(),t)},ancestor:de,closest:function(t,e,n){return fe(function(t){return e(t)},de,t,e,n)},sibling:function(t,e){var n=t.dom();return n.parentNode?me(z.fromDom(n.parentNode),function(n){return!_t.eq(t,n)&&e(n)}):c.none()},child:me,descendant:ge},he=function(t,e,n){return pe.ancestor(t,function(t){return $.is(t,e)},n)},ve={first:function(t){return $.one(t)},ancestor:he,sibling:function(t,e){return pe.sibling(t,function(t){return $.is(t,e)})},child:function(t,e){return pe.child(t,function(t){return $.is(t,e)})},descendant:function(t,e){return $.one(e,t)},closest:function(t,e,n){return fe($.is,he,t,e,n)}},be=function(t,e,r){var o=void 0!==r?r:n.constant(!1);return o(e)?c.none():x.contains(t,Zt.name(e))?c.some(e):ve.ancestor(e,t.join(","),function(t){return $.is(t,"table")||o(t)})},we=function(t,e){return Vt.parent(e).map(function(e){return se.children(e,t)})},ye=function(t,e){return parseInt(oe.get(t,e),10)},xe={cell:function(t,e){return be(["td","th"],t,e)},firstCell:function(t){return ve.descendant(t,"th,td")},cells:function(t){return Gt.firstLayer(t,"th,td")},neighbourCells:n.curry(we,"th,td"),table:function(t,e){return ve.closest(t,"table",e)},row:function(t,e){return be(["tr"],t,e)},rows:function(t){return Gt.firstLayer(t,"tr")},notCell:function(t,e){return be(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:n.curry(we,"tr"),attr:ye,grid:function(t,e,n){var r=ye(t,e),o=ye(t,n);return q.grid(r,o)}},Se=function(t){var e=xe.rows(t);return x.map(e,function(t){var e=t,n=Vt.parent(e).bind(function(t){var e=Zt.name(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}),r=x.map(xe.cells(t),function(t){var e=oe.has(t,"rowspan")?parseInt(oe.get(t,"rowspan"),10):1,n=oe.has(t,"colspan")?parseInt(oe.get(t,"colspan"),10):1;return q.detail(t,e,n)});return q.rowdata(e,r,n)})},Ce=function(t,e){return x.map(t,function(t){var n=x.map(xe.cells(t),function(t){var e=oe.has(t,"rowspan")?parseInt(oe.get(t,"rowspan"),10):1,n=oe.has(t,"colspan")?parseInt(oe.get(t,"colspan"),10):1;return q.detail(t,e,n)});return q.rowdata(t,n,e.section())})},Re=function(t,e){return t+","+e},Te=function(t,e){var n=x.bind(t.all(),function(t){return t.cells()});return x.filter(n,e)},De={generate:function(t){var e={},r=[],o=t.length,i=0;x.each(t,function(t,n){var o=[];x.each(t.cells(),function(t,r){for(var u=0;void 0!==e[Re(n,u)];)u++;for(var a=q.extended(t.element(),t.rowspan(),t.colspan(),n,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var s=u+c,f=Re(n+l,s);e[f]=a,i=Math.max(i,s+1)}o.push(a)}),r.push(q.rowdata(t.element(),o,t.section()))});var u=q.grid(o,i);return{grid:n.constant(u),access:n.constant(e),all:n.constant(r)}},getAt:function(t,e,n){var r=t.access()[Re(e,n)];return void 0!==r?c.some(r):c.none()},findItem:function(t,e,n){var r=Te(t,function(t){return n(e,t.element())});return r.length>0?c.some(r[0]):c.none()},filterItems:Te,justCells:function(t){var e=x.map(t.all(),function(t){return t.cells()});return x.flatten(e)}},Ae={isSupported:function(t){return void 0!==t.style}},ke=function(t,e,n){if(!N.isString(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);Ae.isSupported(t)&&t.style.setProperty(e,n)},Ne=function(t,e){Ae.isSupported(t)&&t.style.removeProperty(e)},Oe=function(t,e,n){var r=t.dom();ke(r,e,n)},Ee=function(t,e){return Ae.isSupported(t)?t.style.getPropertyValue(e):""},Be=function(t,e){var n=t.dom(),r=Ee(n,e);return c.from(r).filter(function(t){return t.length>0})},Ie={copy:function(t,e){var n=t.dom(),r=e.dom();Ae.isSupported(n)&&Ae.isSupported(r)&&(r.style.cssText=n.style.cssText)},set:Oe,preserve:function(t,e){var n=oe.get(t,"style"),r=e(t);return(void 0===n?oe.remove:oe.set)(t,"style",n),r},setAll:function(t,e){var n=t.dom();A.each(e,function(t,e){ke(n,e,t)})},setOptions:function(t,e){var n=t.dom();A.each(e,function(t,e){t.fold(function(){Ne(n,e)},function(t){ke(n,e,t)})})},remove:function(t,e){var n=t.dom();Ne(n,e),oe.has(t,"style")&&""===Dt.trim(oe.get(t,"style"))&&oe.remove(t,"style")},get:function(t,e){var n=t.dom(),r=window.getComputedStyle(n).getPropertyValue(e),o=""!==r||ae.inBody(t)?r:Ee(n,e);return null===o?void 0:o},getRaw:Be,getAllRaw:function(t){var e={},n=t.dom();if(Ae.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);e[o]=n.style[o]}return e},isValidValue:function(t,e,n){var r=z.fromTag(t);return Oe(r,e,n),Be(r,e).isSome()},reflow:function(t){return t.dom().offsetWidth},transfer:function(t,e,n){Zt.isElement(t)&&Zt.isElement(e)&&x.each(n,function(n){r=e,Be(t,o=n).each(function(t){Be(r,o).isNone()&&Oe(r,o,t)});var r,o})}},Pe=function(t,e){Vt.parent(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})},We=function(t,e){t.dom().appendChild(e.dom())},_e={before:Pe,after:function(t,e){Vt.nextSibling(t).fold(function(){Vt.parent(t).each(function(t){We(t,e)})},function(t){Pe(t,e)})},prepend:function(t,e){Vt.firstChild(t).fold(function(){We(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},append:We,appendAt:function(t,e,n){Vt.child(t,n).fold(function(){We(t,e)},function(t){Pe(t,e)})},wrap:function(t,e){Pe(t,e),We(e,t)}},Me={before:function(t,e){x.each(e,function(e){_e.before(t,e)})},after:function(t,e){x.each(e,function(n,r){var o=0===r?t:e[r-1];_e.after(o,n)})},prepend:function(t,e){x.each(e.slice().reverse(),function(e){_e.prepend(t,e)})},append:function(t,e){x.each(e,function(e){_e.append(t,e)})}},Le=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},qe={empty:function(t){t.dom().textContent="",x.each(Vt.children(t),function(t){Le(t)})},remove:Le,unwrap:function(t){var e=Vt.children(t);e.length>0&&Me.before(t,e),Le(t)}},Fe=B.immutable("minRow","minCol","maxRow","maxCol"),ze=function(t,e,n){var r=t[n].element(),o=z.fromTag("td");_e.append(o,z.fromTag("br")),(e?_e.append:_e.prepend)(r,o)},je=function(t,e){var n=function(t){return $.is(t.element(),e)},r=Se(t),o=De.generate(r),i=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return A.each(t.access(),function(t){if(e(t)){var n=t.row(),a=n+t.rowspan()-1,c=t.column(),l=c+t.colspan()-1;n<r?r=n:a>i&&(i=a),c<o?o=c:l>u&&(u=l)}}),Fe(r,o,i,u)}(o,n),u="th:not("+e+"),td:not("+e+")",a=Gt.filterFirstLayer(t,"th,td",function(t){return $.is(t,u)});return x.each(a,qe.remove),function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol()||(De.getAt(e,u,c).filter(r).isNone()?ze(t,a,u):a=!0)}(r,o,i,n),function(t,e){var n=x.filter(Gt.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});x.each(n,qe.remove),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||x.each(Gt.firstLayer(t,"th,td"),function(t){oe.remove(t,"rowspan"),oe.remove(t,"colspan")}),oe.remove(t,"width"),oe.remove(t,"height"),Ie.remove(t,"width"),Ie.remove(t,"height")}(t,i),t},He=function(t,e){return z.fromDom(t.dom().cloneNode(e))},Ve=function(t){return He(t,!0)},Ue=function(t,e){var n=z.fromTag(e),r=oe.clone(t);return oe.setAll(n,r),n},Ge=function(t){return He(t,!1)},Xe=Ve,Ye=function(t,e){var n=Ue(t,e),r=Vt.children(Ve(t));return Me.append(n,r),n},$e=function(t,e){var n=function(e){return t(e)?c.from(e.dom().nodeValue):c.none()},r=It.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return n(t)}catch(t){return c.none()}}:n;return{get:function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(Zt.isText,"text"),Ke={get:function(t){return $e.get(t)},getOption:function(t){return $e.getOption(t)},set:function(t,e){$e.set(t,e)}},Je=function(t){return"img"===Zt.name(t)?1:Ke.getOption(t).fold(function(){return Vt.children(t).length},function(t){return t.length})},Qe=["img","br"],Ze=Je,tn=function(t){var e;return e=t,Ke.getOption(e).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()||x.contains(Qe,Zt.name(t))},en=function(t,e){var n=function(t){for(var r=Vt.children(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return c.some(i);var u=n(i);if(u.isSome())return u}return c.none()};return n(t)},nn={first:function(t){return pe.descendant(t,tn)},last:function(t){return en(t,tn)}},rn=function(){var t=z.fromTag("td");return _e.append(t,z.fromTag("br")),t},on=function(t,e,n){var r=Ye(t,e);return A.each(n,function(t,e){null===t?oe.remove(r,e):oe.set(r,e,t)}),r},un=function(t){return t},an=function(t){return function(){return z.fromTag("tr",t.dom())}},cn={cellOperations:function(t,e,n){return{row:an(e),cell:function(e){var r,o,i,u=Vt.owner(e.element()),a=z.fromTag(Zt.name(e.element()),u.dom()),c=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),l=c.length>0?(r=e.element(),o=a,i=c,nn.first(r).map(function(t){var e=i.join(","),n=se.ancestors(t,e,function(t){return _t.eq(t,r)});return x.foldr(n,function(t,e){var n=Ge(e);return _e.append(t,n),n},o)}).getOr(o)):a;return _e.append(l,z.fromTag("br")),Ie.copy(e.element(),a),Ie.remove(a,"height"),1!==e.colspan()&&Ie.remove(e.element(),"width"),t(e.element(),a),a},replace:on,gap:rn}},paste:function(t){return{row:an(t),cell:rn,replace:un,gap:rn}}},ln=function(t,e){var n=(e||document).createElement("div");return n.innerHTML=t,Vt.children(z.fromDom(n))},sn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function fn(){return{up:n.constant({selector:ve.ancestor,closest:ve.closest,predicate:pe.ancestor,all:Vt.parents}),down:n.constant({selector:se.descendants,predicate:le.descendants}),styles:n.constant({get:Ie.get,getRaw:Ie.getRaw,set:Ie.set,remove:Ie.remove}),attrs:n.constant({get:oe.get,set:oe.set,remove:oe.remove,copyTo:function(t,e){var n=oe.clone(t);oe.setAll(e,n)}}),insert:n.constant({before:_e.before,after:_e.after,afterAll:Me.after,append:_e.append,appendAll:Me.append,prepend:_e.prepend,wrap:_e.wrap}),remove:n.constant({unwrap:qe.unwrap,remove:qe.remove}),create:n.constant({nu:z.fromTag,clone:function(t){return z.fromDom(t.dom().cloneNode(!1))},text:z.fromText}),query:n.constant({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:Vt.prevSibling,nextSibling:Vt.nextSibling}),property:n.constant({children:Vt.children,name:Zt.name,parent:Vt.parent,isText:Zt.isText,isComment:Zt.isComment,isElement:Zt.isElement,getText:Ke.get,setText:Ke.set,isBoundary:function(t){return!!Zt.isElement(t)&&("body"===Zt.name(t)||x.contains(sn,Zt.name(t)))},isEmptyTag:function(t){return!!Zt.isElement(t)&&x.contains(["br","img","hr","input"],Zt.name(t))}}),eq:_t.eq,is:_t.is}}B.immutable("left","right");var dn=function(t,e,n,r){var o=e(t,n);return x.foldr(r,function(n,r){var o=e(t,r);return mn(t,n,o)},o)},mn=function(t,e,r){return e.bind(function(e){return r.filter(n.curry(t.eq,e))})},gn=function(t,e,n){return n.length>0?dn(t,e,(r=n)[0],r.slice(1)):c.none();var r},pn=function(t,e){return n.curry(t.eq,e)},hn=function(t,e,r,o){var i=void 0!==o?o:n.constant(!1),u=[e].concat(t.up().all(e)),a=[r].concat(t.up().all(r)),c=function(t){return x.findIndex(t,i).fold(function(){return t},function(e){return t.slice(0,e+1)})},l=c(u),s=c(a),f=x.find(l,function(e){return x.exists(s,pn(t,e))});return{firstpath:n.constant(l),secondpath:n.constant(s),shared:n.constant(f)}},vn=hn,bn=function(t,e,n){return gn(t,e,n)},wn=function(t,e,n,r){return vn(t,e,n,r)},yn=fn(),xn=function(t,e){return bn(yn,function(e,n){return t(n)},e)},Sn=function(t,e,n){return wn(yn,t,e,n)},Cn=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},Rn=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Tn=function(t,e){for(var r=!0,o=n.curry(Cn,e),i=e.startRow();i<=e.finishRow();i++)for(var u=e.startCol();u<=e.finishCol();u++)r=r&&De.getAt(t,i,u).exists(o);return r?c.some(e):c.none()},Dn=function(t,e,n){var r=De.findItem(t,e,_t.eq),o=De.findItem(t,n,_t.eq);return r.bind(function(t){return o.map(function(e){return n=t,r=e,q.bounds(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r})})},An=Dn,kn=function(t,e,n){return Dn(t,e,n).bind(function(e){return Tn(t,e)})},Nn=function(t,e,n,r){return De.findItem(t,e,_t.eq).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return De.getAt(t,o+n,i+r).map(function(t){return t.element()})})},On=function(t,e,r){return An(t,e,r).map(function(e){var r=De.filterItems(t,n.curry(Rn,e));return x.map(r,function(t){return t.element()})})},En=function(t,e){return De.findItem(t,e,function(t,e){return _t.contains(e,t)}).bind(function(t){return t.element()})},Bn=function(t){var e=Se(t);return De.generate(e)},In=function(t,e,n){return xe.table(t).bind(function(r){var o=Bn(r);return Nn(o,t,e,n)})},Pn=function(t,e,n){var r=Bn(t);return On(r,e,n)},Wn=function(t,e,n,r,o){var i=Bn(t),u=_t.eq(t,n)?e:En(i,e),a=_t.eq(t,o)?r:En(i,r);return On(i,u,a)},_n=function(t,e,n){var r=Bn(t);return kn(r,e,n)},Mn=function(t,e){return ve.ancestor(t,"table")},Ln=B.immutableBag(["boxes","start","finish"],[]),qn=function(t,e,n){var r=function(t){return function(e){return n(e)||_t.eq(e,t)}};return _t.eq(t,e)?c.some(Ln({boxes:c.some([t]),start:t,finish:e})):Mn(t).bind(function(o){return Mn(e).bind(function(i){if(_t.eq(o,i))return c.some(Ln({boxes:Pn(o,t,e),start:t,finish:e}));if(_t.contains(o,i)){var u=(a=se.ancestors(e,"td,th",r(o))).length>0?a[a.length-1]:e;return c.some(Ln({boxes:Wn(o,t,o,e,i),start:t,finish:u}))}if(_t.contains(i,o)){var a,l=(a=se.ancestors(t,"td,th",r(i))).length>0?a[a.length-1]:t;return c.some(Ln({boxes:Wn(i,t,o,e,i),start:t,finish:l}))}return Sn(t,e).shared().bind(function(u){return ve.closest(u,"table",n).bind(function(n){var u=se.ancestors(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,l=se.ancestors(t,"td,th",r(n)),s=l.length>0?l[l.length-1]:t;return c.some(Ln({boxes:Wn(n,t,o,e,i),start:s,finish:a}))})})})})},Fn={identify:qn,retrieve:function(t,e){var n=se.descendants(t,e);return n.length>0?c.some(n):c.none()},shiftSelection:function(t,e,r,o,i){return(u=t,a=i,x.find(u,function(t){return $.is(t,a)})).bind(function(t){return In(t,e,r).bind(function(t){return e=t,r=o,ve.ancestor(e,"table").bind(function(t){return ve.descendant(t,r).bind(function(t){return qn(t,e).bind(function(t){return t.boxes().map(function(e){return{boxes:n.constant(e),start:n.constant(t.start()),finish:n.constant(t.finish())}})})})});var e,r})});var u,a},getEdges:function(t,e,r){return ve.descendant(t,e).bind(function(e){return ve.descendant(t,r).bind(function(t){return xn(Mn,[e,t]).map(function(r){return{first:n.constant(e),last:n.constant(t),table:n.constant(r)}})})})}},zn={retrieve:function(t,e){return Fn.retrieve(t,e)},retrieveBox:function(t,e,n){return Fn.getEdges(t,e,n).bind(function(e){var n=function(e){return _t.eq(t,e)},r=ve.ancestor(e.first(),"thead,tfoot,tbody,table",n),o=ve.ancestor(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return _t.eq(t,n)?_n(e.table(),e.first(),e.last()):c.none()})})})}},jn="data-mce-selected",Hn="data-mce-first-selected",Vn="data-mce-last-selected",Un={selected:n.constant(jn),selectedSelector:n.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:n.constant("[data-mce-selected]"),firstSelected:n.constant(Hn),firstSelectedSelector:n.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:n.constant(Vn),lastSelectedSelector:n.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},Gn=function(t){if(!N.isArray(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return x.each(t,function(r,o){var i=A.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!N.isArray(a))throw new Error("case arguments must be an array");e.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(t){var n=A.keys(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!x.forall(e,function(t){return x.contains(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[u].apply(null,r)},log:function(t){console.log(t,{constructors:e,constructor:u,params:r})}}}}),n},Xn=Gn([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Yn={cata:function(t,e,n,r){return t.fold(e,n,r)},none:Xn.none,multiple:Xn.multiple,single:Xn.single},$n=function(t,e){return Yn.cata(e.get(),n.constant([]),n.identity,n.constant([t]))},Kn=function(t,e){return Yn.cata(e.get(),c.none,function(e,r){return 0===e.length?c.none():zn.retrieveBox(t,Un.firstSelectedSelector(),Un.lastSelectedSelector()).bind(function(t){return e.length>1?c.some({bounds:n.constant(t),cells:n.constant(e)}):c.none()})},c.none)},Jn=function(t,e){var n=$n(t,e);return n.length>0&&x.forall(n,function(t){return oe.has(t,"rowspan")&&parseInt(oe.get(t,"rowspan"),10)>1||oe.has(t,"colspan")&&parseInt(oe.get(t,"colspan"),10)>1})?c.some(n):c.none()},Qn=$n,Zn=function(t){return{element:n.constant(t),mergable:c.none,unmergable:c.none,selection:n.constant([t])}},tr=B.immutable("element","clipboard","generators"),er={noMenu:Zn,forMenu:function(t,e,r){return{element:n.constant(r),mergable:n.constant(Kn(e,t)),unmergable:n.constant(Jn(r,t)),selection:n.constant(Qn(r,t))}},notCell:function(t){return Zn(t)},paste:tr,pasteRows:function(t,e,r,o,i){return{element:n.constant(r),mergable:c.none,unmergable:c.none,selection:n.constant(Qn(r,t)),clipboard:n.constant(o),generators:n.constant(i)}}},nr={registerEvents:function(t,e,r,o){t.on("BeforeGetContent",function(r){var o=function(e){r.preventDefault(),(n=e,xe.table(n[0]).map(Xe).map(function(t){return[je(t,Un.attributeSelector())]})).each(function(e){r.content=x.map(e,function(e){return n=e,t.selection.serializer.serialize(n.dom(),{});var n}).join("")});var n};!0===r.selection&&Yn.cata(e.get(),n.noop,o,n.noop)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&c.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(n){var i=z.fromDom(n);xe.table(i).bind(function(n){var u=x.filter(ln(e.content),function(t){return"meta"!==Zt.name(t)});if(1===u.length&&"table"===Zt.name(u[0])){e.preventDefault();var a=z.fromDom(t.getDoc()),c=cn.paste(a),l=er.paste(i,u[0],c);r.pasteCells(n,l).each(function(e){t.selection.setRng(e),t.focus(),o.clear(n)})}})})})}},rr={render:function(t,e,n,r){var o=z.fromTag("table");Ie.setAll(o,{"border-collapse":"collapse",width:"100%"}),oe.set(o,"border","1");var i=z.fromTag("tbody");_e.append(o,i);for(var u=[],a=0;a<t;a++){for(var c=z.fromTag("tr"),l=0;l<e;l++){var s=a<n||l<r?z.fromTag("th"):z.fromTag("td");l<r&&oe.set(s,"scope","row"),a<n&&oe.set(s,"scope","col"),_e.append(s,z.fromTag("br")),Ie.set(s,"width",100/e+"%"),_e.append(c,s)}u.push(c)}return Me.append(i,u),o}},or=function(t){return t.dom().innerHTML},ir=function(t){var e=z.fromTag("div"),n=z.fromDom(t.dom().cloneNode(!0));return _e.append(e,n),or(e)},ur=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},ar={insert:function(t,e,r){var o,i=rr.render(r,e,0,0);oe.set(i,"id","__mce");var u=ir(i);t.insertContent(u),o=t.dom.get("__mce"),t.dom.setAttrib(o,"id",null),t.$("tr",o).each(function(e,n){t.fire("newrow",{node:n}),t.$("th,td",n).each(function(e,n){t.fire("newcell",{node:n})})}),t.dom.setAttribs(o,t.settings.table_default_attributes||{}),t.dom.setStyles(o,t.settings.table_default_styles||{}),a=t,c=z.fromDom(o),ve.descendant(c,"td,th").each(n.curry(ur,a));var a,c;return o}};function cr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=Ie.get(n,t);return parseFloat(o)||0}return r},r=function(t,e){return x.foldl(e,function(e,n){var r=Ie.get(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,n){if(!N.isNumber(n)&&!n.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+n;var r=e.dom();Ae.isSupported(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return e>o?e-o:0}}}var lr=cr("height",function(t){return ae.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight}),sr=function(t){return lr.get(t)},fr=function(t){return lr.getOuter(t)},dr=cr("width",function(t){return t.dom().offsetWidth}),mr=function(t){return dr.get(t)},gr=function(t){return dr.getOuter(t)},pr=It.detect(),hr=function(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(Ie.get(t,e),n)},vr=function(t){return pr.browser.isIE()||pr.browser.isEdge()?function(t){var e=hr(t,"padding-top",0),n=hr(t,"padding-bottom",0),r=hr(t,"border-top-width",0),o=hr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===Ie.get(t,"box-sizing")?i:i-e-n-(r+o)}(t):hr(t,"height",sr(t))},br=/(\d+(\.\d+)?)(\w|%)*/,wr=/(\d+(\.\d+)?)%/,yr=/(\d+(\.\d+)?)px|em/,xr=function(t,e){Ie.set(t,"height",e+"px")},Sr=function(t,e,n,r){var o=parseInt(t,10);return Dt.endsWith(t,"%")&&"table"!==Zt.name(e)?function(t,e,n,r){var o=xe.table(t).map(function(t){var r=n(t);return Math.floor(e/100*r)}).getOr(e);return r(t,o),o}(e,o,n,r):o},Cr=function(t){var e,n=(e=t,Ie.getRaw(e,"height").getOrThunk(function(){return vr(e)+"px"}));return n?Sr(n,t,sr,xr):sr(t)},Rr=function(t,e){return oe.has(t,e)?parseInt(oe.get(t,e),10):1},Tr=function(t){return Ie.getRaw(t,"width").fold(function(){return c.from(oe.get(t,"width"))},function(t){return c.some(t)})},Dr=function(t,e){return t/e.pixelWidth()*100},Ar={percentageBasedSizeRegex:n.constant(wr),pixelBasedSizeRegex:n.constant(yr),setPixelWidth:function(t,e){Ie.set(t,"width",e+"px")},setPercentageWidth:function(t,e){Ie.set(t,"width",e+"%")},setHeight:xr,getPixelWidth:function(t,e){return Tr(t).fold(function(){var e=mr(t);return parseInt(e,10)},function(n){return function(t,e,n){if(yr.test(e)){var r=yr.exec(e);return parseInt(r[1],10)}if(wr.test(e)){var o=wr.exec(e),i=parseFloat(o[1]);return i/100*n.pixelWidth()}var u=mr(t);return parseInt(u,10)}(t,n,e)})},getPercentageWidth:function(t,e){return Tr(t).fold(function(){var n=mr(t),r=parseInt(n,10);return Dr(r,e)},function(n){return function(t,e,n){if(wr.test(e)){var r=wr.exec(e);return parseFloat(r[1])}var o=mr(t),i=parseInt(o,10);return Dr(i,n)}(t,n,e)})},getGenericWidth:function(t){return Tr(t).bind(function(t){if(br.test(t)){var e=br.exec(t);return c.some({width:n.constant(e[1]),unit:n.constant(e[3])})}return c.none()})},setGenericWidth:function(t,e,n){Ie.set(t,"width",e+n)},getHeight:function(t){return n="rowspan",Cr(e=t)/Rr(e,n);var e,n},getRawWidth:Tr},kr={halve:function(t,e){Ar.getGenericWidth(t).each(function(n){var r=n.width()/2;Ar.setGenericWidth(t,r,n.unit()),Ar.setGenericWidth(e,r,n.unit())})}},Nr=function(t,e){var r=e||z.fromDom(document.documentElement);return pe.ancestor(t,n.curry(_t.eq,r)).isSome()},Or=function(t){var e=t.dom();return e===e.window?t:Zt.isDocument(t)?e.defaultView||e.parentWindow:null},Er=function(t,e){return{left:n.constant(t),top:n.constant(e),translate:function(n,r){return Er(t+n,e+r)}}},Br=function(t,e){return void 0!==t?t:void 0!==e?e:0},Ir=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body,o=z.fromDom(n.documentElement);return r===e?Er(r.offsetLeft,r.offsetTop):Nr(t,o)?function(t){var e=t.getBoundingClientRect();return Er(e.left,e.top)}(e):Er(0,0)},Pr=function(t){var e=t.dom().ownerDocument,n=e.body,r=Or(z.fromDom(e)),o=e.documentElement,i=Br(r.pageYOffset,o.scrollTop),u=Br(r.pageXOffset,o.scrollLeft),a=Br(o.clientTop,n.clientTop),c=Br(o.clientLeft,n.clientLeft);return Ir(t).translate(u-c,i-a)},Wr=B.immutable("row","y"),_r=B.immutable("col","x"),Mr=function(t){return Pr(t).left()+gr(t)},Lr=function(t){return Pr(t).left()},qr=function(t,e){return _r(t,Lr(e))},Fr=function(t,e){return _r(t,Mr(e))},zr=function(t){return Pr(t).top()},jr=function(t,e,n){if(0===n.length)return[];var r=x.map(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},Hr={delta:n.identity,positions:n.curry(jr,function(t,e){return Wr(t,zr(e))},function(t,e){return Wr(t,zr(e)+fr(e))}),edge:zr},Vr={delta:n.identity,edge:Lr,positions:n.curry(jr,qr,Fr)},Ur={height:Hr,rtl:{delta:function(t,e){return-t},edge:Mr,positions:n.curry(jr,Fr,qr)},ltr:Vr},Gr={ltr:Ur.ltr,rtl:Ur.rtl};function Xr(t){var e=function(e){return t(e).isRtl()?Gr.rtl:Gr.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var Yr={getGridSize:function(t){var e=Se(t);return De.generate(e).grid()}},$r=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return $r(n())}}},Kr=function(t,e){return Jr(t,e,{validate:N.isFunction,label:"function"})},Jr=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return E.validateStrArr("required",e),E.checkDupes(e),function(r){var o=A.keys(r);x.forall(e,function(t){return x.contains(o,t)})||E.reqMessage(e,o),t(e,o);var i=x.filter(e,function(t){return!n.validate(r[t],t)});return i.length>0&&E.invalidTypeMessage(i,n.label),r}},Qr=n.noop,Zr={exactly:n.curry(Kr,function(t,e){var n=x.filter(e,function(e){return!x.contains(t,e)});n.length>0&&E.unsuppMessage(n)}),ensure:n.curry(Kr,Qr),ensureWith:n.curry(Jr,Qr)},to=function(t){var e=oe.has(t,"colspan")?parseInt(oe.get(t,"colspan"),10):1,r=oe.has(t,"rowspan")?parseInt(oe.get(t,"rowspan"),10):1;return{element:n.constant(t),colspan:n.constant(e),rowspan:n.constant(r)}},eo=Zr.exactly(["cell","row","replace","gap"]),no=function(t,e){eo(t);var n=$r(c.none()),r=void 0!==e?e:to,o=function(e){var n=r(e);return o=n,t.cell(o);var o},i=function(t){var e=o(t);return n.get().isNone()&&n.set(c.some(e)),u=c.some({item:t,replacement:e}),e},u=c.none();return{getOrInit:function(t,e){return u.fold(function(){return i(t)},function(n){return e(t,n.item)?n.replacement:i(t)})},cursor:n.get}},ro=function(t,e){return function(n){var r=$r(c.none());eo(n);var o=[],i=function(i){var u=n.replace(i,e,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(c.some(u)),u};return{replaceOrInit:function(t,e){return(n=t,r=e,x.find(o,function(t){return r(t.item,n)})).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)});var n,r},cursor:r.get}}},oo=function(t){eo(t);var e=$r(c.none());return{combine:function(r){return e.get().isNone()&&e.set(c.some(r)),function(){var e=t.cell({element:n.constant(r),colspan:n.constant(1),rowspan:n.constant(1)});return Ie.remove(e,"width"),Ie.remove(r,"width"),e}},cursor:e.get}},io=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],uo=function(t,e){var n=t.property().name(e);return x.contains(io,n)},ao=function(t,e){return x.contains(["br","img","hr","input"],t.property().name(e))},co=uo,lo=function(t,e){var n=t.property().name(e);return x.contains(["ol","ul"],n)},so=ao,fo=fn(),mo=function(t){return co(fo,t)},go=function(t){return lo(fo,t)},po=function(t){return so(fo,t)},ho=function(t){var e=function(t){return"br"===Zt.name(t)},n=function(t){return nn.last(t).bind(function(n){var r,o=(r=n,Vt.nextSibling(r).map(function(t){return!!mo(t)||(po(t)?"img"!==Zt.name(t):void 0)}).getOr(!1));return Vt.parent(n).map(function(r){return!0===o||(i=r,"li"===Zt.name(i)||pe.ancestor(i,go).isSome())||e(n)||mo(r)&&!_t.eq(t,r)?[]:[z.fromTag("br")];var i})}).getOr([])},r=function(){var r=x.bind(t,function(t){var r=Vt.children(t);return o=r,x.forall(o,function(t){return e(t)||Zt.isText(t)&&0===Ke.get(t).trim().length})?[]:r.concat(n(t));var o});return 0===r.length?[z.fromTag("br")]:r}();qe.empty(t[0]),Me.append(t[0],r)},vo=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=t(r[u],i[u]))}return r}},bo=vo(function(t,e){return N.isObject(t)&&N.isObject(e)?bo(t,e):e}),wo=vo(function(t,e){return e}),yo={deepMerge:bo,merge:wo},xo=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},So=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return c.none()},Co=function(t,e){return q.rowcells(e,t.section())},Ro=function(t,e){return t.cells()[e]},To={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return Co(t,u)},setCells:Co,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:Ro,getCellElement:function(t,e){return Ro(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=x.map(n,e);return q.rowcells(r,t.section())},cellLength:function(t){return t.cells().length}},Do=function(t,e){if(0===t.length)return 0;var n=t[0];return x.findIndex(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},Ao=function(t,e,r,o){var i,u,a,c,l=(i=t,u=e,i[u]).cells().slice(r),s=Do(l,o),f=(a=t,c=r,x.map(a,function(t){return To.getCell(t,c)})).slice(e),d=Do(f,o);return{colspan:n.constant(s),rowspan:n.constant(d)}},ko=function(t,e){var n=x.map(t,function(t,e){return x.map(t.cells(),function(t,e){return!1})});return x.map(t,function(r,o){var i=x.bind(r.cells(),function(r,i){if(!1===n[o][i]){var u=Ao(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[q.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return q.rowdetails(i,r.section())})},No=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=De.getAt(t,o,u).map(function(t){return q.elementnew(t.element(),n)}).getOrThunk(function(){return q.elementnew(e.gap(),!0)});i.push(a)}var c=q.rowcells(i,t.all()[o].section());r.push(c)}return r},Oo=function(t,e,n,r){n===r?oe.remove(t,e):oe.set(t,e,n)},Eo=function(t,e){var r=[],o=[],i=function(e,n){e.length>0?function(e,n){var i=ve.child(t,n).getOrThunk(function(){var e=z.fromTag(n,Vt.owner(t).dom());return _e.append(t,e),e});qe.empty(i);var u=x.map(e,function(t){t.isNew()&&r.push(t.element());var e=t.element();return qe.empty(e),x.each(t.cells(),function(t){t.isNew()&&o.push(t.element()),Oo(t.element(),"colspan",t.colspan(),1),Oo(t.element(),"rowspan",t.rowspan(),1),_e.append(e,t.element())}),e});Me.append(i,u)}(e,n):(i=n,ve.child(t,i).bind(qe.remove));var i},u=[],a=[],c=[];return x.each(e,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":a.push(t);break;case"tfoot":c.push(t)}}),i(u,"thead"),i(a,"tbody"),i(c,"tfoot"),{newRows:n.constant(r),newCells:n.constant(o)}},Bo=function(t){return x.map(t,function(t){var e=Ge(t.element());return x.each(t.cells(),function(t){var n=Xe(t.element());Oo(n,"colspan",t.colspan(),1),Oo(n,"rowspan",t.rowspan(),1),_e.append(e,n)}),e})},Io=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},Po=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},Wo=function(t,e){if(e<0||e>=t.length-1)return c.none();var n=t[e].fold(function(){var n=x.reverse(t.slice(0,e));return So(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return c.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return So(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return c.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},_o=function(t,e,n){var r=t();return x.find(r,e).orThunk(function(){return c.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},Mo=function(t){var e=t.grid(),r=Po(0,e.columns()),o=Po(0,e.rows());return x.map(r,function(e){return _o(function(){return x.bind(o,function(r){return De.getAt(t,r,e).filter(function(t){return t.column()===e}).fold(n.constant([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return De.getAt(t,0,e)})})},Lo=function(t){var e=t.grid(),r=Po(0,e.rows()),o=Po(0,e.columns());return x.map(r,function(e){return _o(function(){return x.bind(o,function(r){return De.getAt(t,e,r).filter(function(t){return t.row()===e}).fold(n.constant([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return De.getAt(t,e,0)})})},qo=function(t,e,n,r,o){var i=z.fromTag("div");return Ie.setAll(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),oe.setAll(i,{"data-column":t,role:"presentation"}),i},Fo=function(t,e,n,r,o){var i=z.fromTag("div");return Ie.setAll(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),oe.setAll(i,{"data-row":t,role:"presentation"}),i},zo=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},jo={resolve:zo("ephox-snooker").resolve},Ho=function(t,e){var n=oe.get(t,e);return void 0===n||""===n?[]:n.split(" ")},Vo=Ho,Uo=function(t,e,n){var r=Ho(t,e).concat([n]);oe.set(t,e,r.join(" "))},Go=function(t,e,n){var r=x.filter(Ho(t,e),function(t){return t!==n});r.length>0?oe.set(t,e,r.join(" ")):oe.remove(t,e)},Xo=function(t){return Vo(t,"class")},Yo=function(t,e){return Uo(t,"class",e)},$o=function(t,e){return Go(t,"class",e)},Ko=Xo,Jo=Yo,Qo=$o,Zo=function(t,e){x.contains(Xo(t),e)?$o(t,e):Yo(t,e)},ti=function(t){return void 0!==t.dom().classList},ei=function(t,e){return ti(t)&&t.dom().classList.contains(e)},ni={add:function(t,e){ti(t)?t.dom().classList.add(e):Jo(t,e)},remove:function(t,e){ti(t)?t.dom().classList.remove(e):Qo(t,e),0===(ti(n=t)?n.dom().classList:Ko(n)).length&&oe.remove(n,"class");var n},toggle:function(t,e){return ti(t)?t.dom().classList.toggle(e):Zo(t,e)},toggler:function(t,e){var n=ti(t),r=t.dom().classList;return function(t,e,n){var r=n||!1,o=function(){e(),r=!0},i=function(){t(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}(function(){n?r.remove(e):Qo(t,e)},function(){n?r.add(e):Jo(t,e)},ei(t,e))},has:ei},ri=jo.resolve("resizer-bar"),oi=jo.resolve("resizer-rows"),ii=jo.resolve("resizer-cols"),ui=function(t){var e=se.descendants(t.parent(),"."+ri);x.each(e,qe.remove)},ai=function(t,e,n){var r=t.origin();x.each(e,function(e,o){e.each(function(e){var o=n(r,e);ni.add(o,ri),_e.append(t.parent(),o)})})},ci=function(t,e,n,r,o,i){var u=Pr(e),a=n.length>0?o.positions(n,e):[];c=t,l=a,s=u,f=gr(e),ai(c,l,function(t,e){var n=Fo(e.row(),s.left()-t.left(),e.y()-t.top(),f,7);return ni.add(n,oi),n});var c,l,s,f,d=r.length>0?i.positions(r,e):[];m=t,g=d,p=u,h=fr(e),ai(m,g,function(t,e){var n=qo(e.col(),e.x()-t.left(),p.top()-t.top(),7,h);return ni.add(n,ii),n});var m,g,p,h},li=function(t,e){var n=se.descendants(t.parent(),"."+ri);x.each(n,e)},si={refresh:function(t,e,n,r){ui(t);var o=Se(e),i=De.generate(o),u=Lo(i),a=Mo(i);ci(t,e,u,a,n,r)},hide:function(t){li(t,function(t){Ie.set(t,"display","none")})},show:function(t){li(t,function(t){Ie.set(t,"display","block")})},destroy:ui,isRowBar:function(t){return ni.has(t,oi)},isColBar:function(t){return ni.has(t,ii)}},fi=function(t,e){return x.map(t,function(t){var n,r=(n=t.details(),So(n,function(t){return Vt.parent(t.element()).map(function(t){var e=Vt.parent(t).isNone();return q.elementnew(t,e)})}).getOrThunk(function(){return q.elementnew(e.row(),!0)}));return q.rowdatanew(r.element(),t.details(),t.section(),r.isNew())})},di=function(t,e){var n=ko(t,_t.eq);return fi(n,e)},mi=function(t,e){var n=x.flatten(x.map(t.all(),function(t){return t.cells()}));return x.find(n,function(t){return _t.eq(e,t.element())})},gi=function(t,e,r,o,i){return function(u,a,l,s,f){var d=Se(a),m=De.generate(d);return e(m,l).map(function(e){var r,o,u=(r=m,o=s,No(r,o,!1)),a=t(u,e,_t.eq,i(s)),c=di(a.grid(),s);return{grid:n.constant(c),cursor:a.cursor}}).fold(function(){return c.none()},function(t){var e=Eo(a,t.grid());return r(a,t.grid(),f),o(a),si.refresh(u,a,Ur.height,f),c.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},pi=di,hi=function(t,e){return xe.cell(e.element()).bind(function(e){return mi(t,e)})},vi=function(t,e){var n=x.map(e.selection(),function(e){return xe.cell(e).bind(function(e){return mi(t,e)})}),r=xo(n);return r.length>0?c.some(r):c.none()},bi=function(t,e){return xe.cell(e.element()).bind(function(n){return mi(t,n).map(function(t){return yo.merge(t,{generators:e.generators,clipboard:e.clipboard})})})},wi=function(t,e){var n=x.map(e.selection(),function(e){return xe.cell(e).bind(function(e){return mi(t,e)})}),r=xo(n);return r.length>0?c.some(yo.merge({cells:r},{generators:e.generators,clipboard:e.clipboard})):c.none()},yi=function(t,e){return e.mergable()},xi=function(t,e){return e.unmergable()},Si=function(t){return{is:function(e){return t===e},isValue:n.constant(!0),isError:n.constant(!1),getOr:n.constant(t),getOrThunk:n.constant(t),getOrDie:n.constant(t),or:function(e){return Si(t)},orThunk:function(e){return Si(t)},fold:function(e,n){return n(t)},map:function(e){return Si(e(t))},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return c.some(t)}}},Ci=function(t){return{is:n.constant(!1),isValue:n.constant(!1),isError:n.constant(!0),getOr:n.identity,getOrThunk:function(t){return t()},getOrDie:function(){return n.die(t)()},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Ci(t)},each:n.noop,bind:function(e){return Ci(t)},exists:n.constant(!1),forall:n.constant(!0),toOption:c.none}},Ri={value:Si,error:Ci},Ti=function(t,e){return x.map(t,function(){return q.elementnew(e.cell(),!0)})},Di=function(t,e,n){return t.concat(Io(e,function(e){return To.setCells(t[t.length-1],Ti(t[t.length-1].cells(),n))}))},Ai=function(t,e,n){return x.map(t,function(t){return To.setCells(t,t.cells().concat(Ti(Po(0,e),n)))})},ki=function(t,e,r){if(t.row()>=e.length||t.column()>To.cellLength(e[0]))return Ri.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var o=e.slice(t.row()),i=o[0].cells().slice(t.column()),u=To.cellLength(r[0]),a=r.length;return Ri.value({rowDelta:n.constant(o.length-a),colDelta:n.constant(i.length-u)})},Ni=function(t,e){var r=To.cellLength(t[0]),o=To.cellLength(e[0]);return{rowDelta:n.constant(0),colDelta:n.constant(r-o)}},Oi=function(t,e,r){var o=e.colDelta()<0?Ai:n.identity;return(e.rowDelta()<0?Di:n.identity)(o(t,Math.abs(e.colDelta()),r),Math.abs(e.rowDelta()),r)},Ei=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)To.mutateCell(t[o],i,q.elementnew(r(),!1));return t},Bi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<To.cellLength(t[0]);u++){var a=n(To.getCellElement(t[i],u),e);!0===a&&!1===o?To.mutateCell(t[i],u,q.elementnew(r(),!0)):!0===a&&(o=!1)}return t},Ii=function(t,e,n,r){if(e>0&&e<t.length){var o=t[e-1].cells(),i=(u=o,a=n,x.foldl(u,function(t,e){return x.exists(t,function(t){return a(t.element(),e.element())})?t:t.concat([e])},[]));x.each(i,function(o){for(var i=c.none(),u=e;u<t.length;u++)for(var a=0;a<To.cellLength(t[0]);a++){var l=t[u].cells()[a];n(l.element(),o.element())&&(i.isNone()&&(i=c.some(r())),i.each(function(e){To.mutateCell(t[u],a,q.elementnew(e,!0))}))}})}var u,a;return t},Pi=function(t,e,r,o){var i=To.getCell(t[e],r),u=n.curry(o,i.element()),a=t[e];return t.length>1&&To.cellLength(a)>1&&(r>0&&u(To.getCellElement(a,r-1))||r<a.length-1&&u(To.getCellElement(a,r+1))||e>0&&u(To.getCellElement(t[e-1],r))||e<t.length-1&&u(To.getCellElement(t[e+1],r)))},Wi=function(t,e,n,r,o){return ki(t,e,n).map(function(i){var u=Oi(e,i,r);return function(t,e,n,r,o){for(var i=t.row(),u=t.column(),a=i+n.length,c=u+To.cellLength(n[0]),l=i;l<a;l++)for(var s=u;s<c;s++){Pi(e,l,s,o)&&Bi(e,To.getCellElement(e[l],s),o,r.cell);var f=To.getCellElement(n[l-i],s-u),d=r.replace(f);To.mutateCell(e[l],s,q.elementnew(d,!0))}return e}(t,u,n,r,o)})},_i=function(t,e,n,r,o){Ii(e,t,o,r.cell);var i=Ni(n,e),u=Oi(n,i,r),a=Ni(e,u),c=Oi(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Mi=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=To.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(To.getCellElement(t[e-1],i),To.getCellElement(t[e],i))?To.getCell(t[e],i):q.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Li=function(t,e,n,r,o){return x.map(t,function(t){var i=e>0&&e<To.cellLength(t)&&r(To.getCellElement(t,e-1),To.getCellElement(t,e))?To.getCell(t,e):q.elementnew(o(To.getCellElement(t,n),r),!0);return To.addCell(t,e,i)})},qi=function(t,e,n,r,o){var i=n+1;return x.map(t,function(t,u){var a=u===e?q.elementnew(o(To.getCellElement(t,n),r),!0):To.getCell(t,n);return To.addCell(t,i,a)})},Fi=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=To.mapCells(t[e],function(t,e){return e===n?q.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},zi=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},ji=function(t,e,n){var r=x.map(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return q.rowcells(r,t.section())});return x.filter(r,function(t){return t.cells().length>0})},Hi=function(t,e,n,r){return x.map(t,function(t){return To.mapCells(t,function(t){return o=t,x.exists(e,function(t){return n(o.element(),t.element())})?q.elementnew(r(t.element(),n),!0):t;var o})})},Vi=function(t,e,n,r){return void 0!==To.getCellElement(t[e],n)&&e>0&&r(To.getCellElement(t[e-1],n),To.getCellElement(t[e],n))},Ui=function(t,e,n){return e>0&&n(To.getCellElement(t,e-1),To.getCellElement(t,e))},Gi=function(t,e,n,r){var o=x.bind(t,function(r,o){return Vi(t,o,e,n)||Ui(r,e,n)?[]:[To.getCell(r,e)]});return Hi(t,o,n,r)},Xi=function(t,e,n,r){var o=t[e],i=x.bind(o.cells(),function(r,i){return Vi(t,e,i,n)||Ui(o,i,n)?[]:[r]});return Hi(t,i,n,r)},Yi=function(t){return{fold:t}},$i=function(){return Yi(function(t,e,n,r,o){return t()})},Ki=function(t){return Yi(function(e,n,r,o,i){return n(t)})},Ji=function(t,e){return Yi(function(n,r,o,i,u){return o(t,e)})},Qi=function(t,e,n){return Yi(function(r,o,i,u,a){return u(t,e,n)})},Zi=function(t,e){return Yi(function(n,r,o,i,u){return u(t,e)})},tu=function(t,e,r,o){var i,u,a=t.slice(0),c=(i=t,u=e,0===i.length?$i():1===i.length?Ki(0):0===u?Ji(0,1):u===i.length-1?Zi(u-1,u):u>0&&u<i.length-1?Qi(u-1,u,u+1):$i()),l=function(t){return x.map(t,n.constant(0))},s=n.constant(l(a)),f=function(t,e){if(r>=0){var n=Math.max(o.minCellWidth(),a[e]-r);return l(a.slice(0,t)).concat([r,n-a[e]]).concat(l(a.slice(e+1)))}var i=Math.max(o.minCellWidth(),a[t]+r),u=a[t]-i;return l(a.slice(0,t)).concat([i-a[t],u]).concat(l(a.slice(e+1)))},d=f;return c.fold(s,function(t){return o.singleColumnWidth(a[t],r)},d,function(t,e,n){return f(e,n)},function(t,e){if(r>=0)return l(a.slice(0,e)).concat([r]);var n=Math.max(o.minCellWidth(),a[e]+r);return l(a.slice(0,e)).concat([n-a[e]])})},eu=function(t,e){return oe.has(t,e)&&parseInt(oe.get(t,e),10)>1},nu={hasColspan:function(t){return eu(t,"colspan")},hasRowspan:function(t){return eu(t,"rowspan")},minWidth:n.constant(10),minHeight:n.constant(10),getInt:function(t,e){return parseInt(Ie.get(t,e),10)}},ru=function(t,e,n){return Ie.getRaw(t,e).fold(function(){return n(t)+"px"},function(t){return t})},ou=function(t){return ru(t,"width",Ar.getPixelWidth)},iu=function(t){return ru(t,"height",Ar.getHeight)},uu=function(t,e,r,o,i){var u=Mo(t),a=x.map(u,function(t){return t.map(e.edge)});return x.map(u,function(t,e){return t.filter(n.not(nu.hasColspan)).fold(function(){var t=Wo(a,e);return o(t)},function(t){return r(t,i)})})},au=function(t){return t.map(function(t){return t+"px"}).getOr("")},cu=function(t,e,r,o){var i=Lo(t),u=x.map(i,function(t){return t.map(e.edge)});return x.map(i,function(t,e){return t.filter(n.not(nu.hasRowspan)).fold(function(){var t=Wo(u,e);return o(t)},function(t){return r(t)})})},lu={getRawWidths:function(t,e){return uu(t,e,ou,au)},getPixelWidths:function(t,e,n){return uu(t,e,Ar.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(t,e,n){return uu(t,e,Ar.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},getPixelHeights:function(t,e){return cu(t,e,Ar.getHeight,function(t){return t.getOrThunk(nu.minHeight)})},getRawHeights:function(t,e){return cu(t,e,iu,au)}},su=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},fu=function(t,e){var r=De.justCells(t);return x.map(r,function(t){var r=su(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:n.constant(r),colspan:t.colspan}})},du=function(t,e){var r=De.justCells(t);return x.map(r,function(t){var r=su(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:n.constant(r),rowspan:t.rowspan}})},mu=function(t,e){return x.map(t.all(),function(t,r){return{element:t.element,height:n.constant(e[r])}})},gu=function(t){var e=parseInt(t,10),r=n.identity;return{width:n.constant(e),pixelWidth:n.constant(e),getWidths:lu.getPixelWidths,getCellDelta:r,singleColumnWidth:function(t,e){return[Math.max(nu.minWidth(),t+e)-t]},minCellWidth:nu.minWidth,setElementWidth:Ar.setPixelWidth,setTableWidth:function(t,e,n){var r=x.foldr(e,function(t,e){return t+e},0);Ar.setPixelWidth(t,r)}}},pu=function(t,e){if(Ar.percentageBasedSizeRegex().test(e))return function(t,e){var r=parseFloat(t),o=mr(e);return{width:n.constant(r),pixelWidth:n.constant(o),getWidths:lu.getPercentageWidths,getCellDelta:function(t){return t/o*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return nu.minWidth()/o*100},setElementWidth:Ar.setPercentageWidth,setTableWidth:function(t,e,n){var o=r+n;Ar.setPercentageWidth(t,o)}}}(Ar.percentageBasedSizeRegex().exec(e)[1],t);if(Ar.pixelBasedSizeRegex().test(e)){var r=Ar.pixelBasedSizeRegex().exec(e);return gu(r[1])}var o=mr(t);return gu(o)},hu=function(t){return Ar.getRawWidth(t).fold(function(){var e=mr(t);return gu(e)},function(e){return pu(t,e)})},vu=function(t){return De.generate(t)},bu=function(t){var e=Se(t);return vu(e)},wu={adjustWidth:function(t,e,n,r){var o=hu(t),i=o.getCellDelta(e),u=bu(t),a=o.getWidths(u,r,o),c=tu(a,n,i,o),l=x.map(c,function(t,e){return t+a[e]}),s=fu(u,l);x.each(s,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},adjustHeight:function(t,e,n,r){var o=bu(t),i=lu.getPixelHeights(o,r),u=x.map(i,function(t,r){return n===r?Math.max(e+t,nu.minHeight()):t}),a=du(o,u),c=mu(o,u);x.each(c,function(t){Ar.setHeight(t.element(),t.height())}),x.each(a,function(t){Ar.setHeight(t.element(),t.height())});var l,s=(l=u,x.foldr(l,function(t,e){return t+e},0));Ar.setHeight(t,s)},adjustWidthTo:function(t,e,n){var r=hu(t),o=vu(e),i=r.getWidths(o,n,r),u=fu(o,i);x.each(u,function(t){r.setElementWidth(t.element(),t.width())});var a=x.foldr(i,function(t,e){return e+t},0);u.length>0&&r.setElementWidth(t,a)}},yu=function(t){0===xe.cells(t).length&&qe.remove(t)},xu=B.immutable("grid","cursor"),Su=function(t,e,n){return Cu(t,e,n).orThunk(function(){return Cu(t,0,0)})},Cu=function(t,e,n){return c.from(t[e]).bind(function(t){return c.from(t.cells()[n]).bind(function(t){return c.from(t.element())})})},Ru=function(t,e,n){return xu(t,Cu(t,e,n))},Tu=function(t){return x.foldl(t,function(t,e){return x.exists(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},Du=function(t){return x.foldl(t,function(t,e){return x.exists(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},Au=function(t,e,n){var r=Ce(t,n),o=De.generate(r);return No(o,e,!0)},ku=wu.adjustWidthTo,Nu={insertRowBefore:gi(function(t,e,n,r){var o=e.row(),i=e.row(),u=Mi(t,i,o,n,r.getOrInit);return Ru(u,i,e.column())},hi,n.noop,n.noop,no),insertRowsBefore:gi(function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=Tu(e),a=x.foldl(u,function(t,e){return Mi(t,i,o,n,r.getOrInit)},t);return Ru(a,i,e[0].column())},vi,n.noop,n.noop,no),insertRowAfter:gi(function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Mi(t,i,o,n,r.getOrInit);return Ru(u,i,e.column())},hi,n.noop,n.noop,no),insertRowsAfter:gi(function(t,e,n,r){var o=Tu(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=x.foldl(o,function(t,e){return Mi(t,u,i,n,r.getOrInit)},t);return Ru(a,u,e[0].column())},vi,n.noop,n.noop,no),insertColumnBefore:gi(function(t,e,n,r){var o=e.column(),i=e.column(),u=Li(t,i,o,n,r.getOrInit);return Ru(u,e.row(),i)},hi,ku,n.noop,no),insertColumnsBefore:gi(function(t,e,n,r){var o=Du(e),i=o[0].column(),u=o[0].column(),a=x.foldl(o,function(t,e){return Li(t,u,i,n,r.getOrInit)},t);return Ru(a,e[0].row(),u)},vi,ku,n.noop,no),insertColumnAfter:gi(function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Li(t,i,o,n,r.getOrInit);return Ru(u,e.row(),i)},hi,ku,n.noop,no),insertColumnsAfter:gi(function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=Du(e),a=x.foldl(u,function(t,e){return Li(t,i,o,n,r.getOrInit)},t);return Ru(a,e[0].row(),i)},vi,ku,n.noop,no),splitCellIntoColumns:gi(function(t,e,n,r){var o=qi(t,e.row(),e.column(),n,r.getOrInit);return Ru(o,e.row(),e.column())},hi,ku,n.noop,no),splitCellIntoRows:gi(function(t,e,n,r){var o=Fi(t,e.row(),e.column(),n,r.getOrInit);return Ru(o,e.row(),e.column())},hi,n.noop,n.noop,no),eraseColumns:gi(function(t,e,n,r){var o=Du(e),i=ji(t,o[0].column(),o[o.length-1].column()),u=Su(i,e[0].row(),e[0].column());return xu(i,u)},vi,ku,yu,no),eraseRows:gi(function(t,e,n,r){var o=Tu(e),i=zi(t,o[0].row(),o[o.length-1].row()),u=Su(i,e[0].row(),e[0].column());return xu(i,u)},vi,n.noop,yu,no),makeColumnHeader:gi(function(t,e,n,r){var o=Gi(t,e.column(),n,r.replaceOrInit);return Ru(o,e.row(),e.column())},hi,n.noop,n.noop,ro("row","th")),unmakeColumnHeader:gi(function(t,e,n,r){var o=Gi(t,e.column(),n,r.replaceOrInit);return Ru(o,e.row(),e.column())},hi,n.noop,n.noop,ro(null,"td")),makeRowHeader:gi(function(t,e,n,r){var o=Xi(t,e.row(),n,r.replaceOrInit);return Ru(o,e.row(),e.column())},hi,n.noop,n.noop,ro("col","th")),unmakeRowHeader:gi(function(t,e,n,r){var o=Xi(t,e.row(),n,r.replaceOrInit);return Ru(o,e.row(),e.column())},hi,n.noop,n.noop,ro(null,"td")),mergeCells:gi(function(t,e,r,o){var i=e.cells();ho(i);var u=Ei(t,e.bounds(),r,n.constant(i[0]));return xu(u,c.from(i[0]))},yi,n.noop,n.noop,oo),unmergeCells:gi(function(t,e,n,r){var o=x.foldr(e,function(t,e){return Bi(t,e,n,r.combine(e))},t);return xu(o,c.from(e[0]))},xi,ku,n.noop,oo),pasteCells:gi(function(t,e,n,r){var o=function(t,e){var n=Se(t),r=De.generate(n);return No(r,e,!0)}(e.clipboard(),e.generators()),i=q.address(e.row(),e.column());return Wi(i,t,o,e.generators(),n).fold(function(){return xu(t,c.some(e.element()))},function(t){var n=Su(t,e.row(),e.column());return xu(t,n)})},bi,ku,n.noop,no),pasteRowsBefore:gi(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Au(e.clipboard(),e.generators(),o),a=_i(i,t,u,e.generators(),n),c=Su(a,e.cells[0].row(),e.cells[0].column());return xu(a,c)},wi,n.noop,n.noop,no),pasteRowsAfter:gi(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Au(e.clipboard(),e.generators(),o),a=_i(i,t,u,e.generators(),n),c=Su(a,e.cells[0].row(),e.cells[0].column());return xu(a,c)},wi,n.noop,n.noop,no)},Ou=function(t){return z.fromDom(t.getBody())},Eu={getBody:Ou,getIsRoot:function(t){return function(e){return _t.eq(e,Ou(t))}},addSizeSuffix:function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},removePxSuffix:function(t){return t?t.replace(/px$/,""):""}},Bu=function(t){return"rtl"===Ie.get(t,"direction")?"rtl":"ltr"},Iu={onDirection:function(t,e){return function(n){return"rtl"===Bu(n)?e:t}},getDirection:Bu},Pu={isRtl:n.constant(!1)},Wu={isRtl:n.constant(!0)},_u={directionAt:function(t){return"rtl"===Iu.getDirection(t)?Wu:Pu}};function Mu(t,e){var r,o=function(t){return"table"===Zt.name(Eu.getBody(t))};!1!==t.settings.table_clone_elements&&("string"==typeof t.settings.table_clone_elements?r=t.settings.table_clone_elements.split(/[ ,]/):Array.isArray(t.settings.table_clone_elements)&&(r=t.settings.table_clone_elements));var i=c.from(r),u=function(e,n,r,o){return function(u,a){var l=se.descendants(u,"td[data-mce-style],th[data-mce-style]");x.each(l,function(t){oe.remove(t,"data-mce-style")});var s=o(),f=z.fromDom(t.getDoc()),d=Xr(_u.directionAt),m=cn.cellOperations(r,f,i);return n(u)?e(s,u,a,m,d).bind(function(e){return x.each(e.newRows(),function(e){n=e,t.fire("newrow",{node:n.dom()}),n.dom();var n}),x.each(e.newCells(),function(e){n=e,t.fire("newcell",{node:n.dom()}),n.dom();var n}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):c.none()}};return{deleteRow:u(Nu.eraseRows,function(e){var n=Yr.getGridSize(e);return!1===o(t)||n.rows()>1},n.noop,e),deleteColumn:u(Nu.eraseColumns,function(e){var n=Yr.getGridSize(e);return!1===o(t)||n.columns()>1},n.noop,e),insertRowsBefore:u(Nu.insertRowsBefore,n.always,n.noop,e),insertRowsAfter:u(Nu.insertRowsAfter,n.always,n.noop,e),insertColumnsBefore:u(Nu.insertColumnsBefore,n.always,kr.halve,e),insertColumnsAfter:u(Nu.insertColumnsAfter,n.always,kr.halve,e),mergeCells:u(Nu.mergeCells,n.always,n.noop,e),unmergeCells:u(Nu.unmergeCells,n.always,n.noop,e),pasteRowsBefore:u(Nu.pasteRowsBefore,n.always,n.noop,e),pasteRowsAfter:u(Nu.pasteRowsAfter,n.always,n.noop,e),pasteCells:u(Nu.pasteCells,n.always,n.noop,e)}}var Lu=function(t,e,n){var r=Se(t),o=De.generate(r);return vi(o,e).map(function(t){var e=No(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=pi(e,n);return Bo(r)})},qu=tinymce.util.Tools.resolve("tinymce.util.Tools"),Fu=tinymce.util.Tools.resolve("tinymce.Env"),zu={applyAlign:function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},applyVAlign:function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},unApplyAlign:function(t,e){qu.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},unApplyVAlign:function(t,e){qu.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},getTDTHOverallStyle:function(t,e,n){var r;return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))}},ju=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===e.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Eu.addSizeSuffix(o.width):"",i.height=o.height?Eu.addSizeSuffix(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},Hu={createStyleForm:function(t){var e=function(){var e=t.settings.color_picker_callback;if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:n.curry(ju,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:n.curry(ju,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(t,e,n){var r=function(t,n){return n=n||[],qu.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},updateStyleField:ju,extractAdvancedStyles:function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r}};function Vu(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)Vu(t,e.children[o],n,r)}var Uu=function(t,e,n){var r,o,i=t.dom;Hu.updateStyleField(t,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact(function(){e||(e=ar.insert(t,o.cols||1,o.rows||1)),function(t,e,n){var r=t.dom,o={},i={};if(o.class=n.class,i.height=Eu.addSizeSuffix(n.height),r.getAttrib(e,"width")&&!t.settings.table_style_by_css?o.width=Eu.removePxSuffix(n.width):i.width=Eu.addSizeSuffix(n.width),t.settings.table_style_by_css?(i["border-width"]=Eu.addSizeSuffix(n.border),i["border-spacing"]=Eu.addSizeSuffix(n.cellspacing),qu.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):qu.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),t.settings.table_style_by_css&&e.children)for(var u=0;u<e.children.length;u++)Vu(r,e.children[u],{"border-width":Eu.addSizeSuffix(n.border),"border-color":n.borderColor,padding:Eu.addSizeSuffix(n.cellpadding)});n.style?qu.extend(i,r.parseStyle(n.style)):i=qu.extend({},r.parseStyle(r.getAttrib(e,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(e,o)}(t,e,o),(r=i.select("caption",e)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=Fu.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),zu.unApplyAlign(t,e),o.align&&zu.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},Gu=function(t,e){var r,o,i,u,a,c=t.dom,l={};!0===e?(r=c.getParent(t.selection.getStart(),"table"))&&(l=function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),cellspacing:n.getStyle(e,"border-spacing")||n.getAttrib(e,"cellspacing"),cellpadding:n.getAttrib(e,"data-mce-cell-padding")||n.getAttrib(e,"cellpadding")||zu.getTDTHOverallStyle(t.dom,e,"padding"),border:n.getAttrib(e,"data-mce-border")||n.getAttrib(e,"border")||zu.getTDTHOverallStyle(t.dom,e,"border"),borderColor:n.getAttrib(e,"data-mce-border-color"),caption:!!n.select("caption",e)[0],class:n.getAttrib(e,"class")};return qu.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_advtab&&qu.extend(r,Hu.extractAdvancedStyles(n,e)),r}(t,r)):(o={label:"Cols",name:"cols"},i={label:"Rows",name:"rows"}),t.settings.table_class_list&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),u={name:"class",type:"listbox",label:"Class",values:Hu.buildListItems(t.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),a={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==t.settings.table_appearance_options?[o,i,{label:"Width",name:"width",onchange:n.curry(Hu.updateStyleField,t)},{label:"Height",name:"height",onchange:n.curry(Hu.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[o,i,{label:"Width",name:"width",onchange:n.curry(Hu.updateStyleField,t)},{label:"Height",name:"height",onchange:n.curry(Hu.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},u]},!1!==t.settings.table_advtab?t.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},Hu.createStyleForm(t)],onsubmit:n.curry(Uu,t,r)}):t.windowManager.open({title:"Table properties",data:l,body:a,onsubmit:n.curry(Uu,t,r)})},Xu=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)};function Yu(t,e,n){var r,o=t.dom;function i(t,e,n){n&&o.setAttrib(t,e,n)}Hu.updateStyleField(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){qu.each(e,function(n){i(n,"scope",r.scope),i(n,"style",r.style),i(n,"class",r.class),u=n,a="height",(c=Eu.addSizeSuffix(r.height))&&o.setStyle(u,a,c);var u,a,c;r.type!==n.parentNode.nodeName.toLowerCase()&&Xu(t.dom,n,r.type),1===e.length&&zu.unApplyAlign(t,n),r.align&&zu.applyAlign(t,n,r.align)}),t.focus()})}var $u=function(t){var e,r,o,i,u,a,c=t.dom,l=[];e=c.getParent(t.selection.getStart(),"table"),r=c.getParent(t.selection.getStart(),"td,th"),qu.each(e.rows,function(t){qu.each(t.cells,function(e){if(c.getAttrib(e,"data-mce-selected")||e===r)return l.push(t),!1})}),(o=l[0])&&(u=l.length>1?{height:"",scope:"",class:"",align:"",type:o.parentNode.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.parentNode.nodeName.toLowerCase(),qu.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),!1!==t.settings.table_row_advtab&&qu.extend(r,Hu.extractAdvancedStyles(n,e)),r}(t,o),t.settings.table_row_class_list&&(i={name:"class",type:"listbox",label:"Class",values:Hu.buildListItems(t.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),a={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},i]},!1!==t.settings.table_row_advtab?t.windowManager.open({title:"Row properties",data:u,bodyType:"tabpanel",body:[{title:"General",type:"form",items:a},Hu.createStyleForm(t)],onsubmit:n.curry(Yu,t,l)}):t.windowManager.open({title:"Row properties",data:u,body:a,onsubmit:n.curry(Yu,t,l)}))},Ku=function(t,e,n){var r,o=t.dom;function i(t,e,n){n&&o.setAttrib(t,e,n)}function u(t,e,n){n&&o.setStyle(t,e,n)}Hu.updateStyleField(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){qu.each(e,function(n){i(n,"scope",r.scope),1===e.length?i(n,"style",r.style):(a=n,c=r.style,a.style.cssText+=";"+c);var a,c;i(n,"class",r.class),u(n,"width",Eu.addSizeSuffix(r.width)),u(n,"height",Eu.addSizeSuffix(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===e.length&&(zu.unApplyAlign(t,n),zu.unApplyVAlign(t,n)),r.align&&zu.applyAlign(t,n,r.align),r.valign&&zu.applyVAlign(t,n,r.valign)}),t.focus()})},Ju=function(t){var e,r,o,i=[];if(i=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!i.length&&e&&i.push(e),e=e||i[0]){r=i.length>1?{width:"",height:"",scope:"",class:"",align:"",style:"",type:e.nodeName.toLowerCase()}:function(t,e){var n=t.dom,r={width:n.getStyle(e,"width")||n.getAttrib(e,"width"),height:n.getStyle(e,"height")||n.getAttrib(e,"height"),scope:n.getAttrib(e,"scope"),class:n.getAttrib(e,"class")};return r.type=e.nodeName.toLowerCase(),qu.each("left center right".split(" "),function(n){t.formatter.matchNode(e,"align"+n)&&(r.align=n)}),qu.each("top middle bottom".split(" "),function(n){t.formatter.matchNode(e,"valign"+n)&&(r.valign=n)}),!1!==t.settings.table_cell_advtab&&qu.extend(r,Hu.extractAdvancedStyles(n,e)),r}(t,e),t.settings.table_cell_class_list&&(o={name:"class",type:"listbox",label:"Class",values:Hu.buildListItems(t.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:n.curry(Hu.updateStyleField,t)},{label:"Height",name:"height",onchange:n.curry(Hu.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},o]};!1!==t.settings.table_cell_advtab?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:r,body:[{title:"General",type:"form",items:u},Hu.createStyleForm(t)],onsubmit:n.curry(Ku,t,i)}):t.windowManager.open({title:"Cell properties",data:r,body:u,onsubmit:n.curry(Ku,t,i)})}},Qu=qu.each,Zu=c.none(),ta={registerCommands:function(t,e,r,o){var i=Eu.getIsRoot(t),u=function(){return z.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},a=function(t){return xe.table(t,i)},l=function(e){var n=u();a(n).each(function(i){var u=er.forMenu(o,i,n);e(i,u).each(function(e){t.selection.setRng(e),t.focus(),r.clear(i)})})},s=function(e){var r=u();return a(r).bind(function(e){var i=z.fromDom(t.getDoc()),u=er.forMenu(o,e,r),a=cn.cellOperations(n.noop,i,c.none());return Lu(e,u,a)})},f=function(e){Zu.each(function(n){var i=x.map(n,function(t){return Xe(t)}),c=u();a(c).bind(function(n){var u=z.fromDom(t.getDoc()),a=cn.paste(u),l=er.pasteRows(o,n,c,i,a);e(n,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(n)})})})};Qu({mceTableSplitCells:function(){l(e.unmergeCells)},mceTableMergeCells:function(){l(e.mergeCells)},mceTableInsertRowBefore:function(){l(e.insertRowsBefore)},mceTableInsertRowAfter:function(){l(e.insertRowsAfter)},mceTableInsertColBefore:function(){l(e.insertColumnsBefore)},mceTableInsertColAfter:function(){l(e.insertColumnsAfter)},mceTableDeleteCol:function(){l(e.deleteColumn)},mceTableDeleteRow:function(){l(e.deleteRow)},mceTableCutRow:function(t){Zu=s(),l(e.deleteRow)},mceTableCopyRow:function(t){Zu=s()},mceTablePasteRowBefore:function(t){f(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){f(e.pasteRowsAfter)},mceTableDelete:function(){var e=z.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));xe.table(e,i).filter(n.not(i)).each(function(e){var n=z.fromText("");_e.after(e,n),qe.remove(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})}},function(e,n){t.addCommand(n,e)}),Qu({mceInsertTable:n.curry(Gu,t),mceTableProps:n.curry(Gu,t,!0),mceTableRowProps:n.curry($u,t),mceTableCellProps:n.curry(Ju,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})},getClipboardRows:function(){return Zu.fold(function(){},function(t){return x.map(t,function(t){return t.dom()})})},setClipboardRows:function(t){var e=x.map(t,z.fromDom);Zu=c.from(e)}},ea={only:function(t){var e=c.from(t.dom().documentElement).map(z.fromDom).getOr(t);return{parent:n.constant(e),view:n.constant(t),origin:n.constant(Er(0,0))}},detached:function(t,e){var r=n.curry(Pr,e);return{parent:n.constant(e),view:n.constant(t),origin:r}},body:function(t,e){return{parent:n.constant(e),view:n.constant(t),origin:n.constant(Er(0,0))}}};function na(t){var e=B.immutable.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";n.push(t)},unbind:function(t){n=x.filter(n,function(e){return e!==t})},trigger:function(){var t=e.apply(null,arguments);x.each(n,function(e){e(t)})}}}var ra={create:function(t){return{registry:A.map(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:A.map(t,function(t){return t.trigger})}}},oa={mode:Zr.exactly(["compare","extract","mutate","sink"]),sink:Zr.exactly(["element","start","stop","destroy"]),api:Zr.exactly(["forceDrop","drop","move","delayDrop"])},ia={resolve:zo("ephox-dragster").resolve},ua=function(t,e){return function(r){if(t(r)){var o,i,u,a,c,l,s,f=z.fromDom(r.target),d=function(){r.stopPropagation()},m=function(){r.preventDefault()},g=n.compose(m,d),p=(o=f,i=r.clientX,u=r.clientY,a=d,c=m,l=g,s=r,{target:n.constant(o),x:n.constant(i),y:n.constant(u),stop:a,prevent:c,kill:l,raw:n.constant(s)});e(p)}}},aa=function(t,e,r,o,i){var u=ua(r,o);return t.dom().addEventListener(e,u,i),{unbind:n.curry(ca,t,e,u,i)}},ca=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},la=function(t,e,n,r){return aa(t,e,n,r,!1)},sa=function(t,e,n,r){return aa(t,e,n,r,!0)},fa=n.constant(!0),da={bind:function(t,e,n){return la(t,e,fa,n)},capture:function(t,e,n){return sa(t,e,fa,n)}},ma=oa.mode({compare:function(t,e){return Er(e.left()-t.left(),e.top()-t.top())},extract:function(t){return c.some(Er(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=yo.merge({layerClass:ia.resolve("blocker")},t),n=z.fromTag("div");return oe.set(n,"role","presentation"),Ie.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ni.add(n,ia.resolve("blocker")),ni.add(n,e.layerClass),{element:function(){return n},destroy:function(){qe.remove(n)}}}(e),r=da.bind(n.element(),"mousedown",t.forceDrop),o=da.bind(n.element(),"mouseup",t.drop),i=da.bind(n.element(),"mousemove",t.move),u=da.bind(n.element(),"mouseout",t.delayDrop);return oa.sink({element:n.element,start:function(t){_e.append(t,n.element())},stop:function(){qe.remove(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function ga(){var t=c.none(),e=ra.create({move:na(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){(function(e,n){var r=t.map(function(t){return e.compare(t,n)});return t=c.some(n),r})(r,n).each(function(t){e.trigger.move(t)})})},reset:function(){t=c.none()},events:e.registry}}function pa(){var t={onEvent:function(t,e){},reset:n.noop},e=ga(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(t,e){r.onEvent(t,e)},events:e.events}}var ha=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null,r=null},e)}}},va=function(t,e,n){var r=!1,o=ra.create({start:na([]),stop:na([])}),i=pa(),u=function(){l.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=ha(u,200);i.events.move.bind(function(n){e.mutate(t,n.info())});var c=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(r)return t.apply(null,e)}},l=e.sink(oa.api({forceDrop:u,drop:c(u),move:c(function(t,n){a.cancel(),i.onEvent(t,e)}),delayDrop:c(a.throttle)}),n);return{element:l.element,go:function(t){l.start(t),i.on(),o.trigger.start()},on:function(){r=!0},off:function(){r=!1},destroy:function(){l.destroy()},events:o.registry}},ba={transform:function(t,e){var n=void 0!==e?e:{},r=void 0!==n.mode?n.mode:ma;return va(t,r,e)}};function wa(){var t=ra.create({drag:na(["xDelta","yDelta","target"])}),e=c.none(),n=function(){var t=ra.create({drag:na(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind(function(n){e.each(function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)})}),{assign:function(t){e=c.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}}var ya={any:function(t){return ve.first(t).isSome()},ancestor:function(t,e,n){return ve.ancestor(t,e,n).isSome()},sibling:function(t,e){return ve.sibling(t,e).isSome()},child:function(t,e){return ve.child(t,e).isSome()},descendant:function(t,e){return ve.descendant(t,e).isSome()},closest:function(t,e,n){return ve.closest(t,e,n).isSome()}},xa=jo.resolve("resizer-bar-dragging");function Sa(t,e){var r=Ur.height,o=function(t,e,r){var o=wa(),i=ba.transform(o,{}),u=c.none(),a=function(t,e){return c.from(oe.get(t,e))};o.events.drag.bind(function(t){a(t.target(),"data-row").each(function(e){var n=nu.getInt(t.target(),"top");Ie.set(t.target(),"top",n+t.yDelta()+"px")}),a(t.target(),"data-column").each(function(e){var n=nu.getInt(t.target(),"left");Ie.set(t.target(),"left",n+t.xDelta()+"px")})});var l=function(t,e){return nu.getInt(t,e)-parseInt(oe.get(t,"data-initial-"+e),10)};i.events.stop.bind(function(){o.get().each(function(n){u.each(function(o){a(n,"data-row").each(function(t){var e=l(n,"top");oe.remove(n,"data-initial-top"),g.trigger.adjustHeight(o,e,parseInt(t,10))}),a(n,"data-column").each(function(t){var e=l(n,"left");oe.remove(n,"data-initial-left"),g.trigger.adjustWidth(o,e,parseInt(t,10))}),si.refresh(t,o,r,e)})})});var s=function(e,n){g.trigger.startAdjust(),o.assign(e),oe.set(e,"data-initial-"+n,parseInt(Ie.get(e,n),10)),ni.add(e,xa),Ie.set(e,"opacity","0.2"),i.go(t.parent())},f=da.bind(t.parent(),"mousedown",function(t){si.isRowBar(t.target())&&s(t.target(),"top"),si.isColBar(t.target())&&s(t.target(),"left")}),d=function(e){return _t.eq(e,t.view())},m=da.bind(t.view(),"mouseover",function(n){"table"===Zt.name(n.target())||ya.ancestor(n.target(),"table",d)?(u="table"===Zt.name(n.target())?c.some(n.target()):ve.ancestor(n.target(),"table",d)).each(function(n){si.refresh(t,n,r,e)}):ae.inBody(n.target())&&si.destroy(t)}),g=ra.create({adjustHeight:na(["table","delta","row"]),adjustWidth:na(["table","delta","column"]),startAdjust:na([])});return{destroy:function(){f.unbind(),m.unbind(),i.destroy(),si.destroy(t)},refresh:function(n){si.refresh(t,n,r,e)},on:i.on,off:i.off,hideBars:n.curry(si.hide,t),showBars:n.curry(si.show,t),events:g.registry}}(t,e,r),i=ra.create({beforeResize:na(["table"]),afterResize:na(["table"]),startDrag:na([])});return o.events.adjustHeight.bind(function(t){i.trigger.beforeResize(t.table());var e=r.delta(t.delta(),t.table());wu.adjustHeight(t.table(),e,t.row(),r),i.trigger.afterResize(t.table())}),o.events.startAdjust.bind(function(t){i.trigger.startDrag()}),o.events.adjustWidth.bind(function(t){i.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());wu.adjustWidth(t.table(),n,t.column(),e),i.trigger.afterResize(t.table())}),{on:o.on,off:o.off,hideBars:o.hideBars,showBars:o.showBars,destroy:o.destroy,events:i.registry}}var Ca={get:function(t,e){return t.inline?ea.body(Eu.getBody(t),function(){var t=z.fromTag("div");return Ie.setAll(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),_e.append(ae.body(),t),t}()):ea.only(z.fromDom(t.getDoc()))},remove:function(t,e){t.inline&&qe.remove(e.parent())}};function Ra(t){var e,n,r=c.none(),o=c.none(),i=c.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var e=Xr(_u.directionAt),n=Ca.get(t);if(i=c.some(n),t.settings.object_resizing&&!1!==t.settings.table_resize_bars&&(!0===t.settings.object_resizing||"table"===t.settings.object_resizing)){var u=Sa(n,e);u.on(),u.events.startDrag.bind(function(e){r=c.some(t.selection.getRng())}),u.events.afterResize.bind(function(e){var n=e.table(),o=se.descendants(n,"td[data-mce-style],th[data-mce-style]");x.each(o,function(t){oe.remove(t,"data-mce-style")}),r.each(function(e){t.selection.setRng(e),t.focus()}),t.undoManager.add()}),o=c.some(u)}}),t.on("ObjectResizeStart",function(r){a(r.target)&&(e=r.width,o=r.target,n=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"));var o}),t.on("ObjectResized",function(r){if(a(r.target)){var o=r.target;if(u.test(n)){var i=parseFloat(u.exec(n)[1]),c=r.width*i/e;t.dom.setStyle(o,"width",c+"%")}else{var l=[];qu.each(o.rows,function(e){qu.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);l.push({cell:e,width:n})})}),qu.each(l,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(ea.only(z.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(e){Ca.remove(t,e)})}}}var Ta=function(t){return{fold:t}},Da=function(t){return Ta(function(e,n,r,o){return e(t)})},Aa=function(t){return Ta(function(e,n,r,o){return n(t)})},ka=function(t,e){return Ta(function(n,r,o,i){return o(t,e)})},Na=function(t){return Ta(function(e,n,r,o){return o(t)})},Oa=function(t,e){return xe.table(t,e).bind(function(e){var r=xe.cells(e);return x.findIndex(r,function(e){return _t.eq(t,e)}).map(function(t){return{index:n.constant(t),all:n.constant(r)}})})},Ea=function(t,e){return Oa(t,e).fold(function(){return Da(t)},function(e){return e.index()+1<e.all().length?ka(t,e.all()[e.index()+1]):Na(t)})},Ba=function(t,e){return Oa(t,e).fold(function(){return Da()},function(e){return e.index()-1>=0?ka(t,e.all()[e.index()-1]):Aa(t)})},Ia=Gn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Pa={before:Ia.before,on:Ia.on,after:Ia.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(n.identity,n.identity,n.identity)}},Wa=Gn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),_a=B.immutable("start","soffset","finish","foffset"),Ma={domRange:Wa.domRange,relative:Wa.relative,exact:Wa.exact,exactFromRange:function(t){return Wa.exact(t.start(),t.soffset(),t.finish(),t.foffset())},range:_a,getWin:function(t){var e,n=(e=t,e.match({domRange:function(t){return z.fromDom(t.startContainer)},relative:function(t,e){return Pa.getStart(t)},exact:function(t,e,n,r){return t}}));return Vt.defaultView(n)}},La=function(t,e,n,r){var o=Vt.owner(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o},qa=function(t,e,n,r){var o=La(t,e,n,r),i=_t.eq(t,n)&&e===r;return o.collapsed&&!i},Fa=function(t,e){var n=(e||document).createDocumentFragment();return x.each(t,function(t){n.appendChild(t.dom())}),z.fromDom(n)},za=function(t,e){t.selectNodeContents(e.dom())},ja=function(t){t.deleteContents()},Ha=function(t){return{left:n.constant(t.left),top:n.constant(t.top),right:n.constant(t.right),bottom:n.constant(t.bottom),width:n.constant(t.width),height:n.constant(t.height)}},Va={create:function(t){return t.document.createRange()},replaceWith:function(t,e){ja(t),t.insertNode(e.dom())},selectNodeContents:function(t,e){var n=t.document.createRange();return za(n,e),n},selectNodeContentsUsing:za,relativeToNative:function(t,e,n){var r=t.document.createRange();o=r,e.fold(function(t){o.setStartBefore(t.dom())},function(t,e){o.setStart(t.dom(),e)},function(t){o.setStartAfter(t.dom())});var o;i=r,n.fold(function(t){i.setEndBefore(t.dom())},function(t,e){i.setEnd(t.dom(),e)},function(t){i.setEndAfter(t.dom())});var i;return r},exactToNative:function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},deleteContents:ja,cloneFragment:function(t){var e=t.cloneContents();return z.fromDom(e)},getFirstRect:function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?c.some(n).map(Ha):c.none()},getBounds:function(t){var e=t.getBoundingClientRect();return e.width>0||e.height>0?c.some(e).map(Ha):c.none()},isWithin:function(t,e){return e.compareBoundaryPoints(t.END_TO_START,t)<1&&e.compareBoundaryPoints(t.START_TO_END,t)>-1},toString:function(t){return t.toString()}},Ua=Gn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ga=function(t,e,n){return e(z.fromDom(n.startContainer),n.startOffset,z.fromDom(n.endContainer),n.endOffset)},Xa=function(t,e){var r;return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Ua.rtl(z.fromDom(t.endContainer),t.endOffset,z.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Ga(0,Ua.ltr,n)}):Ga(0,Ua.ltr,n)}(0,(r=t,e.match({domRange:function(t){return{ltr:n.constant(t),rtl:c.none}},relative:function(t,e){return{ltr:ot(function(){return Va.relativeToNative(r,t,e)}),rtl:ot(function(){return c.some(Va.relativeToNative(r,e,t))})}},exact:function(t,e,n,o){return{ltr:ot(function(){return Va.exactToNative(r,t,e,n,o)}),rtl:ot(function(){return c.some(Va.exactToNative(r,n,o,t,e))})}}})))},Ya={ltr:Ua.ltr,rtl:Ua.rtl,diagnose:Xa,asLtrRange:function(t,e){return Xa(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})}},$a=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},Ka=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n>a.bottom);else{if(n<a.top||c>i)return u-1;i=c}}return 0},Ja={locate:function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return So(i,function(t){return $a(t,n,r)?c.some(t):c.none()}).map(function(o){return function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=Ke.get(e).length,a=Ka(function(t){return i(t).getBoundingClientRect()},n,r,o.right,u);return i(a)}(t,e,n,r,o)})}},Qa=function(t,e,n,r){var o=t.dom().createRange(),i=Vt.children(e);return So(i,function(e){return o.selectNode(e.dom()),$a(o.getBoundingClientRect(),n,r)?Za(t,e,n,r):c.none()})},Za=function(t,e,n,r){return(Zt.isText(e)?Ja.locate:Qa)(t,e,n,r)},tc=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Za(t,e,u,a)},ec=function(t,e){return e-t.left<t.right-e},nc=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},rc=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=ec(o,n);return(!0===i?nn.first:nn.last)(e).map(function(e){return nc(t,e,i)})},oc=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=ec(r,n);return c.some(nc(t,e,o))},ic=function(t,e,n){return(0===Vt.children(e).length?oc:rc)(t,e,n)},uc=document.caretPositionFromPoint?function(t,e,n){return c.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return c.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),c.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return c.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return z.fromPoint(t,e,n).bind(function(r){var o=function(){return ic(t,r,e)};return 0===Vt.children(r).length?o():function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return tc(t,e,u,a)}(t,r,e,n).orThunk(o)})},ac=function(t,e,n){var r=z.fromDom(t.document);return uc(r,e,n).map(function(t){return Ma.range(z.fromDom(t.startContainer),t.startOffset,z.fromDom(t.endContainer),t.endOffset)})},cc=function(t,e,n){var r=Ya.asLtrRange(t,e),o=z.fromDom(r.commonAncestorContainer);return Zt.isElement(o)?function(t,e,n,r){var o=Va.create(t),i=($.is(e,r)?[e]:[]).concat(se.descendants(e,r));return x.filter(i,function(t){return Va.selectNodeContentsUsing(o,t),Va.isWithin(n,o)})}(t,o,r,n):[]},lc=function(t,e){var n=Zt.name(t);return"input"===n?Pa.after(t):x.contains(["br","img"],n)?0===e?Pa.before(t):Pa.after(t):Pa.on(t,e)},sc=function(t,e){var n=t.fold(Pa.before,lc,Pa.after),r=e.fold(Pa.before,lc,Pa.after);return Ma.relative(n,r)},fc=function(t,e,n,r){var o=lc(t,e),i=lc(n,r);return Ma.relative(o,i)},dc=function(t){return t.match({domRange:function(t){var e=z.fromDom(t.startContainer),n=z.fromDom(t.endContainer);return fc(e,t.startOffset,n,t.endOffset)},relative:sc,exact:fc})},mc=sc,gc=fc,pc=function(t,e){c.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},hc=function(t,e,n,r,o){var i=Va.exactToNative(t,e,n,r,o);pc(t,i)},vc=function(t,e){return Ya.diagnose(t,e).match({ltr:function(e,n,r,o){hc(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();i.extend?(i.collapse(e.dom(),n),i.extend(r.dom(),o)):hc(t,r,o,e,n)}})},bc=function(t){var e=z.fromDom(t.anchorNode),n=z.fromDom(t.focusNode);return qa(e,t.anchorOffset,n,t.focusOffset)?c.some(Ma.range(z.fromDom(t.anchorNode),t.anchorOffset,z.fromDom(t.focusNode),t.focusOffset)):function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return c.some(Ma.range(z.fromDom(e.startContainer),e.startOffset,z.fromDom(n.endContainer),n.endOffset))}return c.none()}(t)},wc=function(t){var e=t.getSelection();return e.rangeCount>0?bc(e):c.none()},yc={setExact:function(t,e,n,r,o){var i=gc(e,n,r,o);vc(t,i)},getExact:wc,get:function(t){return wc(t).map(function(t){return Ma.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},setRelative:function(t,e,n){var r=mc(e,n);vc(t,r)},toNative:function(t){var e=Ma.getWin(t).dom(),n=function(t,n,r,o){return Va.exactToNative(e,t,n,r,o)},r=dc(t);return Ya.diagnose(e,r).match({ltr:n,rtl:n})},setToElement:function(t,e){var n=Va.selectNodeContents(t,e);pc(t,n)},clear:function(t){t.getSelection().removeAllRanges()},clone:function(t,e){var n=Ya.asLtrRange(t,e);return Va.cloneFragment(n)},replace:function(t,e,n){var r=Ya.asLtrRange(t,e),o=Fa(n,t.document);Va.replaceWith(r,o)},deleteAt:function(t,e){var n=Ya.asLtrRange(t,e);Va.deleteContents(n)},forElement:function(t,e){var n=Va.selectNodeContents(t,e);return Ma.range(z.fromDom(n.startContainer),n.startOffset,z.fromDom(n.endContainer),n.endOffset)},getFirstRect:function(t,e){var n=Ya.asLtrRange(t,e);return Va.getFirstRect(n)},getBounds:function(t,e){var n=Ya.asLtrRange(t,e);return Va.getBounds(n)},getAtPoint:function(t,e,n){return ac(t,e,n)},findWithin:function(t,e,n){return cc(t,e,n)},getAsString:function(t,e){var n=Ya.asLtrRange(t,e);return Va.toString(n)},isCollapsed:function(t,e,n,r){return _t.eq(t,n)&&e===r}},xc=tinymce.util.Tools.resolve("tinymce.util.VK"),Sc=function(t,e,n,r){return Tc(t,e,Ea(n),r)},Cc=function(t,e,n,r){return Tc(t,e,Ba(n),r)},Rc=function(t,e){var n=Ma.exact(e,0,e,0);return yc.toNative(n)},Tc=function(t,e,n,r,o){return n.fold(c.none,c.none,function(t,e){return nn.first(e).map(function(t){return Rc(0,t)})},function(n){return xe.table(n,e).bind(function(e){var o=er.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,o)}),function(t,e){var n=se.descendants(e,"tr");return x.last(n).bind(function(t){return ve.descendant(t,"td,th").map(function(t){return Rc(0,t)})})}(0,e)})})},Dc=["table","li","dl"],Ac={handle:function(t,e,n,r){if(t.keyCode===xc.TAB){var o=Eu.getBody(e),i=function(t){var e=Zt.name(t);return _t.eq(t,o)||x.contains(Dc,e)},u=e.selection.getRng();if(u.collapsed){var a=z.fromDom(u.startContainer);xe.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?Cc:Sc)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}}},kc={response:B.immutable("selection","kill")},Nc=function(t){return function(e){return e===t}},Oc=Nc(38),Ec=Nc(40),Bc={ltr:{isBackward:Nc(37),isForward:Nc(39)},rtl:{isBackward:Nc(39),isForward:Nc(37)},isUp:Oc,isDown:Ec,isNavigation:function(t){return t>=37&&t<=40}},Ic={convertToRange:function(t,e){var r=Ya.asLtrRange(t,e);return{start:n.constant(z.fromDom(r.startContainer)),soffset:n.constant(r.startOffset),finish:n.constant(z.fromDom(r.endContainer)),foffset:n.constant(r.endOffset)}},makeSitus:function(t,e,r,o){return{start:n.constant(Pa.on(t,e)),finish:n.constant(Pa.on(r,o))}}},Pc=It.detect().browser.isSafari(),Wc=function(t){var e=void 0!==t?t.dom():document,n=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Er(n,r)},_c=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollTo(t,e)},Mc=function(t,e){Pc&&N.isFunction(t.dom().scrollIntoViewIfNeeded)?t.dom().scrollIntoViewIfNeeded(!1):t.dom().scrollIntoView(e)},Lc={get:Wc,to:_c,by:function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollBy(t,e)},preserve:function(t,e){var n=Wc(t);e();var r=Wc(t);n.top()===r.top()&&n.left()===r.left()||_c(n.left(),n.top(),t)},capture:function(t){var e=c.none(),n=function(){e=c.some(Wc(t))};return n(),{save:n,restore:function(){e.each(function(e){_c(e.left(),e.top(),t)})}}},intoView:Mc,intoViewIfNeeded:function(t,e){var n=e.dom().getBoundingClientRect(),r=t.dom().getBoundingClientRect();r.top<n.top?Mc(t,!0):r.bottom>n.bottom&&Mc(t,!1)},setToElement:function(t,e){var n=Pr(e),r=z.fromDom(t.document);_c(n.left(),n.top(),r)},scrollBarWidth:function(){var t=z.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');_e.after(ae.body(),t);var e=t.dom().offsetWidth-t.dom().clientWidth;return qe.remove(t),e}};function qc(t){return{elementFromPoint:function(e,n){return c.from(t.document.elementFromPoint(e,n)).map(z.fromDom)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(e,r,o,i){var u=Ma.exact(e,r,o,i);return yc.getFirstRect(t,u).map(function(t){return A.map(t,n.apply)})},getSelection:function(){return yc.get(t).map(function(e){return Ic.convertToRange(t,e)})},fromSitus:function(e){var n=Ma.relative(e.start(),e.finish());return Ic.convertToRange(t,n)},situsFromPoint:function(e,r){return yc.getAtPoint(t,e,r).map(function(t){return{start:n.constant(Pa.on(t.start(),t.soffset())),finish:n.constant(Pa.on(t.finish(),t.foffset()))}})},clearSelection:function(){yc.clear(t)},setSelection:function(e){yc.setExact(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){yc.setRelative(t,e,n)},selectContents:function(e){yc.setToElement(t,e)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return Lc.get(z.fromDom(t.document)).top()},scrollBy:function(e,n){Lc.by(e,n,z.fromDom(t.document))}}}var Fc=function(t,e,n,r,o){if(!_t.eq(n,r))return Fn.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),c.some(kc.response(c.some(Ic.makeSitus(n,0,n,Ze(n))),!0))):c.none()})},zc={sync:function(t,e,n,r,o,i,u){return _t.eq(n,o)&&r===i?c.none():ve.closest(n,"td,th",e).bind(function(n){return ve.closest(o,"td,th",e).bind(function(r){return Fc(t,e,n,r,u)})})},detect:Fc,update:function(t,e,n,r,o){return Fn.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()})}},jc=B.immutableBag(["left","top","right","bottom"],[]),Hc={nu:jc,moveUp:function(t,e){return jc({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return jc({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return jc({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return jc({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return jc({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Vc=function(t){return Hc.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Uc=function(t,e){return c.some(t.getRect(e))},Gc=function(t,e,n){return Zt.isElement(e)?Uc(t,e).map(Vc):Zt.isText(e)?(r=t,o=e,i=n,i>=0&&i<Ze(o)?r.getRangedRect(o,i,o,i+1):i>0?r.getRangedRect(o,i-1,o,i):c.none()).map(Vc):c.none();var r,o,i},Xc=function(t,e){return Zt.isElement(e)?Uc(t,e).map(Vc):Zt.isText(e)?t.getRangedRect(e,0,e,Ze(e)).map(Vc):c.none()},Yc=B.immutable("item","mode"),$c=function(t,e,n,r){var o=void 0!==r?r:Kc;return t.property().parent(e).map(function(t){return Yc(t,o)})},Kc=function(t,e,n,r){var o=void 0!==r?r:Jc;return n.sibling(t,e).map(function(t){return Yc(t,o)})},Jc=function(t,e,n,r){var o=void 0!==r?r:Jc,i=t.property().children(e);return n.first(i).map(function(t){return Yc(t,o)})},Qc=[{current:$c,next:Kc,fallback:c.none()},{current:Kc,next:Jc,fallback:c.some($c)},{current:Jc,next:Jc,fallback:c.some(Kc)}],Zc=function(t,e,n,r,o){return o=void 0!==o?o:Qc,x.find(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return Zc(t,e,n,r)})})})},tl={backtrack:$c,sidestep:Kc,advance:Jc,go:Zc},el={left:function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?c.some(t[t.length-1]):c.none()}}},right:function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?c.some(t[0]):c.none()}}}},nl=function(t,e,n,r,o,i){return tl.go(t,e,r,o).bind(function(e){return i(e.item())?c.none():n(e.item())?c.some(e.item()):nl(t,e.item(),n,e.mode(),o,i)})},rl=function(t,e,n,r){return nl(t,e,n,tl.sidestep,el.left(),r)},ol=function(t,e,n,r){return nl(t,e,n,tl.sidestep,el.right(),r)},il=function(t,e){return 0===t.property().children(e).length},ul=function(t,e,n,r){return rl(t,e,n,r)},al=function(t,e,n,r){return ol(t,e,n,r)},cl={before:function(t,e,r){return ul(t,e,n.curry(il,t),r)},after:function(t,e,r){return al(t,e,n.curry(il,t),r)},seekLeft:ul,seekRight:al,walkers:function(){return{left:el.left,right:el.right}},walk:function(t,e,n,r,o){return tl.go(t,e,n,r,o)},backtrack:tl.backtrack,sidestep:tl.sidestep,advance:tl.advance},ll=fn(),sl={gather:function(t,e,n){return cl.gather(ll,t,e,n)},before:function(t,e){return cl.before(ll,t,e)},after:function(t,e){return cl.after(ll,t,e)},seekLeft:function(t,e,n){return cl.seekLeft(ll,t,e,n)},seekRight:function(t,e,n){return cl.seekRight(ll,t,e,n)},walkers:function(){return cl.walkers()},walk:function(t,e,n,r){return cl.walk(ll,t,e,n,r)}},fl=Gn([{none:[]},{retry:["caret"]}]),dl=function(t,e,r){return pe.closest(e,mo).fold(n.constant(!1),function(e){return Xc(t,e).exists(function(t){return n=t,(e=r).left()<n.left()||Math.abs(n.right()-e.left())<1||e.left()>n.right();var e,n})})},ml={point:Hc.getTop,adjuster:function(t,e,n,r,o){var i=Hc.moveUp(o,5);return Math.abs(n.top()-r.top())<1?fl.retry(i):n.bottom()<o.top()?fl.retry(i):n.bottom()===o.top()?fl.retry(Hc.moveUp(o,1)):dl(t,e,o)?fl.retry(Hc.translate(i,5,0)):fl.none()},move:Hc.moveUp,gather:sl.before},gl={point:Hc.getBottom,adjuster:function(t,e,n,r,o){var i=Hc.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?fl.retry(i):n.top()>o.bottom()?fl.retry(i):n.top()===o.bottom()?fl.retry(Hc.moveDown(o,1)):dl(t,e,o)?fl.retry(Hc.translate(i,5,0)):fl.none()},move:Hc.moveDown,gather:sl.after},pl=function(t,e,n,r,o){if(0===o)return c.some(r);if(f=t,d=r.left(),m=e.point(r),f.elementFromPoint(d,m).filter(function(t){return"table"===Zt.name(t)}).isSome())return i=t,u=e,a=n,l=r,s=o-1,pl(i,u,a,u.move(l,5),s);var i,u,a,l,s,f,d,m;return t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(c.none,function(i,u){return Xc(t,i,u).bind(function(u){return e.adjuster(t,i,u,n,r).fold(c.none,function(r){return pl(t,e,n,r,o-1)})}).orThunk(function(){return c.some(r)})},c.none)})},hl=function(t,e,n){var r=t.move(n,5),o=pl(e,t,n,r,100).getOr(r);return(i=t,u=o,a=e,i.point(u)>a.getInnerHeight()?c.some(i.point(u)-a.getInnerHeight()):i.point(u)<0?c.some(-i.point(u)):c.none()).fold(function(){return e.situsFromPoint(o.left(),t.point(o))},function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)});var i,u,a},vl={tryUp:n.curry(hl,ml),tryDown:n.curry(hl,gl),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:n.constant(5)},bl=Gn([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),wl=function(t){return ve.closest(t,"tr")},yl={verify:function(t,e,n,r,o,i,u){return ve.closest(r,"td,th",u).bind(function(n){return ve.closest(e,"td,th",u).map(function(e){return _t.eq(n,e)?_t.eq(r,n)&&Ze(n)===o?i(e):bl.none("in same cell"):xn(wl,[n,e]).fold(function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?bl.success():i(e)},function(t){return i(e)})})}).getOr(bl.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)},adt:bl},xl={point:B.immutable("element","offset"),delta:B.immutable("element","deltaOffset"),range:B.immutable("element","start","finish"),points:B.immutable("begin","end"),text:B.immutable("element","text")},Sl=(B.immutable("ancestor","descendants","element","index"),B.immutable("parent","children","element","index")),Cl=function(t,e){return x.findIndex(t,n.curry(_t.eq,e))},Rl=function(t){return Vt.parent(t).bind(function(e){var n=Vt.children(e);return Cl(n,t).map(function(r){return Sl(e,n,t,r)})})},Tl=function(t){return"br"===Zt.name(t)},Dl=function(t,e,n){return e(t,n).bind(function(t){return Zt.isText(t)&&0===Ke.get(t).trim().length?Dl(t,e,n):c.some(t)})},Al=function(t,e,n,r){return(o=e,i=n,Vt.child(o,i).filter(Tl).orThunk(function(){return Vt.child(o,i-1).filter(Tl)})).bind(function(e){return r.traverse(e).fold(function(){return Dl(e,r.gather,t).map(r.relative)},function(t){return Rl(t).map(function(t){return Pa.on(t.parent(),t.index())})})});var o,i},kl=function(t,e,r,o){var i,u,a;return(Tl(e)?(i=t,u=e,a=o,a.traverse(u).orThunk(function(){return Dl(u,a.gather,i)}).map(a.relative)):Al(t,e,r,o)).map(function(t){return{start:n.constant(t),finish:n.constant(t)}})},Nl=function(t){return yl.cata(t,function(t){return c.none("BR ADT: none")},function(){return c.none()},function(t){return c.some(xl.point(t,0))},function(t){return c.some(xl.point(t,Ze(t)))})},Ol=It.detect(),El=function(t,e,n,r,o,i){return 0===i?c.none():Pl(t,e,n,r,o).bind(function(u){var a=t.fromSitus(u),l=yl.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return yl.cata(l,function(){return c.none()},function(){return c.some(u)},function(u){return _t.eq(n,u)&&0===r?Bl(t,n,r,Hc.moveUp,o):El(t,e,u,0,o,i-1)},function(u){return _t.eq(n,u)&&r===Ze(u)?Bl(t,n,r,Hc.moveDown,o):El(t,e,u,Ze(u),o,i-1)})})},Bl=function(t,e,n,r,o){return Gc(t,e,n).bind(function(e){return Il(t,o,r(e,vl.getJumpSize()))})},Il=function(t,e,n){return Ol.browser.isChrome()||Ol.browser.isSafari()||Ol.browser.isFirefox()||Ol.browser.isEdge()?e.otherRetry(t,n):Ol.browser.isIE()?e.ieRetry(t,n):c.none()},Pl=function(t,e,n,r,o){return Gc(t,n,r).bind(function(e){return Il(t,o,e)})},Wl=function(t,e,n){return(r=t,o=e,i=n,r.getSelection().bind(function(t){return kl(o,t.finish(),t.foffset(),i).fold(function(){return c.some(xl.point(t.finish(),t.foffset()))},function(e){var n=r.fromSitus(e),u=yl.verify(r,t.finish(),t.foffset(),n.finish(),n.foffset(),i.failure,o);return Nl(u)})})).bind(function(r){return El(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)});var r,o,i},_l=function(t,e,n){return pe.ancestor(t,e,n).isSome()},Ml=It.detect(),Ll=function(t,e,r,o,i){return ve.closest(o,"td,th",e).bind(function(o){return ve.closest(o,"table",e).bind(function(u){if(a=u,!_l(i,function(t){return Vt.parent(t).exists(function(t){return _t.eq(t,a)})}))return c.none();var a;return Wl(t,e,r).bind(function(t){return ve.closest(t.finish(),"td,th",e).map(function(e){return{start:n.constant(o),finish:n.constant(e),range:n.constant(t)}})})})})},ql=function(t,e,n,r,o,i){return Ml.browser.isIE()?c.none():i(r,e).orThunk(function(){return Ll(t,e,n,r,o).map(function(t){var e=t.range();return kc.response(c.some(Ic.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},Fl=function(t,e,n,r,o,i,u){return Ll(t,n,r,o,i).bind(function(t){return zc.detect(e,n,t.start(),t.finish(),u)})},zl=function(t,e){return ve.closest(t,"tr",e).bind(function(t){return ve.closest(t,"table",e).bind(function(n){var r=se.descendants(n,"tr");return _t.eq(t,r[0])?sl.seekLeft(n,function(t){return nn.last(t).isSome()},e).map(function(t){var e=Ze(t);return kc.response(c.some(Ic.makeSitus(t,e,t,e)),!0)}):c.none()})})},jl=function(t,e){return ve.closest(t,"tr",e).bind(function(t){return ve.closest(t,"table",e).bind(function(n){var r=se.descendants(n,"tr");return _t.eq(t,r[r.length-1])?sl.seekRight(n,function(t){return nn.first(t).isSome()},e).map(function(t){return kc.response(c.some(Ic.makeSitus(t,0,t,0)),!0)}):c.none()})})},Hl=function(t,e){return ve.closest(t,"td,th",e)},Vl={down:{traverse:Vt.nextSibling,gather:sl.after,relative:Pa.before,otherRetry:vl.tryDown,ieRetry:vl.ieTryDown,failure:yl.adt.failedDown},up:{traverse:Vt.prevSibling,gather:sl.before,relative:Pa.before,otherRetry:vl.tryUp,ieRetry:vl.ieTryUp,failure:yl.adt.failedUp}},Ul=B.immutable("rows","cols"),Gl={mouse:function(t,e,n,r){var o=function(t,e,n,r){var o=c.none(),i=function(){o=c.none()};return{mousedown:function(t){r.clear(e),o=Hl(t.target(),n)},mouseover:function(i){o.each(function(o){r.clear(e),Hl(i.target(),n).each(function(i){Fn.identify(o,i,n).each(function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!_t.eq(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}}(qc(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,r,o){var i=qc(t),u=function(){return o.clear(e),c.none()};return{keydown:function(t,a,l,s,f,d){var m=t.raw().which,g=!0===t.raw().shiftKey;return Fn.retrieve(e,o.selectedSelector()).fold(function(){return Bc.isDown(m)&&g?n.curry(Fl,i,e,r,Vl.down,s,a,o.selectRange):Bc.isUp(m)&&g?n.curry(Fl,i,e,r,Vl.up,s,a,o.selectRange):Bc.isDown(m)?n.curry(ql,i,r,Vl.down,s,a,jl):Bc.isUp(m)?n.curry(ql,i,r,Vl.up,s,a,zl):c.none},function(t){var n=function(n){return function(){return So(n,function(n){return zc.update(n.rows(),n.cols(),e,t,o)}).fold(function(){return Fn.getEdges(e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){var n=Bc.isDown(m)||d.isForward(m)?Pa.after:Pa.before;return i.setRelativeSelection(Pa.on(t.first(),0),n(t.table())),o.clear(e),kc.response(c.none(),!0)})},function(t){return c.some(kc.response(c.none(),!0))})}};return Bc.isDown(m)&&g?n([Ul(1,0)]):Bc.isUp(m)&&g?n([Ul(-1,0)]):d.isBackward(m)&&g?n([Ul(0,-1),Ul(-1,0)]):d.isForward(m)&&g?n([Ul(0,1),Ul(1,0)]):Bc.isNavigation(m)&&!1===g?u:c.none})()},keyup:function(t,n,i,u,a){return Fn.retrieve(e,o.selectedSelector()).fold(function(){var l=t.raw().which;return 0==(!0===t.raw().shiftKey)?c.none():Bc.isNavigation(l)?zc.sync(e,r,n,i,u,a,o.selectRange):c.none()},c.none)}}}},Xl=function(t,e){x.each(e,function(e){ni.remove(t,e)})},Yl=function(t){return function(e){ni.add(e,t)}},$l=function(t){return function(e){Xl(e,t)}},Kl={byClass:function(t){var e=Yl(t.selected()),n=$l([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(e){var r=se.descendants(e,t.selectedSelector());x.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),x.each(o,e),ni.add(i,t.firstSelected()),ni.add(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var e=function(e){oe.remove(e,t.selected()),oe.remove(e,t.firstSelected()),oe.remove(e,t.lastSelected())},n=function(e){oe.set(e,t.selected(),"1")},r=function(n){var r=se.descendants(n,t.selectedSelector());x.each(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),x.each(o,n),oe.set(i,t.firstSelected(),"1"),oe.set(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}};function Jl(t,e){var r=B.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),o=c.none(),i=Kl.byAttr(Un);return t.on("init",function(u){var a=t.getWin(),l=Eu.getBody(t),s=Eu.getIsRoot(t),f=Gl.mouse(a,l,s,i),d=Gl.keyboard(a,l,s,i),m=function(e,n){n.kill()&&e.kill(),n.selection().each(function(e){var n=Ma.relative(e.start(),e.finish()),r=Ya.asLtrRange(a,n);t.selection.setRng(r)})},g=function(e){var n=v(e);if(n.raw().shiftKey&&Bc.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=z.fromDom(r.startContainer),i=z.fromDom(r.endContainer);d.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){m(n,t)})}},p=function(t){return!(oe.has(t,"data-mce-bogus")||"br"===Zt.name(t)||Zt.isText(t)&&0===Ke.get(t).length)},h=function(n){var r=v(n);e().each(function(t){t.hideBars()}),40===n.which&&function(){var e=z.fromDom(t.getBody()),n=function(t){return Vt.prevSibling(t).bind(function(t){return p(t)?c.some(t):n(t)})};return Vt.lastChild(e).bind(function(t){return p(t)?c.some(t):n(t)})}().each(function(e){"table"===Zt.name(e)&&(t.settings.forced_root_block?t.dom.add(t.getBody(),t.settings.forced_root_block,t.settings.forced_root_block_attrs,"<br/>"):t.dom.add(t.getBody(),"br"))});var o=t.selection.getRng(),i=z.fromDom(t.selection.getStart()),u=z.fromDom(o.startContainer),a=z.fromDom(o.endContainer),l=_u.directionAt(i).isRtl()?Bc.rtl:Bc.ltr;d.keydown(r,u,o.startOffset,a,o.endOffset,l).each(function(t){m(r,t)}),e().each(function(t){t.showBars()})},v=function(t){var e=z.fromDom(t.target),r=function(){t.stopPropagation()},o=function(){t.preventDefault()},i=n.compose(o,r);return{target:n.constant(e),x:n.constant(t.x),y:n.constant(t.y),stop:r,prevent:o,kill:i,raw:n.constant(t)}},b=function(t){return 0===t.button},w=function(t){b(t)&&f.mousedown(v(t))},y=function(t){(void 0===(e=t).buttons||0!=(1&e.buttons))&&f.mouseover(v(t));var e},x=function(t){b&&f.mouseup(v(t))};t.on("mousedown",w),t.on("mouseover",y),t.on("mouseup",x),t.on("keyup",g),t.on("keydown",h),t.on("nodechange",function(){var e=t.selection,r=z.fromDom(e.getStart()),o=z.fromDom(e.getEnd()),u=xe.table(r),a=xe.table(o);u.bind(function(t){return a.bind(function(e){return _t.eq(t,e)?c.some(!0):c.none()})}).fold(function(){i.clear(l)},n.noop)}),o=c.some(r({mousedown:w,mouseover:y,mouseup:x,keyup:g,keydown:h}))}),{clear:i.clear,destroy:function(){o.each(function(t){})}}}var Ql=qu.each,Zl={addButtons:function(t){var e=[];Ql("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])}),t.addButton("table",{type:"menubutton",title:"Table",menu:e});function r(e){return function(){t.execCommand(e)}}t.addButton("tableprops",{title:"Table properties",onclick:n.curry(Gu,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:r("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:r("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:r("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:r("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:r("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:r("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:r("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:r("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:r("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:r("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:r("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:r("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:r("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:r("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:r("mceTableDeleteCol")})},addToolbars:function(t){var e=t.settings.table_toolbar;""!==e&&!1!==e&&(e||(e="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),t.addContextToolbar(function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},e))}},ts={addMenuItems:function(t,e){var r=c.none(),o=[],i=[],u=[],a=[],l=function(t){t.disabled(!0)},s=function(t){t.disabled(!1)},f=function(){var t=this;o.push(t),r.fold(function(){l(t)},function(e){s(t)})},d=function(){var t=this;i.push(t),r.fold(function(){l(t)},function(e){s(t)})};t.on("init",function(){t.on("nodechange",function(n){var f=c.from(t.dom.getParent(t.selection.getStart(),"th,td"));(r=f.bind(function(t){var n=z.fromDom(t);return xe.table(n).map(function(t){return er.forMenu(e,t,n)})})).fold(function(){x.each(o,l),x.each(i,l),x.each(u,l),x.each(a,l)},function(t){x.each(o,s),x.each(i,s),x.each(u,function(e){e.disabled(t.mergable().isNone())}),x.each(a,function(e){e.disabled(t.unmergable().isNone())})})})});var m=function(t,e,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),s&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=e:o<=e)&&i<=n,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},g=!1===t.settings.table_grid?{text:"Table",icon:"table",context:"table",onclick:n.curry(Gu,t)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),Gu(t))},onshow:function(){m(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(m(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){ar.insert(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]};function p(e){return function(){t.execCommand(e)}}var h={text:"Table properties",context:"table",onPostRender:f,onclick:n.curry(Gu,t,!0)},v={text:"Delete table",context:"table",onPostRender:f,cmd:"mceTableDelete"},b={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:p("mceTableInsertRowBefore"),onPostRender:d},{text:"Insert row after",onclick:p("mceTableInsertRowAfter"),onPostRender:d},{text:"Delete row",onclick:p("mceTableDeleteRow"),onPostRender:d},{text:"Row properties",onclick:p("mceTableRowProps"),onPostRender:d},{text:"-"},{text:"Cut row",onclick:p("mceTableCutRow"),onPostRender:d},{text:"Copy row",onclick:p("mceTableCopyRow"),onPostRender:d},{text:"Paste row before",onclick:p("mceTablePasteRowBefore"),onPostRender:d},{text:"Paste row after",onclick:p("mceTablePasteRowAfter"),onPostRender:d}]},w={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:p("mceTableInsertColBefore"),onPostRender:d},{text:"Insert column after",onclick:p("mceTableInsertColAfter"),onPostRender:d},{text:"Delete column",onclick:p("mceTableDeleteCol"),onPostRender:d}]},y={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:p("mceTableCellProps"),onPostRender:d},{text:"Merge cells",onclick:p("mceTableMergeCells"),onPostRender:function(){var t=this;u.push(t),r.fold(function(){l(t)},function(e){t.disabled(e.mergable().isNone())})}},{text:"Split cell",onclick:p("mceTableSplitCells"),onPostRender:function(){var t=this;a.push(t),r.fold(function(){l(t)},function(e){t.disabled(e.unmergable().isNone())})}}]};t.addMenuItem("inserttable",g),t.addMenuItem("tableprops",h),t.addMenuItem("deletetable",v),t.addMenuItem("row",b),t.addMenuItem("column",w),t.addMenuItem("cell",y)}};t.add("table",function(t){var e,n=Ra(t),r=Jl(t,n.lazyResize),o=Mu(t,n.lazyWire),i=(e=t,{get:function(){var t=Eu.getBody(e);return zn.retrieve(t,Un.selectedSelector()).fold(function(){return void 0===e.selection.getStart()?Yn.none():Yn.single(e.selection)},function(t){return Yn.multiple(t)})}});ta.registerCommands(t,o,r,i),nr.registerEvents(t,i,o,r),ts.addMenuItems(t,i),Zl.addButtons(t),Zl.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(Un.firstSelected()),t.serializer.addTempAttr(Un.lastSelected())}),!1!==t.settings.table_tab_navigation&&t.on("keydown",function(e){Ac.handle(e,t,o,n.lazyWire)}),t.on("remove",function(){n.destroy(),r.destroy()}),this.insertTable=function(e,n){return ar.insert(t,e,n)},this.setClipboardRows=ta.setClipboardRows,this.getClipboardRows=ta.getClipboardRows})}();