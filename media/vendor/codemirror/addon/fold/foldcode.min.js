!function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){"use strict";function e(e,r,i,t){function l(n){var o=f(e,r);if(!o||o.to.line-o.from.line<d)return null;for(var i=e.findMarksAt(o.from),l=0;l<i.length;++l)if(i[l].__isFold&&"fold"!==t){if(!n)return null;o.cleared=!0,i[l].clear()}return o}if(i&&i.call){f=i;i=null}else var f=o(e,i,"rangeFinder");"number"==typeof r&&(r=n.Pos(r,0));var d=o(e,i,"minFoldSize"),u=l(!0);if(o(e,i,"scanUp"))for(;!u&&r.line>e.firstLine();)r=n.Pos(r.line-1,0),u=l(!1);if(u&&!u.cleared&&"unfold"!==t){var a=function(n,e){var r=o(n,e,"widget");if("string"==typeof r){var i=document.createTextNode(r);(r=document.createElement("span")).appendChild(i),r.className="CodeMirror-foldmarker"}else r&&(r=r.cloneNode(!0));return r}(e,i);n.on(a,"mousedown",function(e){c.clear(),n.e_preventDefault(e)});var c=e.markText(u.from,u.to,{replacedWith:a,clearOnEnter:o(e,i,"clearOnEnter"),__isFold:!0});c.on("clear",function(o,r){n.signal(e,"unfold",e,o,r)}),n.signal(e,"fold",e,u.from,u.to)}}function o(n,e,o){if(e&&void 0!==e[o])return e[o];var i=n.options.foldOptions;return i&&void 0!==i[o]?i[o]:r[o]}n.newFoldFunction=function(n,o){return function(r,i){e(r,i,{rangeFinder:n,widget:o})}},n.defineExtension("foldCode",function(n,o,r){e(this,n,o,r)}),n.defineExtension("isFolded",function(n){for(var e=this.findMarksAt(n),o=0;o<e.length;++o)if(e[o].__isFold)return!0}),n.commands.toggleFold=function(n){n.foldCode(n.getCursor())},n.commands.fold=function(n){n.foldCode(n.getCursor(),null,"fold")},n.commands.unfold=function(n){n.foldCode(n.getCursor(),null,"unfold")},n.commands.foldAll=function(e){e.operation(function(){for(var o=e.firstLine(),r=e.lastLine();o<=r;o++)e.foldCode(n.Pos(o,0),null,"fold")})},n.commands.unfoldAll=function(e){e.operation(function(){for(var o=e.firstLine(),r=e.lastLine();o<=r;o++)e.foldCode(n.Pos(o,0),null,"unfold")})},n.registerHelper("fold","combine",function(){var n=Array.prototype.slice.call(arguments,0);return function(e,o){for(var r=0;r<n.length;++r){var i=n[r](e,o);if(i)return i}}}),n.registerHelper("fold","auto",function(n,e){for(var o=n.getHelpers(e,"fold"),r=0;r<o.length;r++){var i=o[r](n,e);if(i)return i}});var r={rangeFinder:n.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};n.defineOption("foldOptions",null),n.defineExtension("foldOption",function(n,e){return o(this,n,e)})});