!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function n(n){if(n.getOption("disableInput"))return e.Pass;for(var t,o=n.listSelections(),i=[],l=0;l<o.length;l++){var r=o[l].head;if(!/\bcomment\b/.test(n.getTokenTypeAt(r)))return e.Pass;var m=n.getModeAt(r);if(t){if(t!=m)return e.Pass}else t=m;var c=null;if(t.blockCommentStart&&t.blockCommentContinue){var f=(u=n.getLine(r.line).slice(0,r.ch)).lastIndexOf(t.blockCommentEnd);if(-1!=f&&f==r.ch-t.blockCommentEnd.length);else if((a=u.lastIndexOf(t.blockCommentStart))>-1&&a>f){if(c=u.slice(0,a),/\S/.test(c)){c="";for(var s=0;s<a;++s)c+=" "}}else(a=u.indexOf(t.blockCommentContinue))>-1&&!/\S/.test(u.slice(0,a))&&(c=u.slice(0,a));null!=c&&(c+=t.blockCommentContinue)}if(null==c&&t.lineComment&&function(e){var n=e.getOption("continueComments");return!n||"object"!=typeof n||!1!==n.continueLineComment}(n)){var a,u=n.getLine(r.line);(a=u.indexOf(t.lineComment))>-1&&(c=u.slice(0,a),/\S/.test(c)?c=null:c+=t.lineComment+u.slice(a+t.lineComment.length).match(/^\s*/)[0])}if(null==c)return e.Pass;i[l]="\n"+c}n.operation(function(){for(var e=o.length-1;e>=0;e--)n.replaceRange(i[e],o[e].from(),o[e].to(),"+insert")})}e.defineOption("continueComments",null,function(t,o,i){if(i&&i!=e.Init&&t.removeKeyMap("continueComment"),o){var l="Enter";"string"==typeof o?l=o:"object"==typeof o&&o.key&&(l=o.key);var r={name:"continueComment"};r[l]=n,t.addKeyMap(r)}})});