function splitLines(t){return t.split(/\r\n?|\n/)}function StringStream(t,e,n){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.context=n}function copyObj(t,e,n){e||(e={});for(var r in t)!t.hasOwnProperty(r)||!1===n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e}!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.runMode=function(e,n,r,i){var s=t.getMode(t.defaults,n),o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<9);if(r.appendChild){var a=i&&i.tabSize||t.defaults.tabSize,u=r,l=0;u.innerHTML="",r=function(t,e){if("\n"==t)return u.appendChild(document.createTextNode(o?"\r":t)),void(l=0);for(var n="",r=0;;){var i=t.indexOf("\t",r);if(-1==i){n+=t.slice(r),l+=t.length-r;break}l+=i-r,n+=t.slice(r,i);var s=a-l%a;l+=s;for(var h=0;h<s;++h)n+=" ";r=i+1}if(e){var p=u.appendChild(document.createElement("span"));p.className="cm-"+e.replace(/ +/g," cm-"),p.appendChild(document.createTextNode(n))}else u.appendChild(document.createTextNode(n))}}for(var h=t.splitLines(e),p=i&&i.state||t.startState(s),c=0,d=h.length;c<d;++c){c&&r("\n");var m=new t.StringStream(h[c]);for(!m.string&&s.blankLine&&s.blankLine(p);!m.eol();){var f=s.token(m,p);r(m.current(),f,c,m.start,p),m.start=m.pos}}}});var countColumn=exports.countColumn=function(t,e,n,r,i){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var s=r||0,o=i||0;;){var a=t.indexOf("\t",s);if(a<0||a>=e)return o+(e-s);o+=a-s,o+=n-o%n,s=a+1}};StringStream.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)n=e==t;else var n=e&&(t.test?t.test(e):t(e));if(n)return++this.pos,e},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},backUp:function(t){this.pos-=t},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},match:function(t,e,n){if("string"!=typeof t){var r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&!1!==e&&(this.pos+=r[0].length),r)}var i=function(t){return n?t.toLowerCase():t};if(i(this.string.substr(this.pos,t.length))==i(t))return!1!==e&&(this.pos+=t.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},lookAhead:function(t){var e=this.context.line+t;return e>=this.context.lines.length?null:this.context.lines[e]}},exports.StringStream=StringStream,exports.startState=function(t,e,n){return!t.startState||t.startState(e,n)};var modes=exports.modes={},mimeModes=exports.mimeModes={};exports.defineMode=function(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),modes[t]=e},exports.defineMIME=function(t,e){mimeModes[t]=e},exports.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),exports.defineMIME("text/plain","null"),exports.resolveMode=function(t){return"string"==typeof t&&mimeModes.hasOwnProperty(t)?t=mimeModes[t]:t&&"string"==typeof t.name&&mimeModes.hasOwnProperty(t.name)&&(t=mimeModes[t.name]),"string"==typeof t?{name:t}:t||{name:"null"}};var modeExtensions=exports.modeExtensions={};exports.extendMode=function(t,e){copyObj(e,modeExtensions.hasOwnProperty(t)?modeExtensions[t]:modeExtensions[t]={})},exports.getMode=function(t,e){var e=exports.resolveMode(e),n=modes[e.name];if(!n)return exports.getMode(t,"text/plain");var r=n(t,e);if(modeExtensions.hasOwnProperty(e.name)){var i=modeExtensions[e.name];for(var s in i)i.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s])}if(r.name=e.name,e.helperType&&(r.helperType=e.helperType),e.modeProps)for(var s in e.modeProps)r[s]=e.modeProps[s];return r},exports.registerHelper=exports.registerGlobalHelper=Math.min,exports.runMode=function(t,e,n,r){for(var i=exports.getMode({indentUnit:2},e),s=splitLines(t),o=r&&r.state||exports.startState(i),a={lines:s,line:0},u=0,l=s.length;u<l;++u,++a.line){u&&n("\n");var h=new exports.StringStream(s[u],4,a);for(!h.string&&i.blankLine&&i.blankLine(o);!h.eol();){var p=i.token(h,o);n(h.current(),p,u,h.start,o),h.start=h.pos}}},require.cache[require.resolve("../../lib/codemirror")]=require.cache[require.resolve("./runmode.node")],require.cache[require.resolve("../../addon/runmode/runmode")]=require.cache[require.resolve("./runmode.node")];