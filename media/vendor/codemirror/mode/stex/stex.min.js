!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";t.defineMode("stex",function(){function t(t,e){t.cmdState.push(e)}function e(t){return t.cmdState.length>0?t.cmdState[t.cmdState.length-1]:null}function n(t,e,n){return function(){this.name=t,this.bracketNo=0,this.style=e,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function r(t,e){t.f=e}function i(n,i){var o;if(n.match(/^\\[a-zA-Z@]+/)){var f=n.current().slice(1);return o=u[f]||u.DEFAULT,o=new o,t(i,o),r(i,c),o.style}if(n.match(/^\\[$&%#{}_]/))return"tag";if(n.match(/^\\[,;!\/\\]/))return"tag";if(n.match("\\["))return r(i,function(t,e){return a(t,e,"\\]")}),"keyword";if(n.match("$$"))return r(i,function(t,e){return a(t,e,"$$")}),"keyword";if(n.match("$"))return r(i,function(t,e){return a(t,e,"$")}),"keyword";var s=n.next();return"%"==s?(n.skipToEnd(),"comment"):"}"==s||"]"==s?(o=e(i))?(o.closeBracket(s),r(i,c),"bracket"):"error":"{"==s||"["==s?(o=u.DEFAULT,o=new o,t(i,o),"bracket"):/\d/.test(s)?(n.eatWhile(/[\w.%]/),"atom"):(n.eatWhile(/[\w\-_]/),"begin"==(o=function(t){for(var e=t.cmdState,n=e.length-1;n>=0;n--){var r=e[n];if("DEFAULT"!=r.name)return r}return{styleIdentifier:function(){return null}}}(i)).name&&(o.argument=n.current()),o.styleIdentifier())}function a(t,e,n){if(t.eatSpace())return null;if(t.match(n))return r(e,i),"keyword";if(t.match(/^\\[a-zA-Z@]+/))return"tag";if(t.match(/^[a-zA-Z]+/))return"variable-2";if(t.match(/^\\[$&%#{}_]/))return"tag";if(t.match(/^\\[,;!\/]/))return"tag";if(t.match(/^[\^_&]/))return"tag";if(t.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(t.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var a=t.next();return"{"==a||"}"==a||"["==a||"]"==a||"("==a||")"==a?"bracket":"%"==a?(t.skipToEnd(),"comment"):"error"}function c(t,n){var a=t.peek();return"{"==a||"["==a?(e(n).openBracket(a),t.eat(a),r(n,i),"bracket"):/[ \t\r]/.test(a)?(t.eat(a),null):(r(n,i),function(t){var e=t.cmdState.pop();e&&e.closeBracket()}(n),i(t,n))}var u={};return u.importmodule=n("importmodule","tag",["string","builtin"]),u.documentclass=n("documentclass","tag",["","atom"]),u.usepackage=n("usepackage","tag",["atom"]),u.begin=n("begin","tag",["atom"]),u.end=n("end","tag",["atom"]),u.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:i}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=i,t.cmdState.length=0},lineComment:"%"}}),t.defineMIME("text/x-stex","stex"),t.defineMIME("text/x-latex","stex")});