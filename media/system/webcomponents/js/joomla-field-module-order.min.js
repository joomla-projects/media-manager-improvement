customElements.define("joomla-field-module-order",class extends HTMLElement{constructor(){super(),this.linkedFieldSelector="",this.linkedFieldElement="",this.originalPosition="",this.writeDynaList.bind(this),this.getNewOrder.bind(this)}connectedCallback(){if(this.linkedFieldSelector=this.getAttribute("data-linked-field")||"jform_position",!this.linkedFieldSelector)throw new Error("No linked field defined!");if(this.linkedFieldElement=document.getElementById(this.linkedFieldSelector),!this.linkedFieldElement)throw new Error("No linked field defined!");const e=this;this.originalPosition=this.linkedFieldElement.value,this.getNewOrder(this.originalPosition),this.linkedFieldElement.addEventListener("change",()=>{e.originalPosition=e.linkedFieldElement.value,e.getNewOrder(e.linkedFieldElement.value)})}writeDynaList(e,t,i,n){let s=0;const l=document.createElement("select");this.hasOwnProperty("disabled")&&l.setAttribute("disabled",""),this.getAttribute("onchange")&&l.setAttribute("onchange",this.getAttribute("onchange")),this.getAttribute("size")&&l.setAttribute("size",this.getAttribute("size")),l.classList.add(e.itemClass),l.setAttribute("name",e.name),l.id=e.id;for(let e in t){if(!t.hasOwnProperty(e))continue;const d=document.createElement("option"),r=t[e];d.value=r[1],d.innerHTML=r[2],(i&&n===r[1]||!i&&0===s)&&d.setAttribute("selected","selected"),l.appendChild(d),s++}this.innerHTML="",this.appendChild(l)}getNewOrder(e){const t=this.getAttribute("data-url"),i=this.getAttribute("data-client-id"),n=this.getAttribute("data-ordering"),s=this.getAttribute("data-name"),l=this.getAttribute("data-client-attr")?this.getAttribute("data-client-attr"):"custom-select",d=this.getAttribute("id")+"_1",r=[],o=this;Joomla.request({url:`${t}client_id=${i}&position=${e}`,method:"GET",perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess:function(e,t){if(e&&(e=JSON.parse(e)).data.length>0){for(let t=0;t<e.data.length;++t)r[t]=e.data[t].split(",");o.writeDynaList({name:s,id:d,itemClass:l},r,o.originalPosition,n)}"object"==typeof e.messages&&null!==e.messages&&Joomla.renderMessages(e.messages)}})}});