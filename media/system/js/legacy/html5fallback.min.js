!function(a,b,c){"use strict";"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b});var d=function(a,b){for(var c=["required","pattern","placeholder","autofocus","formnovalidate"],d=["email","url","number","range"],e={attributes:{},types:{}};b=c.pop();)e.attributes[b]=!!(b in a);for(;b=d.pop();)a.setAttribute("type",b),e.types[b]=a.type==b;return e}(b.createElement("input")),e={init:function(b,c){var d=this;d.elem=c,d.$elem=a(c),c.H5Form=d,d.options=a.extend({},a.fn.h5f.options,b),"form"===c.nodeName.toLowerCase()&&d.bindWithForm(d.elem,d.$elem)},bindWithForm:function(a,b){var c,e=this,f=!!b.attr("novalidate"),g=a.elements,h=g.length;for("onSubmit"===e.options.formValidationEvent&&b.on("submit",function(a){c=void 0!==this.H5Form.donotValidate&&this.H5Form.donotValidate,c||f||e.validateForm(e)?b.find(":input").each(function(){e.placeholder(e,this,"submit")}):(a.preventDefault(),this.donotValidate=!1)}),b.on("focusout focusin",function(a){e.placeholder(e,a.target,a.type)}),b.on("focusout change",e.validateField),b.find("fieldset").on("change",function(){e.validateField(this)}),d.attributes.formnovalidate||b.find(":submit[formnovalidate]").on("click",function(){e.donotValidate=!0});h--;)e.polyfill(g[h]),e.autofocus(e,g[h])},polyfill:function(a){if("form"===a.nodeName.toLowerCase())return!0;var b=a.form.H5Form;b.placeholder(b,a),b.numberType(b,a)},validateForm:function(){var a,b,c=this,d=c.elem,e=d.elements,f=e.length,g=!0;for(d.isValid=!0,a=0;a<f;a++)b=e[a],b.isRequired=!!b.required,b.isDisabled=!!b.disabled,b.isDisabled||(g=c.validateField(b),d.isValid&&!g&&c.setFocusOn(b),d.isValid=g&&d.isValid);return c.options.doRenderMessage&&c.renderErrorMessages(c,d),d.isValid},validateField:function(b){var c,e,f,g=b.target||b,h=!1,i=!1,j=!1;return void 0===g.form?null:(c=g.form.H5Form,e=a(g),i=!!e.attr("required"),!!e.attr("disabled"),g.isDisabled||(h=!d.attributes.required&&i&&c.isValueMissing(c,g),j=!d.attributes.pattern&&c.matchPattern(c,g)),g.validityState={valueMissing:h,patternMismatch:j,valid:g.isDisabled||!(h||j)},d.attributes.required||(g.validityState.valueMissing?e.addClass(c.options.requiredClass):e.removeClass(c.options.requiredClass)),d.attributespattern||(g.validityState.patternMismatch?e.addClass(c.options.patternClass):e.removeClass(c.options.patternClass)),g.validityState.valid?(e.removeClass(c.options.invalidClass),f=c.findLabel(e),f.removeClass(c.options.invalidClass),f.attr("aria-invalid","false")):(e.addClass(c.options.invalidClass),f=c.findLabel(e),f.addClass(c.options.invalidClass),f.attr("aria-invalid","true")),g.validityState.valid)},isValueMissing:function(c,e){var f,g,h,i=a(e),j=void 0!==e.type?e.type:e.tagName.toLowerCase(),k=/^(checkbox|radio|fieldset)$/i.test(j),l=/^submit$/i.test(j);if(l)return!1;if(k){if("checkbox"===j)return!i.is(":checked");for(f="fieldset"===j?i.find("input"):b.getElementsByName(e.name),g=0,h=f.length;g<h;g++)if(a(f[g]).is(":checked"))return!1;return!0}return!(""!==i.val()&&(d.attributes.placeholder||!i.hasClass(c.options.placeholderClass)))},matchPattern:function(b,c){var e,f,g=a(c),h=g.attr("value"),i=g.attr("pattern"),j=g.attr("type");if(!d.attributes.placeholder&&g.attr("placeholder")&&g.hasClass(b.options.placeholderClass)||(h=g.attr("value")),""===h)return!1;if("email"===j){if(void 0===g.attr("multiple"))return!b.options.emailPatt.test(h);for(h=h.split(b.options.mutipleDelimiter),e=0,f=h.length;e<f;e++)if(!b.options.emailPatt.test(h[e].replace(/[ ]*/g,"")))return!0}else{if("url"===j)return!b.options.urlPatt.test(h);if("text"===j&&void 0!==i)return usrPatt=new RegExp("^(?:"+i+")$"),!usrPatt.test(h)}return!1},placeholder:function(b,c,e){var f=a(c),g=f.attr("placeholder"),h=/^(focusin|submit)$/i.test(e),i=/^(input|textarea)$/i.test(c.nodeName),j=/^password$/i.test(c.type);d.attributes.placeholder||!i||j||void 0===g||(""!==c.value||h?c.value===g&&h&&(c.value="",f.removeClass(b.options.placeholderClass)):(c.value=g,f.addClass(b.options.placeholderClass)))},numberType:function(b,c){var e,f,g,h,i,j,k,l,m=a(c),n=m.attr("type"),o=/^input$/i.test(c.nodeName),p=/^(number|range)$/i.test(n);if(!(!o||!p||"number"==n&&d.types.number||"range"==n&&d.types.range)){for(e=parseInt(m.attr("min")),f=parseInt(m.attr("max")),g=parseInt(m.attr("step")),h=parseInt(m.attr("value")),i=m.prop("attributes"),j=a("<select>"),e=isNaN(e)?-100:e,l=e;l<=f;l+=g)k=a('<option value="'+l+'">'+l+"</option>"),(h==l||h>l&&h<l+g)&&k.attr("selected",""),j.append(k);a.each(i,function(){j.attr(this.name,this.value)}),m.replaceWith(j)}},autofocus:function(b,c){var e=a(c),f=!!e.attr("autofocus"),g=/^(input|textarea|select|fieldset)$/i.test(c.nodeName),h=/^submit$/i.test(c.type);!d.attributes.autofocus&&g&&!h&&f&&a(function(){b.setFocusOn(c)})},findLabel:function(b){var c,d=a('label[for="'+b.attr("id")+'"]');return d.length<=0&&(c=b.parent(),"label"==c.get(0).tagName.toLowerCase()&&(d=c)),d},setFocusOn:function(b){"fieldset"===b.tagName.toLowerCase()?a(b).find(":first").focus():a(b).focus()},renderErrorMessages:function(b,c){for(var d,e,f=c.elements,g=f.length,h={errors:[]};g--;)d=a(f[g]),e=b.findLabel(d),d.hasClass(b.options.requiredClass)&&(h.errors[g]=e.text().replace("*","")+b.options.requiredMessage),d.hasClass(b.options.patternClass)&&(h.errors[g]=e.text().replace("*","")+b.options.patternMessage);h.errors.length>0&&Joomla.renderMessages(h)}};a.fn.h5f=function(a){return this.each(function(){Object.create(e).init(a,this)})},a.fn.h5f.options={invalidClass:"invalid",requiredClass:"required",requiredMessage:" is required.",placeholderClass:"placeholder",patternClass:"pattern",patternMessage:" doesn't match pattern.",doRenderMessage:!1,formValidationEvent:"onSubmit",emailPatt:/^[a-zA-Z0-9.!#$%&‚Äô*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,urlPatt:/[a-z][\-\.+a-z]*:\/\//i},a(function(){a("form").h5f({doRenderMessage:!0,requiredClass:"musthavevalue"})})}(jQuery,document);