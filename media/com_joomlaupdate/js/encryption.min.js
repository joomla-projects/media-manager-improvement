var Aes={};Aes.Cipher=function(a,b){for(var c=4,d=b.length/c-1,e=[[],[],[],[]],f=0;f<4*c;f++)e[f%4][Math.floor(f/4)]=a[f];e=Aes.AddRoundKey(e,b,0,c);for(var g=1;g<d;g++)e=Aes.SubBytes(e,c),e=Aes.ShiftRows(e,c),e=Aes.MixColumns(e,c),e=Aes.AddRoundKey(e,b,g,c);e=Aes.SubBytes(e,c),e=Aes.ShiftRows(e,c),e=Aes.AddRoundKey(e,b,d,c);for(var h=new Array(4*c),f=0;f<4*c;f++)h[f]=e[f%4][Math.floor(f/4)];return h},Aes.KeyExpansion=function(a){for(var b=4,c=a.length/4,d=c+6,e=new Array(b*(d+1)),f=new Array(4),g=0;g<c;g++){var h=[a[4*g],a[4*g+1],a[4*g+2],a[4*g+3]];e[g]=h}for(var g=c;g<b*(d+1);g++){e[g]=new Array(4);for(var i=0;i<4;i++)f[i]=e[g-1][i];if(g%c==0){f=Aes.SubWord(Aes.RotWord(f));for(var i=0;i<4;i++)f[i]^=Aes.Rcon[g/c][i]}else c>6&&g%c==4&&(f=Aes.SubWord(f));for(var i=0;i<4;i++)e[g][i]=e[g-c][i]^f[i]}return e},Aes.SubBytes=function(a,b){for(var c=0;c<4;c++)for(var d=0;d<b;d++)a[c][d]=Aes.Sbox[a[c][d]];return a},Aes.ShiftRows=function(a,b){for(var c=new Array(4),d=1;d<4;d++){for(var e=0;e<4;e++)c[e]=a[d][(e+d)%b];for(var e=0;e<4;e++)a[d][e]=c[e]}return a},Aes.MixColumns=function(a,b){for(var c=0;c<4;c++){for(var d=new Array(4),e=new Array(4),f=0;f<4;f++)d[f]=a[f][c],e[f]=128&a[f][c]?a[f][c]<<1^283:a[f][c]<<1;a[0][c]=e[0]^d[1]^e[1]^d[2]^d[3],a[1][c]=d[0]^e[1]^d[2]^e[2]^d[3],a[2][c]=d[0]^d[1]^e[2]^d[3]^e[3],a[3][c]=d[0]^e[0]^d[1]^d[2]^e[3]}return a},Aes.AddRoundKey=function(a,b,c,d){for(var e=0;e<4;e++)for(var f=0;f<d;f++)a[e][f]^=b[4*c+f][e];return a},Aes.SubWord=function(a){for(var b=0;b<4;b++)a[b]=Aes.Sbox[a[b]];return a},Aes.RotWord=function(a){for(var b=a[0],c=0;c<3;c++)a[c]=a[c+1];return a[3]=b,a},Aes.Sbox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.Rcon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];var AesCtr={};AesCtr.encrypt=function(a,b,c){var d=16;if(128!=c&&192!=c&&256!=c)return"";a=Utf8.encode(a),b=Utf8.encode(b);for(var e=c/8,f=new Array(e),g=0;g<e;g++)f[g]=isNaN(b.charCodeAt(g))?0:b.charCodeAt(g);var h=Aes.Cipher(f,Aes.KeyExpansion(f));h=h.concat(h.slice(0,e-16));for(var i=new Array(d),j=(new Date).getTime(),k=Math.floor(j/1e3),l=j%1e3,g=0;g<4;g++)i[g]=k>>>8*g&255;for(var g=0;g<4;g++)i[g+4]=255&l;for(var m="",g=0;g<8;g++)m+=String.fromCharCode(i[g]);for(var n=Aes.KeyExpansion(h),o=Math.ceil(a.length/d),p=new Array(o),q=0;q<o;q++){for(var r=0;r<4;r++)i[15-r]=q>>>8*r&255;for(var r=0;r<4;r++)i[15-r-4]=q/4294967296>>>8*r;for(var s=Aes.Cipher(i,n),t=q<o-1?d:(a.length-1)%d+1,u=new Array(t),g=0;g<t;g++)u[g]=s[g]^a.charCodeAt(q*d+g),u[g]=String.fromCharCode(u[g]);p[q]=u.join("")}var v=m+p.join("");return v=Base64.encode(v)},AesCtr.decrypt=function(a,b,c){var d=16;if(128!=c&&192!=c&&256!=c)return"";a=Base64.decode(a),b=Utf8.encode(b);for(var e=c/8,f=new Array(e),g=0;g<e;g++)f[g]=isNaN(b.charCodeAt(g))?0:b.charCodeAt(g);var h=Aes.Cipher(f,Aes.KeyExpansion(f));h=h.concat(h.slice(0,e-16));var i=new Array(8);ctrTxt=a.slice(0,8);for(var g=0;g<8;g++)i[g]=ctrTxt.charCodeAt(g);for(var j=Aes.KeyExpansion(h),k=Math.ceil((a.length-8)/d),l=new Array(k),m=0;m<k;m++)l[m]=a.slice(8+m*d,8+m*d+d);a=l;for(var n=new Array(a.length),m=0;m<k;m++){for(var o=0;o<4;o++)i[15-o]=m>>>8*o&255;for(var o=0;o<4;o++)i[15-o-4]=(m+1)/4294967296-1>>>8*o&255;for(var p=Aes.Cipher(i,j),q=new Array(a[m].length),g=0;g<a[m].length;g++)q[g]=p[g]^a[m].charCodeAt(g),q[g]=String.fromCharCode(q[g]);n[m]=q.join("")}var r=n.join("");return r=Utf8.decode(r)};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64.encode=function(a,b){b="undefined"!=typeof b&&b;var c,d,e,f,g,h,i,j,k,l,m,n=[],o="",p=Base64.code;if(l=b?a.encodeUTF8():a,k=l.length%3,k>0)for(;k++<3;)o+="=",l+="\0";for(k=0;k<l.length;k+=3)c=l.charCodeAt(k),d=l.charCodeAt(k+1),e=l.charCodeAt(k+2),f=c<<16|d<<8|e,g=f>>18&63,h=f>>12&63,i=f>>6&63,j=63&f,n[k/3]=p.charAt(g)+p.charAt(h)+p.charAt(i)+p.charAt(j);return m=n.join(""),m=m.slice(0,m.length-o.length)+o},Base64.decode=function(a,b){b="undefined"!=typeof b&&b;var c,d,e,f,g,h,i,j,k,l,m=[],n=Base64.code;l=b?a.decodeUTF8():a;for(var o=0;o<l.length;o+=4)f=n.indexOf(l.charAt(o)),g=n.indexOf(l.charAt(o+1)),h=n.indexOf(l.charAt(o+2)),i=n.indexOf(l.charAt(o+3)),j=f<<18|g<<12|h<<6|i,c=j>>>16&255,d=j>>>8&255,e=255&j,m[o/4]=String.fromCharCode(c,d,e),64==i&&(m[o/4]=String.fromCharCode(c,d)),64==h&&(m[o/4]=String.fromCharCode(c));return k=m.join(""),b?k.decodeUTF8():k};var Utf8={};Utf8.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|63&b)});return b=b.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|63&b)})},Utf8.decode=function(a){var b=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(31&a.charCodeAt(0))<<6|63&a.charCodeAt(1);return String.fromCharCode(b)});return b=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2);return String.fromCharCode(b)})};