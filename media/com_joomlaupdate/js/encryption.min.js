var Aes={};Aes.Cipher=function(a,b){for(var c=b.length/4-1,d=[[],[],[],[]],e=0;e<16;e++)d[e%4][Math.floor(e/4)]=a[e];d=Aes.AddRoundKey(d,b,0,4);for(var f=1;f<c;f++)d=Aes.SubBytes(d,4),d=Aes.ShiftRows(d,4),d=Aes.MixColumns(d,4),d=Aes.AddRoundKey(d,b,f,4);d=Aes.SubBytes(d,4),d=Aes.ShiftRows(d,4),d=Aes.AddRoundKey(d,b,c,4);for(var g=new Array(16),e=0;e<16;e++)g[e]=d[e%4][Math.floor(e/4)];return g},Aes.KeyExpansion=function(a){for(var b=a.length/4,c=b+6,d=new Array(4*(c+1)),e=new Array(4),f=0;f<b;f++){var g=[a[4*f],a[4*f+1],a[4*f+2],a[4*f+3]];d[f]=g}for(var f=b;f<4*(c+1);f++){d[f]=new Array(4);for(var h=0;h<4;h++)e[h]=d[f-1][h];if(f%b==0){e=Aes.SubWord(Aes.RotWord(e));for(var h=0;h<4;h++)e[h]^=Aes.Rcon[f/b][h]}else b>6&&f%b==4&&(e=Aes.SubWord(e));for(var h=0;h<4;h++)d[f][h]=d[f-b][h]^e[h]}return d},Aes.SubBytes=function(a,b){for(var c=0;c<4;c++)for(var d=0;d<b;d++)a[c][d]=Aes.Sbox[a[c][d]];return a},Aes.ShiftRows=function(a,b){for(var c=new Array(4),d=1;d<4;d++){for(var e=0;e<4;e++)c[e]=a[d][(e+d)%b];for(var e=0;e<4;e++)a[d][e]=c[e]}return a},Aes.MixColumns=function(a,b){for(var c=0;c<4;c++){for(var d=new Array(4),e=new Array(4),f=0;f<4;f++)d[f]=a[f][c],e[f]=128&a[f][c]?a[f][c]<<1^283:a[f][c]<<1;a[0][c]=e[0]^d[1]^e[1]^d[2]^d[3],a[1][c]=d[0]^e[1]^d[2]^e[2]^d[3],a[2][c]=d[0]^d[1]^e[2]^d[3]^e[3],a[3][c]=d[0]^e[0]^d[1]^d[2]^e[3]}return a},Aes.AddRoundKey=function(a,b,c,d){for(var e=0;e<4;e++)for(var f=0;f<d;f++)a[e][f]^=b[4*c+f][e];return a},Aes.SubWord=function(a){for(var b=0;b<4;b++)a[b]=Aes.Sbox[a[b]];return a},Aes.RotWord=function(a){for(var b=a[0],c=0;c<3;c++)a[c]=a[c+1];return a[3]=b,a},Aes.Sbox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.Rcon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];var AesCtr={};AesCtr.encrypt=function(a,b,c){if(128!=c&&192!=c&&256!=c)return"";a=Utf8.encode(a),b=Utf8.encode(b);for(var d=c/8,e=new Array(d),f=0;f<d;f++)e[f]=isNaN(b.charCodeAt(f))?0:b.charCodeAt(f);var g=Aes.Cipher(e,Aes.KeyExpansion(e));g=g.concat(g.slice(0,d-16));for(var h=new Array(16),i=(new Date).getTime(),j=Math.floor(i/1e3),k=i%1e3,f=0;f<4;f++)h[f]=j>>>8*f&255;for(var f=0;f<4;f++)h[f+4]=255&k;for(var l="",f=0;f<8;f++)l+=String.fromCharCode(h[f]);for(var m=Aes.KeyExpansion(g),n=Math.ceil(a.length/16),o=new Array(n),p=0;p<n;p++){for(var q=0;q<4;q++)h[15-q]=p>>>8*q&255;for(var q=0;q<4;q++)h[15-q-4]=p/4294967296>>>8*q;for(var r=Aes.Cipher(h,m),s=p<n-1?16:(a.length-1)%16+1,t=new Array(s),f=0;f<s;f++)t[f]=r[f]^a.charCodeAt(16*p+f),t[f]=String.fromCharCode(t[f]);o[p]=t.join("")}var u=l+o.join("");return u=Base64.encode(u)},AesCtr.decrypt=function(a,b,c){if(128!=c&&192!=c&&256!=c)return"";a=Base64.decode(a),b=Utf8.encode(b);for(var d=c/8,e=new Array(d),f=0;f<d;f++)e[f]=isNaN(b.charCodeAt(f))?0:b.charCodeAt(f);var g=Aes.Cipher(e,Aes.KeyExpansion(e));g=g.concat(g.slice(0,d-16));var h=new Array(8);ctrTxt=a.slice(0,8);for(var f=0;f<8;f++)h[f]=ctrTxt.charCodeAt(f);for(var i=Aes.KeyExpansion(g),j=Math.ceil((a.length-8)/16),k=new Array(j),l=0;l<j;l++)k[l]=a.slice(8+16*l,8+16*l+16);a=k;for(var m=new Array(a.length),l=0;l<j;l++){for(var n=0;n<4;n++)h[15-n]=l>>>8*n&255;for(var n=0;n<4;n++)h[15-n-4]=(l+1)/4294967296-1>>>8*n&255;for(var o=Aes.Cipher(h,i),p=new Array(a[l].length),f=0;f<a[l].length;f++)p[f]=o[f]^a[l].charCodeAt(f),p[f]=String.fromCharCode(p[f]);m[l]=p.join("")}var q=m.join("");return q=Utf8.decode(q)};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64.encode=function(a,b){b=void 0!==b&&b;var c,d,e,f,g,h,i,j,k,l,m,n=[],o="",p=Base64.code;if(l=b?a.encodeUTF8():a,(k=l.length%3)>0)for(;k++<3;)o+="=",l+="\0";for(k=0;k<l.length;k+=3)c=l.charCodeAt(k),d=l.charCodeAt(k+1),e=l.charCodeAt(k+2),f=c<<16|d<<8|e,g=f>>18&63,h=f>>12&63,i=f>>6&63,j=63&f,n[k/3]=p.charAt(g)+p.charAt(h)+p.charAt(i)+p.charAt(j);return m=n.join(""),m=m.slice(0,m.length-o.length)+o},Base64.decode=function(a,b){b=void 0!==b&&b;var c,d,e,f,g,h,i,j,k,l,m=[],n=Base64.code;l=b?a.decodeUTF8():a;for(var o=0;o<l.length;o+=4)f=n.indexOf(l.charAt(o)),g=n.indexOf(l.charAt(o+1)),h=n.indexOf(l.charAt(o+2)),i=n.indexOf(l.charAt(o+3)),j=f<<18|g<<12|h<<6|i,c=j>>>16&255,d=j>>>8&255,e=255&j,m[o/4]=String.fromCharCode(c,d,e),64==i&&(m[o/4]=String.fromCharCode(c,d)),64==h&&(m[o/4]=String.fromCharCode(c));return k=m.join(""),b?k.decodeUTF8():k};var Utf8={};Utf8.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|63&b)});return b=b.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|63&b)})},Utf8.decode=function(a){var b=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(31&a.charCodeAt(0))<<6|63&a.charCodeAt(1);return String.fromCharCode(b)});return b=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2);return String.fromCharCode(b)})};