if(!Joomla)throw new Error("Joomla API is not properly initialised");var apps_base_url=Joomla.getOptions("plg_installer_webinstaller",{}).base_url;!function(e,t,r,a){r.apps={view:"dashboard",id:0,ordering:"",cssfiles:[],jsfiles:[],list:0,loaded:0,options:r.getOptions("plg_installer_webinstaller",{})},r.loadweb=function(i){if(!i)return!1;var l=new RegExp(r.apps.options.base_url),o=new RegExp("^index.php");if(!l.test(i)&&!o.test(i))return e.open(i,"_blank"),!1;if(i+="&product="+r.apps.options.product+"&release="+r.apps.options.release+"&dev_level="+r.apps.options.dev_level+"&list="+(r.apps.list?"list":"grid")+"&lang="+r.apps.options.language,""!==r.apps.ordering&&t.querySelector("#com-apps-ordering").value&&(r.apps.ordering=t.querySelector("#com-apps-ordering").value,i+="&ordering="+r.apps.ordering),t.querySelector("#myTabContent")){var s=t.querySelector("#appsloading");s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.width="100%",s.style.height="100%",t.querySelector("#web").style.position="relative",t.querySelector("#web").appendChild(s),a("#appsloading").trigger("ajaxStart")}return a.ajax({url:i,dataType:"jsonp",cache:!0,jsonpCallback:"jedapps_jsonpcallback",timeout:2e4,success:function(e){t.querySelector("#web-loader")&&t.querySelector("#web-loader").classList.add("hidden"),t.querySelector("#jed-container").innerHTML=e.data.html,t.querySelector("#com-apps-searchbox").addEventListener("keypress",function(e){13==e.which&&r.apps.initiateSearch()}),t.querySelector("#search-reset").addEventListener("click",function(e){t.querySelector("#com-apps-searchbox").value="",r.apps.initiateSearch()}),t.querySelector("#com-apps-ordering")&&t.querySelector("#com-apps-ordering").addEventListener("change",function(e){r.apps.ordering=a(this).prop("selectedIndex"),r.installfromwebajaxsubmit()}),""!==r.apps.options.installfrom_url&&r.installfromweb(r.apps.options.installfrom_url)},fail:function(){t.querySelector("#web-loader")&&(t.querySelector("#web-loader").classList.add("hidden"),t.querySelector("#web-loader-error").classList.remove("hidden"))},complete:function(){t.querySelector("#joomlaapsinstallatinput")&&(t.querySelector("#joomlaapsinstallatinput").value=r.apps.options.installat_url),r.apps.clickforlinks(),r.apps.clicker(),r.apps.list&&t.querySelector(".list-view")&&t.querySelector(".list-view").click(),t.querySelector("#myTabContent")&&a("#appsloading").trigger("ajaxStop")},error:function(e,r,a){e.responseText&&t.querySelector("#web-loader-error")&&(t.querySelector("#web-loader-error").innerHTML=e.responseText),t.querySelector("#web-loader")&&(t.querySelector("#web-loader").classList.add("hidden"),t.querySelector("#web-loader-error").classList.remove("hidden"))}}),!0},r.webpaginate=function(e,r){t.querySelector("#web-paginate-loader").classList.remove("hidden"),a.get(e,function(e){t.querySelector("#web-paginate-loader").classList.add("hidden"),t.querySelector("#"+r).innerHTML=e.data.html},"jsonp").fail(function(){t.querySelector("#web-paginate-loader").classList.add("hidden")})},r.installfromwebexternal=function(e){return 1==confirm("You will be redirected to the following link to complete the registration/purchase - \n"+e)&&(t.querySelector("#adminForm").setAttribute("action",e),t.querySelector("input[name=task]").setAttribute("disabled",!0),t.querySelector("input[name=install_directory]").setAttribute("disabled",!0),t.querySelector("input[name=install_url]").setAttribute("disabled",!0),t.querySelector("input[name=installtype]").setAttribute("disabled",!0),t.querySelector("input[name=filter_search]").setAttribute("disabled",!0),!0)},r.installfromweb=function(e,r){return e?(t.querySelector("#install_url").value=e,t.querySelector("#uploadform-web-url").innerHTML=e,r?(t.querySelector("#uploadform-web-name").innerHTML=r,t.querySelector("#uploadform-web-name-label").classList.remove("hidden")):t.querySelector("#uploadform-web-name-label").classList.add("hidden"),t.querySelector("#uploadform-web").classList.remove("hidden"),!0):(alert("This extension cannot be installed via the web. Please visit the developer's website to purchase/download."),!1)},r.installfromwebcancel=function(){t.querySelector("#uploadform-web").classList.add("hidden"),r.apps.list&&t.querySelector(".list-view")&&t.querySelector(".list-view").click()},r.installfromwebajaxsubmit=function(){var e="&view="+r.apps.view;(r.apps.id&&(e+="&id="+r.apps.id),t.querySelector("#com-apps-searchbox").value)&&(e+="&filter_search="+encodeURI(t.querySelector("#com-apps-searchbox").value.toLowerCase().replace(/ +/g,"_").replace(/[^a-z0-9-_]/g,"").trim()));var a=r.apps.ordering;""!==a&&t.querySelector("#com-apps-ordering").value&&(a=t.querySelector("#com-apps-ordering").value),a&&(e+="&ordering="+a),r.loadweb(r.apps.options.base_url+"index.php?format=json&option=com_apps"+e)},r.apps.clickforlinks=function(){[].slice.call(t.querySelectorAll("a.transcode")).forEach(e=>{var t=e.getAttribute("href");e.addEventListener("click",function(e){var a=new RegExp(r.apps.options.base_url),i=new RegExp("^index.php");a.test(t)||i.test(t)?(r.apps.view=t.replace(/^.+[&\?]view=(\w+).*$/,"$1"),"dashboard"==r.apps.view?r.apps.id=0:"category"==r.apps.view&&(r.apps.id=t.replace(/^.+[&\?]id=(\d+).*$/,"$1")),e.preventDefault(),r.loadweb(r.apps.options.base_url+t)):(e.preventDefault(),r.loadweb(t))}),e.setAttribute("href","#")})},r.apps.initialize=function(){if(r.apps.loaded=1,t.querySelector("#myTabContent")){var e=t.querySelector("#web");e.insertAdjacentHTML("afterbegin",'<div id="appsloading" class="ifw-loading-container"></div>'),e.style.position="absolute",a("#appsloading").on("ajaxStart",function(){t.querySelector("body").classList.add("ifw-busy"),this.classList.remove("hidden")}).on("ajaxStop",function(){this.classList.add("hidden"),t.querySelector("body").classList.remove("ifw-busy")})}r.loadweb(r.apps.options.base_url+"index.php?format=json&option=com_apps&view=dashboard"),r.apps.clickforlinks()},r.apps.initiateSearch=function(){r.apps.view="dashboard",r.installfromwebajaxsubmit()},r.apps.clicker=function(){t.querySelector(".grid-view")&&t.querySelector(".grid-view").addEventListener("click",function(){r.apps.list=0,t.querySelector(".list-container").classList.add("hidden"),t.querySelector(".grid-container").classList.remove("hidden"),t.querySelector("#btn-list-view").classList.remove("active"),t.querySelector("#btn-grid-view").classList.remove("active")}),t.querySelector(".list-view")&&t.querySelector(".list-view").addEventListener("click",function(){r.apps.list=1,t.querySelector(".grid-container").classList.add("hidden"),t.querySelector(".list-container").classList.remove("hidden"),t.querySelector("#btn-grid-view").classList.remove("active"),t.querySelector("#btn-list-view").classList.add("active")})},r.submitbutton5=function(e){var a=t.getElementById("adminForm");""!==a.install_url.value&&"http://"!==a.install_url.value?r.submitbutton4():""===a.install_url.value?alert(r.apps.options.btntxt):(t.querySelector("#appsloading").classList.remove("hidden"),a.installtype.value="web",a.submit())}}(window,document,Joomla,jQuery);