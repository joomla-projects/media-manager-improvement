!function(a){"use strict";window.tinymce={langCode:"en",langStrings:{},addI18n:function(a,b){this.langCode=a,this.langStrings=b||{}},translate:function(a){return this.langStrings[a]?this.langStrings[a]:a}};var b=function(b,c){this.$container=a(b),this.options=c,this.$sourceMenu=this.$container.find(".timymce-builder-menu.source"),this.$sourceToolbar=this.$container.find(".timymce-builder-toolbar.source"),this.$targetMenu=this.$container.find(".timymce-builder-menu.target"),this.$targetToolbar=this.$container.find(".timymce-builder-toolbar.target"),this.$sourceMenu.each(function(a,b){this.renderBar(b,"menu")}.bind(this)),this.$sourceToolbar.each(function(a,b){this.renderBar(b,"toolbar")}.bind(this)),this.$targetMenu.each(function(a,b){this.renderBar(b,"menu",null,!0)}.bind(this)),this.$targetToolbar.each(function(a,b){this.renderBar(b,"toolbar",null,!0)}.bind(this));var d=null,e=!1,f=this;this.$sourceMenu.sortable({connectWith:this.$targetMenu,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(a,b){f.$targetMenu.addClass("drop-area-highlight")},helper:function(a,b){return d=b.clone().insertAfter(b),b},stop:function(){d&&d.remove(),f.$targetMenu.removeClass("drop-area-highlight")}}),this.$sourceToolbar.sortable({connectWith:this.$targetToolbar,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(a,b){f.$targetToolbar.addClass("drop-area-highlight")},helper:function(a,b){return d=b.clone().insertAfter(b),b},stop:function(){d&&d.remove(),f.$targetToolbar.removeClass("drop-area-highlight")}}),a().add(this.$targetMenu).add(this.$targetToolbar).sortable({items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",receive:function(b,c){d=null;var e=c.item,g=a(this);f.appendInput(e,g.data("group"),g.data("set"))},over:function(a,b){e=!1},out:function(a,b){e=!0},beforeStop:function(a,b){e&&b.item.remove()}}),this.$container.on("click",".button-action",function(b){var c=a(b.target),d=c.data("action"),e=c.data();if(!this[d])throw new Error("Unsupported action "+d);this[d].call(this,e)}.bind(this))};b.prototype.renderBar=function(b,c,d,e){for(var f,g,h,i=a(b),j=i.data("group"),k=i.data("set"),l="menu"===c?this.options.menus:this.options.buttons,d=d?d:i.data("value")||[],m=0,n=d.length;m<n;m++)g=d[m],(f=l[g])&&(h=this.createButton(g,f,c),i.append(h),h.tooltip&&h.tooltip({trigger:"hover"}),e&&this.appendInput(h,j,k))},b.prototype.createButton=function(b,c,d){var e=a("<div />",{class:"mce-btn","data-name":b,"data-toggle":"tooltip",title:tinymce.translate(c.label)}),f=a("<button/>",{type:"button"});return e.append(f),"menu"===d?f.html('<span class="mce-txt">'+tinymce.translate(c.label)+'</span> <i class="mce-caret"></i>'):(e.addClass("mce-btn-small"),f.html(c.text?tinymce.translate(c.text):'<span class="mce-ico mce-i-'+b+'"></span>')),e},b.prototype.appendInput=function(b,c,d){var e=a(b),f=this.options.formControl+"["+d+"]["+c+"][]",g=a("<input/>",{type:"hidden",name:f,value:e.data("name")});e.append(g)},b.prototype.setPreset=function(a){var b=a.set,c=this.options.toolbarPreset[a.preset]||null;if(!c)throw new Error('Unknown Preset "'+a.preset+'"');var d,e;for(var f in c)c.hasOwnProperty(f)&&("menu"===f?(e="menu",d=this.$targetMenu.filter('[data-group="'+f+'"][data-set="'+b+'"]')):(e="toolbar",d=this.$targetToolbar.filter('[data-group="'+f+'"][data-set="'+b+'"]')),d.empty(),this.renderBar(d,e,c[f],!0))},b.prototype.clearPane=function(a){var b=a.set;this.$targetMenu.filter('[data-set="'+b+'"]').empty(),this.$targetToolbar.filter('[data-set="'+b+'"]').empty()},a(document).ready(function(){function c(){e.find("option[disabled]").removeAttr("disabled"),e.each(function(){for(var b=a(this),c=b.val()||[],d=[],f=e.not(this).find("option"),g=0,h=c.length;g<h;g++)c[g]&&d.push('[value="'+c[g]+'"]');d.length&&f.filter(d.join(",")).attr("disabled","disabled")}),e.trigger("liszt:updated")}var d=Joomla.getOptions?Joomla.getOptions("plg_editors_tinymce_builder",{}):Joomla.optionsStorage.plg_editors_tinymce_builder||{};new b(a("#joomla-tinymce-builder"),d),a("#set-tabs a").on("click",function(b){b.preventDefault(),a(this).tab("show")});var e=a("#joomla-tinymce-builder").find(".access-select");c(),e.on("change",function(){c()})})}(jQuery);