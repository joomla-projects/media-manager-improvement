!function(e,t){"use strict";window.ImageManager={initialize:function(){var i=this.getUriObject(window.self.location.href),a=this.getQueryObject(i.query);this.editor=decodeURIComponent(a.e_name),this.fields={url:t.getElementById("f_url"),alt:t.getElementById("f_alt"),align:t.getElementById("f_align"),title:t.getElementById("f_title"),caption:t.getElementById("f_caption"),c_class:t.getElementById("f_caption_class")},this.folderlist=t.getElementById("folderlist"),this.frame=window.frames.imageframe,this.frameurl=this.frame.location.href,e("#imageframe").on("load",function(){ImageManager.onloadimageview()}),e("#upbutton").off("click").on("click",function(){ImageManager.upFolder()})},onloadimageview:function(){var t,i,a=this.getImageFolder(),r=e("#uploadForm"),s="";this.frameurl=this.frame.location.href,this.setFolder(a),t=this.getUriObject(r.attr("action")),(i=this.getQueryObject(t.query)).folder=a,t.query=e.param(i),void 0!==t.port&&80!=t.port&&(s=":"+t.port),r.attr("action",t.scheme+"://"+t.domain+s+t.path+"?"+t.query)},getImageFolder:function(){return this.getQueryObject(this.frame.location.search.substring(1)).folder},onok:function(){var e="",t=[],i="",a="",r=this.fields.url.value,s=this.fields.alt.value,l=this.fields.align.value,o=this.fields.title.value,n=this.fields.caption.value,f=this.fields.c_class.value;return r&&(t.push('alt="'+s+'"'),l&&!n&&t.push('class="float-xs-'+l+'"'),o&&t.push('title="'+o+'"'),e='<img src="'+r+'" '+t.join(" ")+"/>",n&&(l&&(i=' class="float-xs-'+l+'"'),f&&(a=' class="'+f+'"'),e="<figure"+i+">"+e+"<figcaption"+a+">"+n+"</figcaption></figure>")),window.parent.Joomla.editors.instances[this.editor].replaceSelection(e),!0},setFolder:function(t,i,a){for(var r=0,s=this.folderlist.length;r<s;r++)if(t==this.folderlist.options[r].value){this.folderlist.selectedIndex=r,e(this.folderlist).trigger("liszt:updated").trigger("chosen:updated");break}(i||a)&&this.setFrameUrl(t,i,a)},upFolder:function(){var e,t=this.folderlist.value.split("/");t.pop(),e=t.join("/"),this.setFolder(e),this.setFrameUrl(e)},populateFields:function(t){e.each(e("a.img-preview",e("#imageframe").contents()),function(i,a){a.href=="javascript:ImageManager.populateFields('"+t+"')"?e(a,e("#imageframe").contents()).addClass("selected"):e(a,e("#imageframe").contents()).removeClass("selected")}),e("#f_url").val(image_base_path+t)},showMessage:function(t){var i=e("#message");i.find(">:first-child").remove(),i.append(t),e("#messages").css("display","block")},refreshFrame:function(){this.frame.location.href=this.frameurl},setFrameUrl:function(t,i,a){var r={option:"com_media",view:"imagesList",tmpl:"component",asset:i,author:a};this.frameurl="index.php?"+e.param(r)+"&folder="+t,this.frame.location.href=this.frameurl},getQueryObject:function(t){var i={};return e.each((t||"").split(/[&;]/),function(e,t){var a=t.split("=");i[a[0]]=2==a.length?a[1]:null}),i},getUriObject:function(t){var i={},a=t.match(/^(?:([^:\/?#.]+):)?(?:\/\/)?(([^:\/?#]*)(?::(\d*))?)((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[\?#]|$)))*\/?)?([^?#\/]*))?(?:\?([^#]*))?(?:#(.*))?/);return e.each(["uri","scheme","authority","domain","port","path","directory","file","query","fragment"],function(e,t){i[t]=a&&a[e]?a[e]:""}),i}},e(function(){window.ImageManager.initialize()})}(jQuery,document);